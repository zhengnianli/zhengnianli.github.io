<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>【RT-Thread笔记】裸机系统与多线程系统</title>
      <link href="/2019/06/16/rt-thread-bi-ji-luo-ji-xi-tong-yu-duo-xian-cheng-xi-tong/"/>
      <url>/2019/06/16/rt-thread-bi-ji-luo-ji-xi-tong-yu-duo-xian-cheng-xi-tong/</url>
      
        <content type="html"><![CDATA[<p>单片机编程中有<code>裸机系统</code>与<code>多线程系统</code>的区别。</p><h3 id="裸机系统"><a href="#裸机系统" class="headerlink" title="裸机系统"></a>裸机系统</h3><p>裸机系统通常分成<code>轮询系统</code>和<code>前后台系统</code>。</p><h3 id="1、轮询系统"><a href="#1、轮询系统" class="headerlink" title="1、轮询系统"></a>1、轮询系统</h3><p>轮询系统即是在裸机编程的时候，先初始化好相关的硬件，然后让主程序在一个死循环里面不断循环，顺序地做各种事情，大概的伪代码具体如代码清单 1-1所示：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 硬件相关初始化 */</span> <span class="token function">HardWareInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 无限循环 */</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">/* 处理事情 1 */</span>   <span class="token function">DoSomething1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* 处理事情 2 */</span>   <span class="token function">DoSomethingg2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* 处理事情 3 */</span>   <span class="token function">DoSomethingg3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>轮询系统是一种非常简单的软件结构，通常只适用于那些只需要顺序执行代码且不需要外部事件来驱动的就能完成的事情。在代码清单 1-1 中，如果只是实现 LED 翻转，串口输出，液晶显示等这些操作，那么使用轮询系统将会非常完美。但是，如果加入了按键操作等需要检测外部信号的事件，用来模拟紧急报警，那么整个系统的实时响应能力就不会那么好了。</p><p>假设<code>DoSomethingg3</code> 是按键扫描，当外部按键被按下，相当于一个警报，这个时候，需要立马响 应 ， 并 做 紧 急 处 理 ， 而 这 个 时 候 程 序 刚 好 执 行 到 <code>DoSomethingg1</code> ， 要 命 的 是<code>DoSomethingg1</code> 需要执行的时间比较久，久到按键释放之后都没有执行完毕，那么当执行到 <code>DoSomethingg3</code> 的时候就会丢失掉一次事件。足见，轮询系统只适合顺序执行的功能代码，当有外部事件驱动时，实时性就会降低。</p><h3 id="2、前后台系统"><a href="#2、前后台系统" class="headerlink" title="2、前后台系统"></a>2、前后台系统</h3><p>相比轮询系统，前后台系统是在轮询系统的基础上加入了中断。外部事件的响应在中断里面完成，事件的处理还是回到轮询系统中完成，中断在这里我们称为前台， main 函数里面的无限循环我们称为后台，大概的伪代码见代码清单 1-2所示：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> flag2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> flag3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 硬件相关初始化 */</span> <span class="token function">HardWareInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 无限循环 */</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>flag1<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment" spellcheck="true">/* 处理事情 1 */</span>     <span class="token function">DoSomething1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>flag2<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment" spellcheck="true">/* 处理事情 2 */</span>     <span class="token function">DoSomethingg2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>flag3<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment" spellcheck="true">/* 处理事情 3 */</span>     <span class="token function">DoSomethingg3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">ISR1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 置位标志位 */</span> flag1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 如果事件处理时间很短，则在中断里面处理 如果事件处理时间比较长，在回到后台处理 */</span> <span class="token function">DoSomething1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">ISR2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 置位标志位 */</span> flag2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 如果事件处理时间很短，则在中断里面处理 如果事件处理时间比较长，在回到后台处理 */</span> <span class="token function">DoSomething2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">ISR3</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 置位标志位 */</span> flag3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 如果事件处理时间很短，则在中断里面处理 如果事件处理时间比较长，在回到后台处理 */</span> <span class="token function">DoSomething3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>在顺序执行后台程序的时候，如果有中断来临，那么中断会打断后台程序的正常执行流，转而去执行中断服务程序，在中断服务程序里面标记事件，如果事件要处理的事情很简短，则可在中断服务程序里面处理，如果事件要处理的事情比较多，则返回到后台程序里面处理。</p><p>虽然事件的响应和处理是分开了，但是事件的处理还是在后台里面顺序执行的，但相比轮询系统，前后台系统确保了事件不会丢失，再加上中断具有可嵌套的功能，这可以大大的提高程序的实时响应能力。在大多数的中小型项目中，前后台系统运用的好，堪称有操作系统的效果。</p><h3 id="多线程系统"><a href="#多线程系统" class="headerlink" title="多线程系统"></a>多线程系统</h3><p>相比前后台系统，多线程系统的事件响应也是在中断中完成的，但是事件的处理是在线程中完成的。在多线程系统中，线程跟中断一样，也具有优先级，优先级高的线程会被优先执行。</p><p>当一个紧急的事件在中断被标记之后，如果事件对应的线程的优先级足够高，就会立马得到响应。相比前后台系统，多线程系统的实时性又被提高了。多线程系统大概的伪代码具体见代码清单 1-3所示：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> flag1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> flag2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> flag3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 硬件相关初始化 */</span> <span class="token function">HardWareInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* OS 初始化 */</span> <span class="token function">RTOSInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* OS 启动，开始多线程调度，不再返回 */</span> <span class="token function">RTOSStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">ISR1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 置位标志位 */</span> flag1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">ISR2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 置位标志位 */</span> flag2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">ISR3</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 置位标志位 */</span> flag3 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">DoSomething1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 无限循环，不能返回 */</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">/* 线程实体 */</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>flag1<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">DoSomething2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 无限循环，不能返回 */</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">/* 线程实体 */</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>flag2<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">DoSomething3</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* 无限循环，不能返回 */</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">/* 线程实体 */</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>flag3<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>相比前后台系统中后台顺序执行的程序主体，在多线程系统中，根据程序的功能，我们把这个程序主体分割成一个个独立的，无限循环且不能返回的小程序，这个小程序我们称之为<code>线程</code>。</p><p>每个线程都是独立的，互不干扰的，且具备自身的优先级，它由操作系统调度管理。加入操作系统后，我们在编程的时候不需要精心地去设计程序的执行流，不用担心每个功能模块之间是否存在干扰。</p><p>加入了操作系统，我们的编程反而变得简单了。整个系统随之带来的额外开销就是操作系统占据的那一丁点的 FLASH 和 RAM。现如今，单片机的 FLASH 和 RAM 是越来越大，完全足以抵挡 RTOS 那点开销。</p><p>轮询、前后台和多线程系统软件模型区别：</p><p><a href="https://imgchr.com/i/VTw6V1" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/VTw6V1.md.png" alt="VTw6V1.md.png"></a></p><p>以上是关于裸机系统与多线程系统的笔记，摘抄于《RT-Thread内核实现与应用开发实践指南》一书。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> 嵌入式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 嵌入式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习011</title>
      <link href="/2019/06/14/c-bian-cheng-lian-xi-011/"/>
      <url>/2019/06/14/c-bian-cheng-lian-xi-011/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><blockquote><p>一个10万以内的整数，它加上100后是一个完全平方数，再加上168又是一个完全平方数，请问该数是多少？</p></blockquote><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>方法一：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> n<span class="token punctuation">;</span>    <span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">;</span> n <span class="token operator">&lt;=</span> <span class="token number">100000</span><span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        x <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        y <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span> x <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>y <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"This integer is：%d\n"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>     <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>方法二：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> n<span class="token punctuation">;</span>    <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">;</span> n <span class="token operator">&lt;=</span> <span class="token number">100000</span><span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        x <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        y <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x <span class="token operator">==</span> n <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>y<span class="token operator">*</span>y <span class="token operator">==</span> n <span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"This integer is：%d\n"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>     <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>方法一和方法二都差不多，都是根据判断sqrt(n+100)与sqrt(n+100+168)的值是否为整数来找出符合条件的n的值。</p><h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><p><img src="https://s2.ax1x.com/2019/06/14/V4ySBR.png" alt="V4ySBR.png"></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习010</title>
      <link href="/2019/06/12/c-bian-cheng-lian-xi-010/"/>
      <url>/2019/06/12/c-bian-cheng-lian-xi-010/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>统计文件的字符数</p></blockquote><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 统计文件的字符数********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> fname<span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/*存贮文件名*/</span>    FILE <span class="token operator">*</span>rfp<span class="token punctuation">;</span>    <span class="token keyword">long</span> count<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/*文件字符计数器*/</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入文件名："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>fname<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rfp<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span>fname<span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Can't open file %s.\n"</span><span class="token punctuation">,</span>fname<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgetc</span><span class="token punctuation">(</span>rfp<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        count<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">fclose</span><span class="token punctuation">(</span>rfp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/*关闭文件*/</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"共有 %ld 个字符在文件 %s 中。\n"</span><span class="token punctuation">,</span>count<span class="token punctuation">,</span>fname<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="3、测试结果及分析"><a href="#3、测试结果及分析" class="headerlink" title="3、测试结果及分析"></a>3、测试结果及分析</h2><p>首先，在与该源文件相同文件夹下建一个test.txt的文件，里面输入你要统计的内容：</p><p><img src="https://s2.ax1x.com/2019/06/13/VW2vuj.png" alt="VW2vuj.png"></p><p>其实，不同的编码，其字符（中文、英文字符）的占用的字节数是不一样的。下面测试一下：</p><h4 id="（1）utf-8编码下的英文字符统计"><a href="#（1）utf-8编码下的英文字符统计" class="headerlink" title="（1）utf-8编码下的英文字符统计"></a>（1）utf-8编码下的英文字符统计</h4><p><a href="https://imgchr.com/i/VWRiCT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/13/VWRiCT.md.png" alt="VWRiCT.md.png"></a></p><p>可见，utf-8编码下，一个英文字符占用一个字节。</p><h4 id="（2）utf-8编码下的中文字符统计"><a href="#（2）utf-8编码下的中文字符统计" class="headerlink" title="（2）utf-8编码下的中文字符统计"></a>（2）utf-8编码下的中文字符统计</h4><p><a href="https://imgchr.com/i/VWRQPK" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/13/VWRQPK.md.png" alt="VWRQPK.md.png"></a></p><p>可见，utf-8编码下，一个中文字符占用三个字节。</p><h4 id="（3）GB2312编码下的英文字符统计"><a href="#（3）GB2312编码下的英文字符统计" class="headerlink" title="（3）GB2312编码下的英文字符统计"></a>（3）GB2312编码下的英文字符统计</h4><p><a href="https://imgchr.com/i/VWRGKH" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/13/VWRGKH.md.png" alt="VWRGKH.md.png"></a></p><p>可见，GB2312编码下，一个英文字符占用一个字节。</p><h4 id="（4）GB2312编码下的中文字符统计"><a href="#（4）GB2312编码下的中文字符统计" class="headerlink" title="（4）GB2312编码下的中文字符统计"></a>（4）GB2312编码下的中文字符统计</h4><p><a href="https://imgchr.com/i/VWRYqA" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/13/VWRYqA.md.png" alt="VWRYqA.md.png"></a></p><p>可见，GB2312编码下，一个中文字符占用两个字节。</p><h3 id="4、总结"><a href="#4、总结" class="headerlink" title="4、总结"></a>4、总结</h3><p>中、英文字符占用的字节数与编码有关。在notepad++中可修改编码，如：</p><p><a href="https://imgchr.com/i/VWR6qs" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/13/VWR6qs.md.png" alt="VWR6qs.md.png"></a></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习009</title>
      <link href="/2019/06/11/c-bian-cheng-lian-xi-009/"/>
      <url>/2019/06/11/c-bian-cheng-lian-xi-009/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>将一个数分解质因数</p></blockquote><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 将一个数分解质因数** 样例输入：50** 样例输出：50 = 2 * 5 * 5********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span> </span><span class="token keyword">void</span> <span class="token function">SeparateFactor</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">int</span> n<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>                <span class="token function">SeparateFactor</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token comment" spellcheck="true">// 分解质因数</span><span class="token keyword">void</span> <span class="token function">SeparateFactor</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> top<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        a <span class="token operator">=</span> n<span class="token punctuation">;</span>        top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>a<span class="token operator">%</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                array<span class="token punctuation">[</span><span class="token operator">++</span>top<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>                a <span class="token operator">/</span><span class="token operator">=</span> i<span class="token punctuation">;</span>             <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d = "</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> top<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d * "</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://s2.ax1x.com/2019/06/10/V64vKs.png" alt="V64vKs.png"></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习008</title>
      <link href="/2019/06/10/c-bian-cheng-lian-xi-008/"/>
      <url>/2019/06/10/c-bian-cheng-lian-xi-008/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>自定义atoi函数</p></blockquote><p>atoi (表示 ascii to integer)是把字符串转换成整型数的一个函数，应用在计算机程序和办公软件中。<code>int atoi(const char *nptr)</code>函数会扫描参数 nptr字符串，会跳过前面的空白字符（例如空格，tab缩进）等。</p><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 自定义atoi函数********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">my_atoi</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>nptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入一个数字字符串："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> str_to_int <span class="token operator">=</span> <span class="token function">my_atoi</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"str_to_int = %d\n"</span><span class="token punctuation">,</span>str_to_int<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">my_atoi</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>nptr<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> nptr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token string">'\0'</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nptr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token string">'0'</span><span class="token operator">&amp;&amp;</span>nptr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token string">'9'</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            res <span class="token operator">=</span> res<span class="token operator">*</span><span class="token number">10</span> <span class="token operator">+</span> nptr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://s2.ax1x.com/2019/06/09/VsXK6U.png" alt="VsXK6U.png"></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习007</title>
      <link href="/2019/06/06/c-bian-cheng-lian-xi-007/"/>
      <url>/2019/06/06/c-bian-cheng-lian-xi-007/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>给定两个仅由大写字母或小写字母组成的字符串(长度介于1到10之间)，它们之间的关系是以下4中情况之一：<br>　　<br>1：两个字符串长度不等。比如 Beijing 和 Hebei<br>　　<br>2：两个字符串不仅长度相等，而且相应位置上的字符完全一致(区分大小写)，比如 Beijing 和 Beijing<br>　　<br>3：两个字符串长度相等，相应位置上的字符仅在不区分大小写的前提下才能达到完全一致（也就是说，它并不满足情况2）。<br>                比如 beijing 和 BEIjing<br>　　<br>4：两个字符串长度相等，但是即使是不区分大小写也不能使这两个字符串一致。比如 Beijing 和 Nanjing<br>　　         编程判断输入的两个字符串之间的关系属于这四类中的哪一类，给出所属的类的编号。</p></blockquote><h4 id="1-1-输入"><a href="#1-1-输入" class="headerlink" title="1.1 输入"></a>1.1 输入</h4><blockquote><p>包括两行，每行都是一个字符串</p></blockquote><h4 id="1-2-输出"><a href="#1-2-输出" class="headerlink" title="1.2 输出"></a>1.2 输出</h4><blockquote><p>仅有一个数字，表明这两个字符串的关系编号</p></blockquote><h4 id="1-3-样例输入"><a href="#1-3-样例输入" class="headerlink" title="1.3 样例输入"></a>1.3 样例输入</h4><blockquote><p>BEIjing </p></blockquote><blockquote><p>beiJing</p></blockquote><h4 id="1-4-样例输出"><a href="#1-4-样例输出" class="headerlink" title="1.4 样例输出"></a>1.4 样例输出</h4><blockquote><p>3</p></blockquote><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 给定两个仅由大写字母或小写字母组成的字符串(长度介于1到10之间)，它们之间的关系是以下4中情况之一：　　         1：两个字符串长度不等。比如 Beijing 和 Hebei　　         2：两个字符串不仅长度相等，而且相应位置上的字符完全一致(区分大小写)，比如 Beijing 和 Beijing　　         3：两个字符串长度相等，相应位置上的字符仅在不区分大小写的前提下才能达到完全一致（也就是说，它并不满足情况2）。                比如 beijing 和 BEIjing　　         4：两个字符串长度相等，但是即使是不区分大小写也不能使这两个字符串一致。比如 Beijing 和 Nanjing　　         编程判断输入的两个字符串之间的关系属于这四类中的哪一类，给出所属的类的编号。** 输    入: 包括两行，每行都是一个字符串** 输    出: 仅有一个数字，表明这两个字符串的关系编号** 样例输入：               BEIjing            beiJing** 样例输出：3********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;ctype.h></span></span><span class="token comment" spellcheck="true">// 主函数</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> arr1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> arr2<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> arr1_len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> arr2_len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s%s"</span><span class="token punctuation">,</span>arr1<span class="token punctuation">,</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span>    arr1_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">;</span>    arr2_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 两字符串长度不相等，输出1</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr1_len <span class="token operator">!=</span> arr2_len<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 两字符串长度相等</span>    <span class="token keyword">else</span>      <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 两字符串各字符相同，输出2</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span> arr2<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"2\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// 两字符串各字符不全相同</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 两字符串各字符转换为小写</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr1_len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">tolower</span><span class="token punctuation">(</span>arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                arr2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">tolower</span><span class="token punctuation">(</span>arr2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">// 再次判断，若各字符相同则输出3</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span> arr2<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"3\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">// 若各字符不同则输出4</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"4\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://s2.ax1x.com/2019/06/06/VUvLJe.png" alt="VUvLJe.png"></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习006</title>
      <link href="/2019/06/05/c-bian-cheng-lian-xi-006/"/>
      <url>/2019/06/05/c-bian-cheng-lian-xi-006/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>在一个有限的正整数序列中，有些数会多次重复出现在这个序列中。如序列<code>3,1,2,1,5,1,2</code>。其中1就出现3次，2出现2次，3出现1次，5出现1次。要求对于给定的正整数序列，从小到大依次输出序列中出现的数及出现的次数。</p></blockquote><h4 id="数据约定"><a href="#数据约定" class="headerlink" title="数据约定"></a>数据约定</h4><blockquote><p>n&lt;=100; 0&lt;x&lt;1000000.</p></blockquote><h4 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h4><blockquote><p>第一行正整数n，表示给定序列中正整数的个数。第二行是n个用空格隔开的正整数x，代表给定的序列。</p></blockquote><h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><blockquote><p>若干行，每行两个用一个空格隔开的数，第一个是数列中出现的数第二个是该数在序列中出现的次数。</p></blockquote><h4 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h4><blockquote><p>12<br> 8 2 8 2 2 11 1 1 8 1 13 13</p></blockquote><h4 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h4><blockquote><p>1 3</p></blockquote><blockquote><p>2 3</p></blockquote><blockquote><p>8 3</p></blockquote><blockquote><p>11 1</p></blockquote><blockquote><p>13 2</p></blockquote><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><p>首先，先从控制台输入数据保存到目标数组中；其次给目标数组元素进行从小到大排序；最后再进行数据统计。</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 在一个有限的正整数序列中，有些数会多次重复出现在这个序列中。如序列3,1,2,1,5,1,2。             其中1就出现3次，2出现2次，3出现1次，5出现1次。要求对于给定的正整数序列，从小到大             依次输出序列中出现的数及出现的次数。** 数据约定：n&lt;=1000; 0&lt;x&lt;1000000.             ** 输    入: 第一行正整数n，表示给定序列中正整数的个数。             第二行是n个用空格隔开的正整数x，代表给定的序列。** 输    出: 若干行，每行两个用一个空格隔开的数，第一个是数列中出现的数             第二个是该数在序列中出现的次数。** 样例输入：12             8 2 8 2 2 11 1 1 8 1 13 13** 样例输出：1 3             2 3             8 3             11 1             13 2********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">BubbleSortSmallToBig</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// O(n*n)    </span><span class="token comment" spellcheck="true">// 主函数</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 数据输入</span>    <span class="token keyword">int</span> n<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 从小到大排序</span>    <span class="token function">BubbleSortSmallToBig</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 处理方式如下</span>    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>j <span class="token operator">!=</span> n<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        tmp <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            num<span class="token operator">++</span><span class="token punctuation">;</span>            j<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span> tmp<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>         num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// 数组内元素交换</span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> temp <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    array<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// 从小到大排序</span><span class="token keyword">void</span> <span class="token function">BubbleSortSmallToBig</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// O(n*n)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span>len<span class="token number">-1</span><span class="token punctuation">;</span> j<span class="token operator">></span>i<span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> array<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token function">swap</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> j<span class="token punctuation">,</span> j<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://s2.ax1x.com/2019/06/05/VN8ccj.png" alt="VN8ccj.png"></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习005</title>
      <link href="/2019/06/04/c-bian-cheng-lian-xi-005/"/>
      <url>/2019/06/04/c-bian-cheng-lian-xi-005/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>在已知两个从小到大有序的数表中寻找都出现的第一个元素</p></blockquote><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 在已知两个从小到大有序的数表中寻找都出现的第一个元素********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;conio.h></span></span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>pa<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">*</span>pb<span class="token punctuation">,</span><span class="token keyword">int</span> an<span class="token punctuation">,</span><span class="token keyword">int</span> bn<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token operator">*</span>ca<span class="token punctuation">,</span><span class="token operator">*</span>cb<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* 为ca、cb设定初值 */</span>    ca <span class="token operator">=</span> pa<span class="token punctuation">;</span>    cb <span class="token operator">=</span> pb<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ca<span class="token operator">&lt;</span>pa<span class="token operator">+</span>an<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>cb<span class="token operator">&lt;</span>pb<span class="token operator">+</span>bn<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">/*两个数表都未考察完*/</span>    <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">/* 在两个数表中找下一个相等的元素 */</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>ca<span class="token operator">&lt;</span><span class="token operator">*</span>cb<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">/*数表1的当前元素&lt;数表2的当前元素*/</span>        <span class="token punctuation">{</span>            ca<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/*调整数表1的当前元素指针*/</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>ca<span class="token operator">></span><span class="token operator">*</span>cb<span class="token punctuation">)</span><span class="token comment" spellcheck="true">/*数表1的当前元素>数表2的当前元素*/</span>        <span class="token punctuation">{</span>            cb<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/*调整数表2的当前元素指针*/</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>            <span class="token comment" spellcheck="true">/*数表1的当前元素==数表2的当前元素*/</span>        <span class="token punctuation">{</span>            <span class="token keyword">return</span> ca<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*返回在这两个数表中找到相等元素*/</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// 主函数</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token operator">*</span>vp<span class="token punctuation">,</span>i<span class="token punctuation">;</span>    <span class="token keyword">int</span> a<span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> b<span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"The elements of array a is:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\nThe elements of array b is:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    vp <span class="token operator">=</span> <span class="token function">search</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>vp<span class="token punctuation">)</span>     <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nThe first same number in both arrays is %d\n"</span><span class="token punctuation">,</span><span class="token operator">*</span>vp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>     <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Not found!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\n Press any key to quit...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://s2.ax1x.com/2019/06/03/VYJ6yR.png" alt="VYJ6yR.png"></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】关于数组的一个陷阱！</title>
      <link href="/2019/06/03/c-yu-yan-bi-ji-guan-yu-shu-zu-de-yi-ge-xian-jing/"/>
      <url>/2019/06/03/c-yu-yan-bi-ji-guan-yu-shu-zu-de-yi-ge-xian-jing/</url>
      
        <content type="html"><![CDATA[<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><blockquote><p>两个数组元素的地址相减得到什么？</p></blockquote><p>先看一段代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&amp;a[0] = %d, &amp;a[2] = %d\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>这段代码以十进制的形式打印出第0号元素的地址和第2号元素的地址，输出结果为：</p><pre class=" language-c"><code class="language-c"><span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2686760</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2686768</span></code></pre><p>所以，<code>&amp;a[2] - &amp;a[0]</code>的结果是8？但是，事实不是这样的！！让我们把其结果打印出来：<br><a href="https://imgchr.com/i/VqAEbd" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VqAEbd.md.png" alt="VqAEbd.md.png"></a><br>竟然是<code>2</code>！我们把<code>&amp;a[5] - &amp;a[2]</code>的结果输出来看看有什么规律：<br><a href="https://imgchr.com/i/VqA1Kg" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VqA1Kg.md.png" alt="VqA1Kg.md.png"></a></p><h2 id="陷阱"><a href="#陷阱" class="headerlink" title="陷阱"></a>陷阱</h2><p>事实证明，两个数组元素的地址相减，其值并不是等于两个地址数值上的差，而是等于这两个地址之间内存单元的个数。本例中数组的类型是int类型，并且在32bit编译环境下编译，因此这里的内存单元的大小是4字节。所以本例中<code>&amp;a[2] - &amp;a[0]</code>的值为:</p><pre class=" language-c"><code class="language-c"><span class="token punctuation">(</span><span class="token number">2686768</span> <span class="token operator">-</span> <span class="token number">2686760</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span></code></pre><p>当然，若是低号元素地址减去高号元素地址，得到的结果是负数：<br><a href="https://imgchr.com/i/VqAUP0" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VqAUP0.md.png" alt="VqAUP0.md.png"></a><br>网上看到了一篇博客也是印证了这一点：</p><pre class=" language-c"><code class="language-c">https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>csdn<span class="token punctuation">.</span>net<span class="token operator">/</span>harvic880925<span class="token operator">/</span>article<span class="token operator">/</span>details<span class="token operator">/</span><span class="token number">8953854</span></code></pre><p>这是个很容易出错的问题，需要特别注意！</p><h2 id="学以致用"><a href="#学以致用" class="headerlink" title="学以致用"></a>学以致用</h2><p>我们的C语言每日一练（004）中的题目是</p><blockquote><p>寻找数组元素第一次出现的位置</p></blockquote><p>之前已经提供了两种方法，函数的返回值都是要寻找的元素的下标。这里可以稍微修改一下得到第三种方法，我们的第三种方法返回的是寻找的元素的指针：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// 函数返回找到元素的指针</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">serch</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span><span class="token comment" spellcheck="true">// 已知数表的首元指针</span>          <span class="token keyword">int</span> n<span class="token punctuation">,</span>   <span class="token comment" spellcheck="true">// 数表中元素个数</span>          <span class="token keyword">int</span> key<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 要寻找的值</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> arr<span class="token punctuation">;</span> p <span class="token operator">&lt;</span> arr<span class="token operator">+</span>n<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>p <span class="token operator">==</span> key<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">return</span> p<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 返回找到元素的指针</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 未查找到key</span><span class="token punctuation">}</span></code></pre><h2 id="完整的验证代码为"><a href="#完整的验证代码为" class="headerlink" title="完整的验证代码为"></a>完整的验证代码为</h2><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 同一个数组中两个元素的地址相减********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token comment" spellcheck="true">// 函数返回找到元素的指针</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">serch</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span><span class="token comment" spellcheck="true">// 已知数表的首元指针</span>          <span class="token keyword">int</span> n<span class="token punctuation">,</span>   <span class="token comment" spellcheck="true">// 数表中元素个数</span>          <span class="token keyword">int</span> key<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 要寻找的值</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> arr<span class="token punctuation">;</span> p <span class="token operator">&lt;</span> arr<span class="token operator">+</span>n<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>p <span class="token operator">==</span> key<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">return</span> p<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 返回找到元素的指针</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 未查找到key</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// 定义一个全局数组</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">,</span><span class="token number">666</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 主函数</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> key<span class="token punctuation">;</span>    <span class="token keyword">int</span> <span class="token operator">*</span>p_a<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"The elements of array a is:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\nPlease input the key number you want to search:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    p_a <span class="token operator">=</span> <span class="token function">serch</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nThe index of the key number %d in the array is: %d."</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> p_a<span class="token operator">-</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span> </code></pre><p>可见，得到的结果与我们C语言每日一练（004）中的验证结果一样。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习004</title>
      <link href="/2019/06/01/c-bian-cheng-lian-xi-004/"/>
      <url>/2019/06/01/c-bian-cheng-lian-xi-004/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>寻找数组元素第一次出现的位置</p></blockquote><p>假如有如下一个数组：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">,</span><span class="token number">666</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>该怎么从这个数组中查找<code>66</code>第一次出现的位置（数组下标）呢？</p><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 寻找数组元素第一次出现的位置********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;conio.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span>  Method   1  </span><span class="token comment" spellcheck="true">// 非0：方法一  0：方法二</span><span class="token macro property">#<span class="token directive keyword">if</span> Method</span><span class="token comment" spellcheck="true">// 方法一：函数返回找到元素的下标（使用指针的方式）</span><span class="token keyword">int</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span><span class="token comment" spellcheck="true">// 已知数表的首元指针</span>           <span class="token keyword">int</span> n<span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// 数表中元素个数</span>           <span class="token keyword">int</span> key<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// 要寻找的值</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> arr<span class="token punctuation">;</span> p <span class="token operator">&lt;</span> arr<span class="token operator">+</span>n<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>p <span class="token operator">==</span> key<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">return</span> p <span class="token operator">-</span> arr<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 返回找到元素的下标</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 未查找到key</span><span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">else</span></span><span class="token comment" spellcheck="true">// 方法二：函数返回找到元素的下标（使用数组的方式）</span><span class="token keyword">int</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span><span class="token comment" spellcheck="true">// 已知数表的首元指针</span>           <span class="token keyword">int</span> n<span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// 数表中元素个数</span>           <span class="token keyword">int</span> key<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// 要寻找的值</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> key<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">return</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 返回找到元素的下标</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 未查找到key</span><span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">endif</span></span><span class="token comment" spellcheck="true">// 定义一个全局数组</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">,</span><span class="token number">666</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 主函数</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> key<span class="token punctuation">;</span>    <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"The elements of array a is:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d"</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\nPlease input the key number you want to search:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    i <span class="token operator">=</span> <span class="token function">search</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nThe index of the key number %d in the array is: %d."</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>小知识：平时也有看到如下写法</p><pre class=" language-c"><code class="language-c"><span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> key<span class="token punctuation">)</span></code></pre><p>但<code>int arr[]</code> 最终都会转换为 <code>int *arr</code> 这样的指针。</p><h1 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h1><p><img src="https://s2.ax1x.com/2019/06/23/ZPCC0P.png" alt="ZPCC0P.png"></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习003</title>
      <link href="/2019/05/31/c-bian-cheng-lian-xi-003/"/>
      <url>/2019/05/31/c-bian-cheng-lian-xi-003/</url>
      
        <content type="html"><![CDATA[<h1 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h1><blockquote><p>遍历数组</p></blockquote><h1 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h1><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 遍历数组********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">define</span> N sizeof(a)/sizeof(a[0])</span><span class="token comment" spellcheck="true">// 主函数</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> j<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// 游标变量</span>    <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 指针变量</span>    <span class="token comment" spellcheck="true">/* 方法一：数组名和下标顺序访问数组的元素 */</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"方法一：数组名和下标顺序访问数组的元素\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a[%d]\t= %d\n"</span><span class="token punctuation">,</span>j<span class="token punctuation">,</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* 方法二：让指针顺序指向数组的各元素，遍历数组 */</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"方法二：让指针顺序指向数组的各元素，遍历数组\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> a<span class="token punctuation">;</span> p <span class="token operator">&lt;</span> a<span class="token operator">+</span>N<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*p\t= %d\n"</span><span class="token punctuation">,</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* 方法三：指针与游标变量结合，改变游标变量遍历数组 */</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"方法三：指针与游标变量结合，改变游标变量遍历数组\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>p <span class="token operator">=</span> a<span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p<span class="token operator">+</span>j <span class="token operator">&lt;</span> a<span class="token operator">+</span>N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*(p+%d)\t= %d\n"</span><span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://s2.ax1x.com/2019/06/23/ZPptC4.png" alt="ZPptC4.png"></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习002</title>
      <link href="/2019/05/30/c-bian-cheng-lian-xi-002/"/>
      <url>/2019/05/30/c-bian-cheng-lian-xi-002/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>求数组元素之和    </p></blockquote><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><p>首先，需要构造一个求和函数。这里求和函数有两种构造方法，一种是迭代法，另一个种是递归法。</p><h3 id="2-1-迭代法求和函数"><a href="#2-1-迭代法求和函数" class="headerlink" title="2.1 迭代法求和函数"></a>2.1 迭代法求和函数</h3><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> arr_sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        arr_sum <span class="token operator">+</span><span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> arr_sum<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="2-2-递归法求和函数"><a href="#2-2-递归法求和函数" class="headerlink" title="2.2 递归法求和函数"></a>2.2 递归法求和函数</h3><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> a<span class="token punctuation">[</span>n<span class="token number">-1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="2-3-完整代码"><a href="#2-3-完整代码" class="headerlink" title="2.3 完整代码"></a>2.3 完整代码</h3><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 求数组元素之和    ********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;conio.h></span>   </span><span class="token comment" spellcheck="true">// getch函数在这个头文件中声明</span><span class="token macro property">#<span class="token directive keyword">define</span>  Method   0  </span><span class="token comment" spellcheck="true">// 1：迭代法  0：递归法</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token macro property">#<span class="token directive keyword">if</span> Method </span><span class="token comment" spellcheck="true">// 方法一：迭代法</span><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> arr_sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        arr_sum <span class="token operator">+</span><span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> arr_sum<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">else</span> </span><span class="token comment" spellcheck="true">// 方法二：递归法</span><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> a<span class="token punctuation">[</span>n<span class="token number">-1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">endif</span></span><span class="token comment" spellcheck="true">// 主函数</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// cmd窗口清屏</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n The arry is:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d "</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n SUM of the arry is: %d\n"</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n Press any key to quit...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 从控制台无回显地取一个字符</span><span class="token punctuation">}</span></code></pre><blockquote><p>小知识：getch是一个计算机函数，在windows平台下从控制台无回显地取一个字符，在linux下是有回显的。用法是int getch(void)。在WINDOWS/MS-DOS中，也可以利用getch()函数让程序调试运行结束后等待编程者按下键盘才返回编辑界面,用法：包含conio.h头文件后，在主函数结尾，return 0;之前加上getch();即可</p></blockquote><p>关于getch、getchar、getche的区别可查看往期笔记：<a href="https://zhengnianli.github.io/2018/10/11/c-yu-yan-bi-ji-getchar-getche-getch-de-qu-bie/">【C语言笔记】getchar()、getche()、getch()的区别</a></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C编程练习001</title>
      <link href="/2019/05/29/c-bian-cheng-lian-xi-001/"/>
      <url>/2019/05/29/c-bian-cheng-lian-xi-001/</url>
      
        <content type="html"><![CDATA[<h2 id="1、题目"><a href="#1、题目" class="headerlink" title="1、题目"></a>1、题目</h2><blockquote><p>斐波纳契数列 1，1，2，3，5，8，13，21，34，55，89……这个数列则称为“斐波纳契数列”，其中每个数字都是“斐波纳契数”。</p></blockquote><h3 id="1-1-输入与输出"><a href="#1-1-输入与输出" class="headerlink" title="1.1 输入与输出"></a>1.1 输入与输出</h3><blockquote><p>输入：一个整数N(N不能大于40)</p></blockquote><blockquote><p>输出：由N个“斐波纳契数”组成的“斐波纳契数列”。</p></blockquote><h3 id="1-2-样例输入与输出"><a href="#1-2-样例输入与输出" class="headerlink" title="1.2 样例输入与输出"></a>1.2 样例输入与输出</h3><blockquote><p>样例输入：6</p></blockquote><blockquote><p>样例输出：1 1 2 3 5 8</p></blockquote><h2 id="2、代码"><a href="#2、代码" class="headerlink" title="2、代码"></a>2、代码</h2><blockquote><p>规律：当前数=前一个数+前前一个数。如<code>2=1+1, 5=3+2, 8=5+3</code>。有两种方法求解，一种方法是使用<code>迭代法</code>，另一种方法是通过<code>递归</code>的方式。完整代码如下：</p></blockquote><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/********************************************************************************************************* 题    目: 斐波纳契数列1，1，2，3，5，8，13，21，34，55，89……                 这个数列则称为“斐波纳契数列”，其中每个数字都是“斐波纳契数”。** 输    入: 一个整数N(N不能大于40)** 输    出: 由N个“斐波纳契数”组成的“斐波纳契数列”。** 样例输入：6    ** 样例输出：1 1 2 3 5 8 ********************************************************************************************************/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span>  Method   0  </span><span class="token comment" spellcheck="true">// 1：迭代法  0：递归法</span><span class="token macro property">#<span class="token directive keyword">if</span> Method </span><span class="token comment" spellcheck="true">// 方法一：迭代法</span><span class="token keyword">long</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">long</span> result<span class="token punctuation">;</span>    <span class="token keyword">long</span> pre_result<span class="token punctuation">;</span>    <span class="token keyword">long</span> pre_pre_result<span class="token punctuation">;</span>    pre_result <span class="token operator">=</span> pre_pre_result <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        result <span class="token operator">=</span> pre_result <span class="token operator">+</span> pre_pre_result<span class="token punctuation">;</span>        pre_pre_result <span class="token operator">=</span> pre_result<span class="token punctuation">;</span>        pre_result <span class="token operator">=</span> result<span class="token punctuation">;</span>        n<span class="token operator">--</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">else</span> </span><span class="token comment" spellcheck="true">// 方法二：递归法</span><span class="token keyword">long</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">endif</span></span><span class="token comment" spellcheck="true">// 主函数</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> N<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>N<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%ld "</span><span class="token punctuation">,</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果为：</p><p><img src="https://s2.ax1x.com/2019/06/23/ZPSJ1A.png" alt="ZPSJ1A.png"></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C编程练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C编程练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】#运算符与##运算符</title>
      <link href="/2019/05/07/c-yu-yan-bi-ji-yun-suan-fu-yu-yun-suan-fu/"/>
      <url>/2019/05/07/c-yu-yan-bi-ji-yun-suan-fu-yu-yun-suan-fu/</url>
      
        <content type="html"><![CDATA[<h3 id="1、-运算符"><a href="#1、-运算符" class="headerlink" title="1、#运算符"></a>1、#运算符</h3><p>我们平时使用带参宏时，字符串中的宏参数是没有被替换的。例如：</p><p><a href="https://imgchr.com/i/VbbRo9" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbbRo9.md.png" alt="VbbRo9.md.png"></a></p><p>输出结果为：</p><p><a href="https://imgchr.com/i/VbbqdH" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbbqdH.md.png" alt="VbbqdH.md.png"></a></p><p>然而，我们期望输出的结果是：</p><pre class=" language-c"><code class="language-c"><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">=</span> <span class="token number">25</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">=</span> <span class="token number">27</span></code></pre><p>这该怎么做呢？其实，C语言允许在字符串中包含宏参数。在类函数宏（带参宏）中，<code>#号</code>作为一个<code>预处理运算符</code>，可以<code>把记号转换成字符串</code>。例如，如果A是一个宏形参，那么#A就是转换为字符串”A”的形参名。这个过程称为<code>字符串化（stringizing）</code>。以下程序演示这个过程：</p><p><a href="https://imgchr.com/i/Vbq9OS" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/Vbq9OS.md.png" alt="Vbq9OS.md.png"></a></p><p>输出结果为：</p><p><a href="https://imgchr.com/i/VbqiwQ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbqiwQ.md.png" alt="VbqiwQ.md.png"></a></p><p>这就达到我们想要的结果了。所以，<code>#运算符</code>可以完成<code>字符串化（stringizing）</code>的过程。</p><h3 id="2、-运算符"><a href="#2、-运算符" class="headerlink" title="2、##运算符"></a>2、##运算符</h3><p>与#运算符类似，<code>##运算符</code>可用于类函数宏（带参宏）的替换部分。<code>##运算符</code>可以把两个记号组合成一个记号。例如，可以这样做：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> XNAME(n) x##n</span></code></pre><p>然后，宏XNAME(4)将展开x4。以下程序演示##运算符的用法：</p><p><a href="https://imgchr.com/i/VbqEYn" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbqEYn.md.png" alt="VbqEYn.md.png"></a></p><p>输出结果为：</p><p><a href="https://imgchr.com/i/VbqdmD" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbqdmD.md.png" alt="VbqdmD.md.png"></a></p><p>注意：<code>PRINT_XN()</code>宏用<code>#运算符</code>组合字符串，<code>##运算符</code>把记号组合为一个新的标识符。</p><p>其实，<code>##运算符</code>在这里看来并没有起到多大的便利，反而会让我们感觉到不习惯。但是，使用<code>##运算符</code>有时候是可以提高封装性及程序的可读性的。如跑实时操作系统的stm32程序中，关于gpio的硬件驱动中有如下代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> __STM32_PIN(index, gpio, gpio_index) \{ \index, GPIO##gpio##_CLK_ENABLE, GPIO##gpio, GPIO_PIN_##gpio_index \}</span></code></pre><p>假设这样使用该宏：</p><pre class=" language-c"><code class="language-c"><span class="token function">__STM32_PIN</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> C<span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span></code></pre><p>该宏将展开为：</p><pre class=" language-c"><code class="language-c"><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span> GPIOC_CLK_ENABLE<span class="token punctuation">,</span> GPIOC<span class="token punctuation">,</span> GPIO_PIN_13<span class="token punctuation">}</span></code></pre><p>然后这就可以很方便的将要使用的硬件引脚这么一一列出来，然后再拿去进行配置：</p><p><a href="https://imgchr.com/i/ZC60ij" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/23/ZC60ij.md.png" alt="ZC60ij.md.png"></a></p><p>以上就是关于#运算符与##运算符的笔记，用#运算符组合字符串，##运算符把记号组合为一个新的标识符。如有错误欢迎指出。资料：『RT-Thread-IoT代码』、『C Primer Plus』。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】带参宏定义（二）</title>
      <link href="/2019/03/26/c-yu-yan-bi-ji-dai-can-hong-ding-yi-er/"/>
      <url>/2019/03/26/c-yu-yan-bi-ji-dai-can-hong-ding-yi-er/</url>
      
        <content type="html"><![CDATA[<p>带参宏在我们的嵌入式编程中使用得非常多，其定义如下：</p><pre class=" language-c"><code class="language-c">define 标识符<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span> 字符序列</code></pre><p>其中参数列表中的参数之间用逗号分隔，字符序列中应包含参数表中的参数。在定义带参数的宏时，宏名标识符与左圆括号之间不允许有空白符，应紧接在一起，否则变成了无参数的宏定义。</p><p>并且，字符序列与其每一个参数必须用括号扩起来，否则该宏定义可能会产生<code>二义性</code> 。下面举个简单的例子，定义一个求平方的宏函数：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> SQUARE(a) a*a </span><span class="token comment" spellcheck="true">// 不严谨的写法</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  res <span class="token operator">=</span> <span class="token function">SQUARE</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"res = %d\n"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输出结果如下：<br><a href="https://imgchr.com/i/VbO7LT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbO7LT.md.png" alt="VbO7LT.md.png"></a><br><code>res</code>变量的输出结果为17，与我们期望的<code>res = 49;</code>相差甚远！这就是因为我们不给字符序列中的宏参数加括号的原因，产生了歧义。程序生成可执行程序之前的预处理过程中把SQUARE(x+2)替换成了<code>x+2*x+2</code>，因此当<code>x=5</code>时res的结果为17。我们可以使用命令<code>gcc -E hello.c -o hello.i</code>进行预处理，然后查看经过预处理得到的文件<code>hello.i</code>的内容，<code>hello.i</code>里的内容如下：<br><a href="https://imgchr.com/i/VbOqwF" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbOqwF.md.png" alt="VbOqwF.md.png"></a><br><code>hello.i</code>里的内容与我们上面分析的一致！关于C程序的编译原理可查看往期笔记：<a href="https://zhengnianli.github.io/2018/10/14/c-yu-yan-bi-ji-c-yu-yan-bian-yi-de-guo-cheng/">【C语言笔记】C语言编译的过程</a>关于windows系统下使用<code>gcc编译器</code>的方法可参考往期笔记：<a href="https://zhengnianli.github.io/2018/10/05/c-yu-yan-bi-ji-shi-yong-notepad-mingw-lai-kai-fa-c-cheng-xu/">【C语言笔记】使用notepad++、MinGW来开发C程序</a></p><p>以上程序严谨的求平方的宏函数的定义如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> SQUARE(a) ((a)*(a)) </span><span class="token comment" spellcheck="true">// 严谨的做法</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  res <span class="token operator">=</span> <span class="token function">SQUARE</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"res = %d\n"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序输出结果如下：<br><a href="https://imgchr.com/i/VbjPcq" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbjPcq.md.png" alt="VbjPcq.md.png"></a><br>可见，这才是我们要的正确结果。</p><p>带参宏到底有多重要，看看TI的一些官方例程就知道，其把很多算法使用带参宏封装起来，用户就可以很方便的使用。</p><h5 id="带参宏——-clarke变换算法："><a href="#带参宏——-clarke变换算法：" class="headerlink" title="带参宏—— clarke变换算法："></a>带参宏—— clarke变换算法：</h5><p><a href="https://imgchr.com/i/VbjABT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbjABT.md.png" alt="VbjABT.md.png"></a></p><h5 id="带参宏——-PI调节器算法："><a href="#带参宏——-PI调节器算法：" class="headerlink" title="带参宏—— PI调节器算法："></a>带参宏—— PI调节器算法：</h5><p><a href="https://imgchr.com/i/VbjEHU" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbjEHU.md.png" alt="VbjEHU.md.png"></a></p><h5 id="这些-h文件都使用宏来封装各种算法："><a href="#这些-h文件都使用宏来封装各种算法：" class="headerlink" title="这些.h文件都使用宏来封装各种算法："></a>这些.h文件都使用宏来封装各种算法：</h5><p><a href="https://imgchr.com/i/VbjeN4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbjeN4.md.png" alt="VbjeN4.md.png"></a></p><p>同样，ST官方固件库中也大量使用带参宏：<br><a href="https://imgchr.com/i/Vbj8HO" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/Vbj8HO.md.png" alt="Vbj8HO.md.png"></a><br><a href="https://imgchr.com/i/Vbjrb8" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/Vbjrb8.md.png" alt="Vbjrb8.md.png"></a><br><a href="https://imgchr.com/i/Vbj5rV" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/Vbj5rV.md.png" alt="Vbj5rV.md.png"></a><br>可见带参宏定义的重要性！除此之外，通过以上宏定义，可发现很多宏定义分行时，其行后都加上反斜杠<code>\</code>进行分隔，这也是需要注意的细节。</p><h3 id="带参宏与函数的区别"><a href="#带参宏与函数的区别" class="headerlink" title="带参宏与函数的区别"></a>带参宏与函数的区别</h3><p>查看以上带参宏，我们发现带参宏似乎与函数似乎长得很像，它们之间有什么区别和联系呢？TI为什么要使用宏来对一些算法进行封装呢，难道使用函数来封装不可以吗？答案是可以的：<br><a href="https://imgchr.com/i/VbjIbT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/18/VbjIbT.md.png" alt="VbjIbT.md.png"></a><br>TI也说了，使用者可以很方便地把这些算法宏转换成一些函数。换句话说就是你可以使用宏定义，也可以使用函数。那么，什么时候封装成宏定义比较好，什么时候封装成函数比较好呢？</p><p>以下内容参考文章：<br><a href="http://blog.sina.com.cn/s/blog_861912cd0100tc94.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_861912cd0100tc94.html</a><br>下面，先看一下带参宏与函数的一些区别，举个例子，比较两个数或者表达式大小：</p><p>（1）带参宏的方式：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> MAX(a,b) ((a)>(b)?(a):(b))</span></code></pre><p>（2）函数封装的方式：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>　　<span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">></span> b <span class="token operator">?</span> a <span class="token punctuation">:</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>很显然，我们不会选择用函数来完成这个任务，原因有两个：</p><p>（1）首先，函数调用会带来额外的开销，它需要开辟一片栈空间，记录返回地址，将形参压栈，从函数返回还要释放堆栈。这种开销不仅会降低代码效率，而且代码量也会大大增加，而使用宏定义则在代码规模和速度方面都比函数更胜一筹；</p><p>（2）其次，函数的参数必须被声明为一种特定的类型，所以它只能在类型合适的表达式上使用，我们如果要比较两个浮点型的大小，就不得不再写一个专门针对浮点型的比较函数。反之，上面的那个宏定义可以用于整形、长整形、单浮点型、双浮点型以及其他任何可以用“&gt;”操作符比较值大小的类型，也就是说，宏是与类型无关的。</p><p>除此之外，宏与函数的不同点还有：宏是在预处理阶段展开，占用的是编译时间，函数实在程序运行时调用的，占用的是程序运行的时间；宏参数没有类型说明，也没有返回值的概念。</p><p>和使用函数相比，使用宏的不利之处在于每次使用宏时，一份宏定义代码的拷贝都会插入到程序中。除非宏非常短，否则使用宏会大幅度增加程序的长度。</p><p>还有一些任务根本无法用函数实现，但是用宏定义却很好实现。比如参数类型没法作为参数传递给函数，但是可以把参数类型传递给带参的宏。</p><p>看下面的例子：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> MALLOC（n, type）\　　（(type *) malloc（（n）* sizeof（type）））</span></code></pre><p>利用这个宏，我们就可以为任何类型分配一段我们指定的空间大小，并返回指向这段空间的指针。我们可以观察一下这个宏确切的工作过程：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>ptr <span class="token operator">=</span> <span class="token function">MALLOC</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>将这宏展开以后的结果：</p><pre class=" language-c"><code class="language-c">ptr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这个例子是宏定义的经典应用之一，完成了函数不能完成的功能，但是宏定义也不能滥用，通常，如果相同的代码需要出现在程序的几个地方，更好的方法是把它实现为一个函数。</p><h3 id="宏的缺点"><a href="#宏的缺点" class="headerlink" title="宏的缺点"></a>宏的缺点</h3><ul><li>宏可能会大幅度增加程序的长度。</li><li>宏是没法调试的。</li><li>宏由于与类型无关，也就不够严谨。</li><li>宏可能会带来运算符的优先级问题，即二义性。</li></ul><p>以上就是关于带参宏的一些总结，如有错误，欢迎指出！</p><hr><p>我的微信公众号如下，欢迎扫码关注查看更多分享：<br><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】带参宏定义（一）</title>
      <link href="/2019/03/23/c-yu-yan-bi-ji-dai-can-hong-ding-yi-yi/"/>
      <url>/2019/03/23/c-yu-yan-bi-ji-dai-can-hong-ding-yi-yi/</url>
      
        <content type="html"><![CDATA[<p>公司某项目用到<code>DSP+FPGA</code>架构（当然不是著名的ARM+DSP+FPGA点灯项目,哈哈），我的发展方向为DSP方向。其中DSP与FPGA通过两个带参宏进行数据交互（DSP与FPGA通过一块共享内存来实现数据交互，我这边的DSP只要往共享内存中写入数据即为往FPGA中写数据，往共享内存中读取数据就是读取FPGA发送过来的数据），如下图：</p><p><a href="https://imgchr.com/i/VbYz7t" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VbYz7t.md.png" alt="VbYz7t.md.png"></a></p><p>也即：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">define</span> FPGA_WRITE(data_out, base_addr, offset)  \((((volatile uint32*)base_addr)[(offset)]) = (data_out))</span><span class="token macro property">#<span class="token directive keyword">define</span> FPGA_READ(data_in, base_addr, offset)    \((data_in) = (((volatile uint32*)base_addr)[(offset)]))</span></code></pre><p>带参宏也称做<code>宏函数</code>，宏函数<code>FPGA_WRITE(data_out, base_addr, offset)</code>用于往FPGA发送数据。其中</p><ul><li><p><strong>参数data_out：</strong>要写入的数据。</p></li><li><p><strong>参数base_addr：</strong>基地址。</p></li><li><p><strong>参数offset：</strong>相对于基地址的偏移量。</p></li></ul><p>该宏函数实体为：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data_out<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>我们先看等号左边，从最里层的括号开始看，<code>(volatile uint32*)base_addr</code>的意思是把<code>base_addr</code>强制转换为<code>(volatile uint32*)</code>类型的数据，其中加volatile关键字的作用是确保本条指令不会因编译器的优化而省略。volatile在嵌入式编程中用得很多，如在Cortex-M3内核MCU的内核文件的C函数内嵌汇编中使用了大量的volatile关键字：</p><p><a href="https://imgchr.com/i/VbtpAP" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VbtpAP.md.png" alt="VbtpAP.md.png"></a></p><p>关于volatile关键字更多的介绍可查看往期分享：<br><a href="https://zhengnianli.github.io/2018/10/17/%E3%80%90C%E8%AF%AD%E8%A8%80%E7%AC%94%E8%AE%B0%E3%80%91volatile%E5%85%B3%E9%94%AE%E5%AD%97/">【C语言笔记】volatile关键字</a></p><p><code>((volatile uint32*)base_addr)[(offset)]</code>的意思是相对于base_addr偏移offset个内存单元后所占的空间，此时已经转变为了<code>base_addr[offset]</code>，这就可以看做数组base_addr的第offset个元素，所以可以给它赋值。等号右边的数据data_out就是给数组元素base_addr[offset]进行赋值的。数组和指针在此处其实是可以等价的，所以</p><pre class=" language-cpp"><code class="language-cpp"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">]</span></code></pre><p>其实可以等价为：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span></code></pre><p>宏函数<code>FPGA_READ(data_in, base_addr, offset)</code>用于读取FPGA发送过来的数据，其实体为：</p><pre class=" language-CPP"><code class="language-CPP">((data_in) = (((volatile uint32*)base_addr)[(offset)]))</code></pre><p>同写函数的分析方法类似，此处从等号右边的最里层括号开始看，分析过程省略，具体的可查看写数据函数<code>FPGA_WRITE</code>的分析过程。此处等号右边的</p><pre class=" language-cpp"><code class="language-cpp"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>可以等价于：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>为什么要在宏函数实体的参数的两边加上括号呢？为什么要在宏函数实体的两边加上括号呢？</p><p>答：虽然有时候不加括号也没什么问题，但是，更严格的做法是给参数加括号、给宏函数实体加括号，这样可以避免<strong><code>二义性</code></strong>。关于宏函数的二义性将在下一篇笔记中分享，欢迎阅读！</p><h3 id="以上两个带参宏的测试用例"><a href="#以上两个带参宏的测试用例" class="headerlink" title="以上两个带参宏的测试用例"></a>以上两个带参宏的测试用例</h3><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/********************************************************************************* 宏函数FPGA_WRITE、FPGA_READ测试用例******************************************************************************/</span>#include <span class="token operator">&lt;</span>stdio<span class="token punctuation">.</span>h<span class="token operator">></span>#define uint32 unsigned <span class="token keyword">int</span>#<span class="token keyword">if</span> <span class="token number">1</span><span class="token comment" spellcheck="true">// 调用这两个宏可往共享内存中读写数据</span>#define <span class="token function">FPGA_WRITE</span><span class="token punctuation">(</span>data_out<span class="token punctuation">,</span> base_addr<span class="token punctuation">,</span> offset<span class="token punctuation">)</span> \<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data_out<span class="token punctuation">)</span><span class="token punctuation">)</span>#define <span class="token function">FPGA_READ</span><span class="token punctuation">(</span>data_in<span class="token punctuation">,</span> base_addr<span class="token punctuation">,</span> offset<span class="token punctuation">)</span> \<span class="token punctuation">(</span><span class="token punctuation">(</span>data_in<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>#<span class="token keyword">else</span><span class="token comment" spellcheck="true">// 以上宏等效的写法</span>#define <span class="token function">FPGA_WRITE</span><span class="token punctuation">(</span>data_out<span class="token punctuation">,</span> base_addr<span class="token punctuation">,</span> offset<span class="token punctuation">)</span> \<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data_out<span class="token punctuation">)</span><span class="token punctuation">)</span>#define <span class="token function">FPGA_READ</span><span class="token punctuation">(</span>data_in<span class="token punctuation">,</span> base_addr<span class="token punctuation">,</span> offset<span class="token punctuation">)</span> \<span class="token punctuation">(</span><span class="token punctuation">(</span>data_in<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> uint32<span class="token operator">*</span><span class="token punctuation">)</span>base_addr<span class="token punctuation">)</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">)</span>#endif<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// 变量定义</span>  uint32 arr<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  uint32 <span class="token operator">*</span>ptr <span class="token operator">=</span> arr<span class="token punctuation">;</span>  uint32 data_write <span class="token operator">=</span> <span class="token number">520</span><span class="token punctuation">;</span>  uint32 data_read <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 验证宏函数FPGA_WRITE</span>  <span class="token function">FPGA_WRITE</span><span class="token punctuation">(</span>data_write<span class="token punctuation">,</span> ptr<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 此时arr[3]的值会被data_write的值覆盖</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"arr[3] = %d\n"</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>data_write <span class="token operator">==</span> arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"宏函数FPGA_WRITE验证成功！\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// 验证宏函数FPGA_READ</span>  <span class="token function">FPGA_READ</span><span class="token punctuation">(</span>data_read<span class="token punctuation">,</span> ptr<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 此时data_read的值会被arr[5]的值覆盖</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"data_read = %d\n"</span><span class="token punctuation">,</span> data_read<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>data_read <span class="token operator">==</span> arr<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"宏函数FPGA_READ验证成功！\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><strong>以上的测试方法是：</strong>定义一个数组arr，定义一个基地址ptr（指针变量），基地址ptr指向arr，此时ptr就可以与数组arr相关联起来了，即相对于ptr偏移offset个内存单元其实就是等价于arr[offset]。</p><pre class=" language-cpp"><code class="language-cpp"><span class="token function">FPGA_WRITE</span><span class="token punctuation">(</span>data_write<span class="token punctuation">,</span> ptr<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这条语句的意思就是往ptr往后第3个内存单元写入数据data_write，即<code>arr[3] = data_write;</code>，arr[3]由原来的3变成了520。</p><pre class=" language-cpp"><code class="language-cpp"><span class="token function">FPGA_READ</span><span class="token punctuation">(</span>data_read<span class="token punctuation">,</span> ptr<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p> 这条语句的意思就是把ptr往后第5个内存单元中的数据赋给data_read变量，即data_read = arr[5];，data_read由原来的0变成了5。程序运行结果如下：<br><img src="https://s2.ax1x.com/2019/06/17/Vbti9S.png" alt="Vbti9S.png"></p><p>可见，程序输出结果与我们分析的一致！带参宏很重要，在一定程度上可以帮助我们防止出错，<strong><code>提高代码的可移植性和可读性</code></strong>等，应重点掌握。下一篇笔记我们将分享更多的带参宏的笔记，欢迎阅读。</p><hr><p>我的微信公众号如下，欢迎扫码关注查看更多分享：<br><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】指定初始化器</title>
      <link href="/2019/02/16/c-yu-yan-bi-ji-zhi-ding-chu-shi-hua-qi/"/>
      <url>/2019/02/16/c-yu-yan-bi-ji-zhi-ding-chu-shi-hua-qi/</url>
      
        <content type="html"><![CDATA[<p> <code>C99</code>增加了一个新特性：<code>指定初始化器(designated initializer)</code>。利用该特性可以初始化指定的数组元素，也可以初始化指定的结构体变量（往期笔记<a href="https://zhengnianli.github.io/2019/01/22/c-yu-yan-bi-ji-jie-gou-ti/">【C语言笔记】结构体</a>有用到这个特性对结构体变量进行初始化）。</p><p>本笔记主要分享：使用指定初始化器初始化数组。</p><blockquote><p>例如，只初始化数组中的最后一个元素。</p></blockquote><p>对于传统的C初始化语法，必须初始化最后一个元素所有元素，才能初始化它：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">212</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//传统的语法</span></code></pre><p>而<code>C99</code>规定，可以在初始化列表中使用带方括号的下标指明待初始化的元素：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">212</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//把arr[5]初始化为212</span></code></pre><p>对于一般的初始化，在初始化一个元素后，未初始化的元素都会被设置为0。</p><p>下面看一段程序：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">/* designate.c--使用指定初始化器 */</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> MONTHS 12</span><span class="token keyword">int</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> days<span class="token punctuation">[</span>MONTHS<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">29</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MONTHS<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%2d  %d\n"</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> days<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>该程序在支持<code>C99</code>的编译器中输出如下：</p><pre class=" language-cpp"><code class="language-cpp"> <span class="token number">1</span>  <span class="token number">31</span> <span class="token number">2</span>  <span class="token number">29</span> <span class="token number">3</span>  <span class="token number">0</span> <span class="token number">4</span>  <span class="token number">0</span> <span class="token number">5</span>  <span class="token number">31</span> <span class="token number">6</span>  <span class="token number">30</span> <span class="token number">7</span>  <span class="token number">31</span> <span class="token number">8</span>  <span class="token number">0</span> <span class="token number">9</span>  <span class="token number">0</span><span class="token number">10</span>  <span class="token number">0</span><span class="token number">11</span>  <span class="token number">0</span><span class="token number">12</span>  <span class="token number">0</span></code></pre><p>以上输出揭示了指定初始化器的两个重要特性：</p><p>【第一】如果指定初始化器后面有更多的值，如该例中的初始化列表中的片段： <code>[4] =31, 30, 31</code>，那么后面这些值将被用于初始化指定元素后面的元素。也就是说，在<code>days[4]</code>被初始化为31后，<code>days[5]</code>和<code>days[6]</code>将分别被初始化为30和31；</p><p>【第二】，如果再次初始化指定的元素，那么最后的初始化将会取代之前的初始化。本例中，初始化列表开始时把<code>days[1]</code>初始化为28，但是days[1]又被后面的指定初始化<code>[1] = 29</code>初始化为29。</p><p>如果未指定元素大小会怎样?</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">int</span> stuff<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//会发生什么?</span><span class="token keyword">int</span> staff<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//会发生什么?</span></code></pre><p>编译器会把数组的大小设置为足够装得下初始化的值。所以，<code>stuff</code>数组有7个元素，编号为0~6；<code>staff</code>数组的元素比<code>stuff</code>数组多两个(即有9个元素)。</p><p>以上就是指定初始化器的笔记。</p><p>参考摘抄：《C Primer Plus第六版》</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】操作位的技巧</title>
      <link href="/2019/02/15/c-yu-yan-bi-ji-cao-zuo-wei-de-ji-qiao/"/>
      <url>/2019/02/15/c-yu-yan-bi-ji-cao-zuo-wei-de-ji-qiao/</url>
      
        <content type="html"><![CDATA[<h3 id="一、操作位的方法"><a href="#一、操作位的方法" class="headerlink" title="一、操作位的方法"></a>一、操作位的方法</h3><p>操作位有两种方法，一种是<code>位字段</code>，另一种是使用<code>按位运算符</code>。位字段的方法可查看往期笔记：<a href="https://zhengnianli.github.io/2019/02/14/c-yu-yan-bi-ji-wei-yu/">【C语言笔记】位域</a>。本文介绍使用按位运算符操作位的方法。下表为几种位操作符及其含义：</p><p><a href="https://imgchr.com/i/VH0Pit" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH0Pit.md.png" alt="VH0Pit.md.png"></a></p><h3 id="二、不改变其他位的值的状况下，对某几个位进行设值。"><a href="#二、不改变其他位的值的状况下，对某几个位进行设值。" class="headerlink" title="二、不改变其他位的值的状况下，对某几个位进行设值。"></a>二、不改变其他位的值的状况下，对某几个位进行设值。</h3><p>在<code>嵌入式编程</code>中，常常需要对一些寄存器进行配置，有的情况下需要改变一个字节中的某一位或者几位，但是又不想改变其它位原有的值，这时就可以使用按位运算符进行操作。下面进行举例说明，假如有一个8位的TEST寄存器：</p><p><a href="https://imgchr.com/i/VH0QJ0" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH0QJ0.md.png" alt="VH0QJ0.md.png"></a></p><p>当我们要设置第0位bit0的值为1时，可能会这样进行设置：</p><pre class=" language-cpp"><code class="language-cpp">TEST <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span></code></pre><p>但是，这样设置是不够准确的，因为这时候已经同时操作到了高7位：<code>bit1~bit7</code>，如果这高7位没有用到的话，这么设置没有什么影响；但是，如果这7位正在被使用，结果就不是我们想要的了。</p><p>在这种情况下，我们就可以借用<code>&amp;</code>和<code>|</code>进行配置。</p><p>对于二进制位操作来说，不管该位原来的值是0还是1，它跟0进行&amp;运算，得到的结果都是0，而跟1进行&amp;运算，将保持原来的值不变；不管该位原来的值是0还是1，它跟1进行|运算，得到的结果都是1，而跟0进行|运算，将保持原来的值不变。</p><p>所以，此时可以设置为：</p><pre class=" language-cpp"><code class="language-cpp">TEST <span class="token operator">=</span> TEST <span class="token operator">|</span> <span class="token number">0x01</span><span class="token punctuation">;</span></code></pre><p>其意义为：<code>TEST寄存器</code>的高7位均不变，最低位变成1了。在实际编程中，常改写为：</p><pre class=" language-cpp"><code class="language-cpp">TEST <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span></code></pre><p>这种写法可以一定程度上简化代码，是 C 语言常用的一种编程风格。</p><p>同样的，要给<code>TEST</code>的低4位清0，高4位保持不变，可以进行如下配置：</p><pre class=" language-cpp"><code class="language-cpp">TEST <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token number">0xF0</span><span class="token punctuation">;</span></code></pre><p>这个场景<code>嵌入式开发</code>中经常使用，方法就是先对需要设置的位用<code>&amp;</code>操作符进行清零操作，然后用|操作符设值。比如我要改变<code>GPIOA</code>的状态,可以先对寄存器的值进行<code>&amp;</code>清零操作：</p><pre class=" language-cpp"><code class="language-cpp">GPIOA<span class="token operator">-</span><span class="token operator">></span>CRL <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token number">0XFFFFFF0F</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//将第4-7位清0</span></code></pre><p>然后再与需要设置的值进行|或运算：</p><pre class=" language-cpp"><code class="language-cpp">GPIOA<span class="token operator">-</span><span class="token operator">></span>CRL <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">0X00000040</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//设置相应位的值，不改变其他位的值</span></code></pre><p>移位操作提高代码的可读性。</p><p>移位操作在单片机开发中也非常重要，下面让我们看看固件库的<code>GPIO</code>初始化的函数里面的一行代码：</p><pre class=" language-cpp"><code class="language-cpp">GPIOx<span class="token operator">-</span><span class="token operator">></span>BSRR <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span><span class="token number">0x01</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> pinpos<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这个操作就是将<code>BSRR</code>寄存器的第<code>pinpos</code>位设置为<code>1</code>，为什么要通过左移而不是直接设置一个固定的值呢？其实，这是为了提高代码的可读性以及可重用性。这行代码可以很直观明了的知道，是将第<code>pinpos</code>位设置为<code>1</code>。如果你写成：</p><pre class=" language-cpp"><code class="language-cpp">GPIOx<span class="token operator">-</span><span class="token operator">></span>BSRR <span class="token operator">=</span> <span class="token number">0x0030</span><span class="token punctuation">;</span></code></pre><p>这样的代码就不好看也不好重用了。<br>类似这样的代码很多:</p><pre class=" language-cpp"><code class="language-cpp">GPIOA<span class="token operator">-</span><span class="token operator">></span>ODR <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//PA.5输出高,不改变其他位</span></code></pre><p>这样我们一目了然，5告诉我们是第5位也就是第6个端口，1告诉我们是设置为1了。</p><h3 id="三、-取反操作使用技巧"><a href="#三、-取反操作使用技巧" class="headerlink" title="三、~取反操作使用技巧"></a>三、~取反操作使用技巧</h3><p><code>SR寄存器</code>的每一位都代表一个状态，某个时刻我们希望去设置某一位的值为0，同时其他位都保留为1，简单的作法是直接给寄存器设置一个值：</p><pre class=" language-cpp"><code class="language-cpp">TIMx<span class="token operator">-</span><span class="token operator">></span>SR <span class="token operator">=</span> <span class="token number">0xFFF7</span>；</code></pre><p>这样的作法设置第3位为0，但是这样的作法同样不好看，并且可读性很差。看看库函数代码中怎样使用的：</p><pre class=" language-cpp"><code class="language-cpp">TIMx<span class="token operator">-</span><span class="token operator">></span>SR <span class="token operator">=</span> <span class="token punctuation">(</span>uint16_t<span class="token punctuation">)</span><span class="token operator">~</span>TIM_FLAG<span class="token punctuation">;</span></code></pre><p>而TIM_FLAG 是通过宏定义定义的值：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_Update  ((uint16_t)0x0001)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_CC1     ((uint16_t)0x0002)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_CC2     ((uint16_t)0x0004)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_CC3     ((uint16_t)0x0008)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_CC4     ((int16_t)0x0010)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_COM     ((uint16_t)0x0020)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_Trigger ((uint16_t)0x0040)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_Break   ((uint16_t)0x0080)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_CC1OF   ((uint16_t)0x0200)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_CC2OF   ((uint16_t)0x0400)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_CC3OF   ((uint16_t)0x0800)</span><span class="token macro property">#<span class="token directive keyword">define</span> TIM_FLAG_CC4OF   ((uint16_t)0x1000)</span></code></pre><p>即设置<code>SR</code>第3位为0时可设置为：</p><pre class=" language-cpp"><code class="language-cpp">TIMx<span class="token operator">-</span><span class="token operator">></span>SR <span class="token operator">=</span> <span class="token punctuation">(</span>uint16_t<span class="token punctuation">)</span><span class="token operator">~</span>TIM_FLAG_CC3<span class="token punctuation">;</span></code></pre><p>以上就是关于位操作在嵌入式编程中的一些技巧，如有错误，欢迎指出！</p><h3 id="四、参考资料"><a href="#四、参考资料" class="headerlink" title="四、参考资料"></a>四、参考资料</h3><p>《STM32F1开发指南-库函数版本_V3.1 》</p><p>《手把手教你学51单片机》</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】位域</title>
      <link href="/2019/02/14/c-yu-yan-bi-ji-wei-yu/"/>
      <url>/2019/02/14/c-yu-yan-bi-ji-wei-yu/</url>
      
        <content type="html"><![CDATA[<h3 id="位域的概念"><a href="#位域的概念" class="headerlink" title="位域的概念"></a>位域的概念</h3><p>有些数据在存储时并不需要占用一个完整的字节，只需要占用一个或几个二进制位即可。例如开关只有通电和断电两种状态，用 0 和 1 表示足以，也就是用一个二进位。正是基于这种考虑，C语言又提供了一种数据结构，叫做<code>位域</code>或<code>位段</code>。</p><p>位域是操控位的一种方法（操控位的另一种方法是使用按位运算符，按位运算符将在之后的笔记中做介绍）。</p><p>位域通过一个结构声明来建立：该结构声明为每个字段提供标签，并确定该字段的宽度。例如，下面的声明建立了个4个1位的字段：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token punctuation">{</span>   <span class="token keyword">unsigned</span> <span class="token keyword">int</span> autfd<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token keyword">unsigned</span> <span class="token keyword">int</span> bldfc<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token keyword">unsigned</span> <span class="token keyword">int</span> undin<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token keyword">unsigned</span> <span class="token keyword">int</span> itals<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>prnt<span class="token punctuation">;</span></code></pre><p>根据该声明， prnt包含4个1位的字段。现在，可以通过普通的结构成员运算符<code>.</code>单独给这些字段赋值：</p><pre class=" language-cpp"><code class="language-cpp">prnt<span class="token punctuation">.</span>itals <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span>prnt<span class="token punctuation">.</span>undin <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></code></pre><p>由于每个字段恰好为1位，所以只能为其赋值<code>1或0</code>。变量<code>prnt</code>被储存在<code>int</code>大小的内存单元中，但是在本例中只使用了其中的4位。</p><p> <code>:</code>后面的数字用来限定成员变量占用的位数。位域的宽度不能超过它所依附的数据类型的长度。通俗地讲，成员变量都是有类型的，这个类型限制了成员变量的最大长度，<code>:</code>后面的数字不能超过这个长度。</p><p>如上述结构中<code>autfd、bldfc、undin、itals</code>后面的数字不能超过<code>unsigned int</code>的位数，即在<code>32bi</code>t环境中就是不能超过32。</p><p>位域的取值范围非常有限，数据稍微大些就会发生溢出，请看下面的例子：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">struct</span> pack<span class="token punctuation">{</span> <span class="token keyword">unsigned</span> a<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 取值范围为：0~3</span> <span class="token keyword">unsigned</span> b<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// 取值范围为：0~15</span> <span class="token keyword">unsigned</span> c<span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// 取值范围为：0~63</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">struct</span> pack pk1<span class="token punctuation">;</span> <span class="token keyword">struct</span> pack pk2<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 给pk1各成员赋值并打印输出</span> pk1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> pk1<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> pk1<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d, %d, %d\n"</span><span class="token punctuation">,</span> pk1<span class="token punctuation">.</span>a<span class="token punctuation">,</span> pk1<span class="token punctuation">.</span>b<span class="token punctuation">,</span> pk1<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 给pk2各成员赋值并打印输出</span> pk2<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> pk2<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> pk2<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">66</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d, %d, %d\n"</span><span class="token punctuation">,</span> pk2<span class="token punctuation">.</span>a<span class="token punctuation">,</span> pk2<span class="token punctuation">.</span>b<span class="token punctuation">,</span> pk2<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序输出结果为：</p><pre class=" language-cpp"><code class="language-cpp">pk1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> pk1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> pk1<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">5</span>pk2<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> pk2<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> pk2<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">2</span></code></pre><p>显然，结构体变量<code>pk1</code>的各成员都没有超出限定的位数，能够正常输出。而结构体变量<code>pk2</code>的各成员超出了限定的位数，并发生了<code>上溢</code>（溢出中的一种），关于溢出的概念可查看往期笔记：<a href="https://zhengnianli.github.io/2019/01/10/c-yu-yan-bi-ji-zheng-shu-yi-chu-wen-ti/">【C语言笔记】整数溢出</a></p><p>C语言标准规定，只有有限的几种数据类型可以用于位域。在<code>ANSI C</code> 中，这几种数据类型是<code>signed int</code>和<code>unsigned int</code>；到了<code>C99、C11</code>新增了<code>_Bool</code>的位字段。关于C语言的几套标准可查看往期笔记：<a href="https://zhengnianli.github.io/2018/12/06/c-yu-yan-bi-ji-shi-me-shi-ansi-c-biao-zhun/">【C语言笔记】什么是ANSI C标准？</a></p><h3 id="位域的存储"><a href="#位域的存储" class="headerlink" title="位域的存储"></a>位域的存储</h3><p>位域的存储同样遵循结构体内存对齐的规则，关于结构体内存对齐的问题可查看往期笔记：<a href="https://zhengnianli.github.io/2018/10/20/c-yu-yan-bi-ji-jie-gou-ti-nei-cun-dui-qi/">【C语言笔记】C语言结构体内存对齐问题</a></p><p>看一个例子：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">struct</span> pack<span class="token punctuation">{</span> <span class="token keyword">unsigned</span> a<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">;</span>   <span class="token keyword">unsigned</span> b<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> c<span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(struct pack) = %d"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> pack<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序输出结果为：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> pack<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span></code></pre><p>这是因为，a、b、c成员所占的位长之和在一个存储单元（此处为unsigned类型所占的字节数）内，即4个字节内，所以struct pack类型的变量所占的字节长度为4个字节（实际a、b、c一共占用12bit,还有20bit空间为保留的空白）。</p><p>可能有人有疑问，此处a、b、c加起来一共才12bit，两个字节都不到，那么只需要，2个字节不就好了吗。这就是因为内存对齐搞的鬼，此处要将内存对齐到 4 个字节（unsigned类型所占的字节数），以便提高存取效率。</p><p>假如把该结构声明改为：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">struct</span> pack<span class="token punctuation">{</span> <span class="token keyword">unsigned</span> a<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">;</span>   <span class="token keyword">unsigned</span> b<span class="token operator">:</span><span class="token number">24</span><span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> c<span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>那么，输出结构应该为什么呢？</p><p>输出结果为：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> pack<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">8</span></code></pre><p>因为此时a成员单独占一个内存单元（4字节），b、c成员紧挨着占下一个内存单元（4字节），所以结果为8字节，这也是因为内存对齐。a、b、c占用内存的示意图如：</p><p><a href="https://imgchr.com/i/VHBRuF" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHBRuF.md.png" alt="VHBRuF.md.png"></a></p><p>其中，空白部分为保留的空白填充内存。这里的空白内存是系统自动留出的，同时，我们也可以自己留出填充内存。如<code>无名位域</code>就可以用来作填充：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">struct</span> pack<span class="token punctuation">{</span><span class="token keyword">unsigned</span> a<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">;</span>  <span class="token keyword">unsigned</span>  <span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//该位域成员不能使用，用于填充</span><span class="token keyword">unsigned</span> c<span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><code>无名位域一般用来作填充或者调整成员位置。</code>因为没有名称，无名位域不能使用。<br>上面的例子中，如果没有位宽为 20 的无名成员，a、c 将会挨着存储，<code>sizeof(struct pack)</code> 的结果为 4；有了这 20 位作为填充，a、c将分开存储，<code>sizeof(struct pack)</code>的结果为 8。</p><p>位域也是个很重要的知识点，如在<code>DSP2803X</code>的固件库的一些结构封装中普遍用到这样的写法：</p><p><a href="https://imgchr.com/i/VHBWB4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHBWB4.md.png" alt="VHBWB4.md.png"></a></p><p>以上就是关于位域的一些笔记，如有错误，欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】结构体</title>
      <link href="/2019/01/22/c-yu-yan-bi-ji-jie-gou-ti/"/>
      <url>/2019/01/22/c-yu-yan-bi-ji-jie-gou-ti/</url>
      
        <content type="html"><![CDATA[<h3 id="一、同时定义多个变量"><a href="#一、同时定义多个变量" class="headerlink" title="一、同时定义多个变量"></a>一、同时定义多个变量</h3><p>我们都知道C语言中变量的类型决定了变量存储占用的空间。当我们要使用一个变量保存年龄时可以将其声明为<code>int</code>类型，当我们要使用一个变量保存某一科目的考试成绩时可以将其声明为<code>float</code>。</p><p>那么，当我们要做一个学生信息管理系统时，需要保存学生的姓名、学号、年龄等信息，该怎么做呢？</p><p>如当要保存三个学生的信息时，</p><h4 id="方法一是："><a href="#方法一是：" class="headerlink" title="方法一是："></a>方法一是：</h4><pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>name1<span class="token punctuation">,</span><span class="token operator">*</span>name2<span class="token punctuation">,</span><span class="token operator">*</span>name3<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 三个学生的姓名</span><span class="token keyword">int</span> num1<span class="token punctuation">,</span>num2<span class="token punctuation">,</span>num3<span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">// 三个学生的学号</span><span class="token keyword">int</span> age1<span class="token punctuation">,</span>age2<span class="token punctuation">,</span>age3<span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">// 三个学生的年龄</span></code></pre><h4 id="方法二是："><a href="#方法二是：" class="headerlink" title="方法二是："></a>方法二是：</h4><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// 创建结构体模板</span><span class="token keyword">struct</span> student<span class="token punctuation">{</span>  <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 学生名字</span>  <span class="token keyword">int</span> num<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生学号</span>  <span class="token keyword">int</span> age<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生年龄</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 使用该结构体模板创建三个变量stu1, stu2, stu3</span><span class="token keyword">struct</span> student stu1<span class="token punctuation">,</span> stu2<span class="token punctuation">,</span> stu3<span class="token punctuation">;</span></code></pre><p>显然，方法二跟更清晰，因为它把<code>name、num、age</code>都集成在一个模板，要用的时候只要套用模板进行创建即可。这就是<code>结构体</code>。</p><h3 id="二、什么是结构体"><a href="#二、什么是结构体" class="headerlink" title="二、什么是结构体"></a>二、什么是结构体</h3><p><code>结构体(struct)</code>是由一系列具有相同类型或不同类型的数据项构成的数据集合，这些数据项称为结构体的成员。如上面的<code>student</code>结构体包含三个成员，分别是<code>name、num、age</code>。</p><p>结构体是C语言中的一种构造类型。C语言的数据类型如下图：</p><p><a href="https://imgchr.com/i/VHCDJg" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHCDJg.md.png" alt="VHCDJg.md.png"></a></p><h3 id="三、结构体变量的定义方法"><a href="#三、结构体变量的定义方法" class="headerlink" title="三、结构体变量的定义方法"></a>三、结构体变量的定义方法</h3><h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// 创建结构体模板struct student</span><span class="token keyword">struct</span> student<span class="token punctuation">{</span><span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 学生名字</span><span class="token keyword">int</span> num<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生学号</span><span class="token keyword">int</span> age<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生年龄</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 使用该结构体模板创建三个变量stu1, stu2, stu3</span><span class="token keyword">struct</span> student stu1<span class="token punctuation">,</span> stu2<span class="token punctuation">,</span> stu3<span class="token punctuation">;</span></code></pre><p>此处，student是结构体名，该名字是由任意定义的，但是尽量起个有意义的名称。其相当于一个模板，可以使用这个模板去定义变量<code>stu1，stu2，stu3</code>。定义的时候不要忘了<code>struct</code>。</p><h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// 定义三个结构体变量stu1, stu2, stu3</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 学生名字</span><span class="token keyword">int</span> num<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生学号</span><span class="token keyword">int</span> age<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生年龄</span><span class="token punctuation">}</span>stu1<span class="token punctuation">,</span> stu2<span class="token punctuation">,</span> stu3<span class="token punctuation">;</span></code></pre><p>相对于方法一，此处省略了结构体名。虽然更简洁了，但是因为没有了名字，后面就不能用该结构定义新的变量。</p><h4 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h4><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// 给结构体模板struct student重新命名为student</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> student<span class="token punctuation">{</span><span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 学生名字</span><span class="token keyword">int</span> num<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生学号</span><span class="token keyword">int</span> age<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生年龄</span><span class="token punctuation">}</span>student<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 使用student创建三个结构体变量stu1, stu2, stu3</span>student stu1<span class="token punctuation">,</span> stu2<span class="token punctuation">,</span> stu3<span class="token punctuation">;</span></code></pre><p>此处使用<code>typedef</code>为结构体模板<code>struct student</code>定义一个别名<code>student</code>，关于<code>typedef</code>的介绍移步至往期笔记：<a href="https://zhengnianli.github.io/2018/10/11/c-yu-yan-bi-ji-define-yu-typedef-de-qu-bie/">【C语言笔记】#define与typedef的区别？</a>进行查看。使用<code>typedef</code>给结构体创建一个别名，这在实际编程用使用非常广泛，如<code>STM32</code>单片机固件库中，使用得很多，如下图：</p><p><a href="https://imgchr.com/i/VHPZtS" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHPZtS.md.png" alt="VHPZtS.md.png"></a></p><h3 id="四、初始化结构"><a href="#四、初始化结构" class="headerlink" title="四、初始化结构"></a>四、初始化结构</h3><p>初始化变量和数组如下：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>结构体变量是否也可以这样初始化？是的，可以。与初始化数组的语法类似：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> student stu1 <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token string">"ZhengNianJun"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 名字：正念君</span>  <span class="token number">520</span><span class="token punctuation">,</span>            <span class="token comment" spellcheck="true">// 学号：520</span>  <span class="token number">23</span>              <span class="token comment" spellcheck="true">// 年龄：23</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>简而言之，我们使用在一对花括号中括起来的初始化列表进行初始化，各初始化项用逗号分隔。</p><p>为了让初始化项与结构中各成员的关联更加明显，我们让每个成员的初始化项独占一行。这样做只是为了提高代码的可读性，对编译器而言，只需要用逗号分隔各成员的初始化项即可。</p><p><code>C99</code>和<code>C11</code>为结构提供了<code>指定初始化器（designated initializer）</code>。其初始化器使用点运算符和成员名。例如，只初始化<code>student</code>结构中的<code>name</code>成员，可以这样做：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> student stu1 <span class="token operator">=</span><span class="token punctuation">{</span>   <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"ZhengNianJun"</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>也可以按照任意顺序使用指定初始化器：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> student stu1 <span class="token operator">=</span><span class="token punctuation">{</span>   <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">520</span><span class="token punctuation">,</span>   <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"ZhengNianJun"</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>另外，对特定成员的最后一次赋值才是它实际获得的值。例如，考虑如下代码：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> student stu1 <span class="token operator">=</span><span class="token punctuation">{</span>  <span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">520</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"ZhengNianJun"</span>，   <span class="token number">1314</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>此时，赋给<code>num</code>的值应该是<code>1314</code>，因为它在结构声明中紧跟在<code>name</code>成员之后。新值<code>1314</code>取代了之前的<code>520</code>。</p><p>指定初始化器在实际编程中也很常用到。如在<code>linux2.6.32.2</code>源码的<code>usb</code>驱动中（路径为：<code>linux-2.6.32.2\drivers\usb\storage\usb.c</code>），有如下代码：</p><p><a href="https://imgchr.com/i/VHPD76" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHPD76.md.png" alt="VHPD76.md.png"></a></p><h3 id="五、访问结构体成员"><a href="#五、访问结构体成员" class="headerlink" title="五、访问结构体成员"></a>五、访问结构体成员</h3><p>结构体成员的访问需要借助结构体成员运算符——点（.）。如：</p><pre class=" language-c"><code class="language-c">student stu1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 定义一个结构体变量stu1</span>stu1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"ZhengNianJun"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 给stu1的成员name赋值</span>stu1<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">520</span><span class="token punctuation">;</span>             <span class="token comment" spellcheck="true">// 给stu1的成员num赋值</span>stu1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">// 给stu1的成员age赋值</span></code></pre><h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> student<span class="token punctuation">{</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 学生名字</span> <span class="token keyword">int</span> num<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生学号</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// 学生年龄</span><span class="token punctuation">}</span>student<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> student stu1<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 定义一个结构体变量stu1</span> <span class="token comment" spellcheck="true">/* 给结构体变量stu1的成员进行赋值 */</span> stu1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"ZhengNianJun"</span><span class="token punctuation">;</span> stu1<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">520</span><span class="token punctuation">;</span> stu1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n============================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"My name is %s\n"</span><span class="token punctuation">,</span> stu1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"My num is %d\n"</span><span class="token punctuation">,</span> stu1<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"My age is %d\n"</span><span class="token punctuation">,</span> stu1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"欢迎关注正念君编程学习笔记！\n"</span><span class="token punctuation">,</span> stu1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"============================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><p><a href="https://imgchr.com/i/VHPq3Q" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHPq3Q.md.png" alt="VHPq3Q.md.png"></a></p><p>结构体是一块很重要的内容，用得很多。关于结构体的内存对齐可查看往期笔记：<a href="https://zhengnianli.github.io/2018/10/20/c-yu-yan-bi-ji-jie-gou-ti-nei-cun-dui-qi/">【C语言笔记】C语言结构体内存对齐问题</a></p><p>以上就是关于结构体的一些笔记，如有错误欢迎指出。谢谢！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】枚举</title>
      <link href="/2019/01/15/c-yu-yan-bi-ji-mei-ju/"/>
      <url>/2019/01/15/c-yu-yan-bi-ji-mei-ju/</url>
      
        <content type="html"><![CDATA[<h3 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h3><p>首先，提一下宏定义<code>#define</code>，其一般形式为：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> 宏名 字符串</span></code></pre><p>这个知识点很重要，到处能用得到。其可以与typedef来进行类比进行理解（可查看<a href="https://zhengnianli.github.io/2018/10/11/c-yu-yan-bi-ji-define-yu-typedef-de-qu-bie/">【C语言笔记】define与typedef的区别？</a>）。除此之外，其还可以与枚举<code>enum</code>进行类比。</p><h3 id="二、什么是枚举"><a href="#二、什么是枚举" class="headerlink" title="二、什么是枚举"></a>二、什么是枚举</h3><p>从字面理解，就是一一列举的意思。很多时候，有一些数据的取值有限的，这时候可以把这些可能的结果列出来，并赋予新的名字，这样有助于提高代码的可读性。例如，一个星期有7天，一年有12个月，期末考试科目有6个科目等情况，完全可以一一列举出来。</p><p>当我们要为整数定义一些别名（例如定义为星期数）的时候，可以使用宏定义，如：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">define</span> MON  1</span><span class="token macro property">#<span class="token directive keyword">define</span> TUE  2</span><span class="token macro property">#<span class="token directive keyword">define</span> WED  3</span><span class="token macro property">#<span class="token directive keyword">define</span> THU  4</span><span class="token macro property">#<span class="token directive keyword">define</span> FRI  5</span><span class="token macro property">#<span class="token directive keyword">define</span> SAT  6</span><span class="token macro property">#<span class="token directive keyword">define</span> SUN  7</span></code></pre><p>此时，我们可以使用枚举来达到同样的效果，如：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">enum</span> DAY<span class="token punctuation">{</span>     MON<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> TUE<span class="token punctuation">,</span> WED<span class="token punctuation">,</span> THU<span class="token punctuation">,</span> FRI<span class="token punctuation">,</span> SAT<span class="token punctuation">,</span> SUN<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>其中，<code>enum</code>是关键字，是必须的。<code>DAY</code>是枚举名，可有可无，这个名字是自己定义的；<code>MON=1, TUE, WED, THU, FRI, SAT, SUN</code>是枚举成员。</p><p>枚举成员的值是根据前一个成员的值递增1，即上面枚举定义等价于：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">enum</span> DAY<span class="token punctuation">{</span>    MON<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> TUE<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> WED<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> THU<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> FRI<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> SAT<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> SUN<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>若上述定义中第一个成员<code>MON</code>不赋值的话，那么其默认为<code>0</code>。</p><p>若其他成员赋了初值，也是遵循“枚举成员的值是根据前一个成员的值递增1”这一规则，如：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">enum</span> DAY<span class="token punctuation">{</span>   A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>D<span class="token punctuation">,</span>F<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>G <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>此处</p><pre class=" language-cpp"><code class="language-cpp">A<span class="token operator">=</span><span class="token number">0</span>B<span class="token operator">=</span><span class="token number">1</span>C<span class="token operator">=</span><span class="token number">100</span>D<span class="token operator">=</span><span class="token number">101</span>F<span class="token operator">=</span><span class="token number">200</span>G<span class="token operator">=</span><span class="token number">201</span></code></pre><h3 id="三、枚举类型变量的定义方法"><a href="#三、枚举类型变量的定义方法" class="headerlink" title="三、枚举类型变量的定义方法"></a>三、枚举类型变量的定义方法</h3><h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">enum</span> DAY<span class="token punctuation">{</span>    MON<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> TUE<span class="token punctuation">,</span> WED<span class="token punctuation">,</span> THU<span class="token punctuation">,</span> FRI<span class="token punctuation">,</span> SAT<span class="token punctuation">,</span> SUN<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">enum</span> DAY good_day<span class="token punctuation">,</span> bad_day<span class="token punctuation">;</span></code></pre><p>此处，<code>DAY</code>是枚举名，相当于一个模板，可以使用这个模板去定义变量<code>good_day</code>，<code>bad_day</code>，定义的时候不要忘了<code>enum</code>。</p><h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">enum</span><span class="token punctuation">{</span>   MON<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> TUE<span class="token punctuation">,</span> WED<span class="token punctuation">,</span> THU<span class="token punctuation">,</span> FRI<span class="token punctuation">,</span> SAT<span class="token punctuation">,</span> SUN<span class="token punctuation">}</span>good_day<span class="token punctuation">,</span> bad_day<span class="token punctuation">;</span></code></pre><p>相对于方法一，此处省略了枚举名。虽然更简洁了，但是因为没有了名字，后面就不能用该枚举定义新的变量。</p><h4 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h4><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">enum</span> DAY<span class="token punctuation">{</span>   MON<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> TUE<span class="token punctuation">,</span> WED<span class="token punctuation">,</span> THU<span class="token punctuation">,</span> FRI<span class="token punctuation">,</span> SAT<span class="token punctuation">,</span> SUN<span class="token punctuation">}</span>DAY<span class="token punctuation">;</span>DAY good_day<span class="token punctuation">,</span> bad_day<span class="token punctuation">;</span></code></pre><p>此处使用<code>typedef</code>为枚举定义一个别名，这个别名为<code>DAY</code>，关于<code>typedef</code>的介绍可点击文首的链接进行查看。</p><h4 id="程序实例"><a href="#程序实例" class="headerlink" title="程序实例"></a>程序实例</h4><p>编译环境为 : <code>gcc 6.3.0</code></p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">enum</span> DAY<span class="token punctuation">{</span>  MON<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> TUE<span class="token punctuation">,</span> WED<span class="token punctuation">,</span> THU<span class="token punctuation">,</span> FRI<span class="token punctuation">,</span> SAT<span class="token punctuation">,</span> SUN<span class="token punctuation">}</span>DAY<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> DAY good_day<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"你觉得一周中哪一天最美好？\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>good_day<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"我比较喜欢"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">switch</span><span class="token punctuation">(</span>good_day<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">case</span> MON<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"星期一"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> TUE<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"星期二"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> WED<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"星期三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> THU<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"星期四"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> FRI<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"星期五"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> SAT<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"星期六"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> SUN<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"星期日"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">default</span><span class="token operator">:</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果：</p><p><a href="https://imgchr.com/i/VH8JUS" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH8JUS.md.png" alt="VH8JUS.md.png"></a></p><h3 id="四、枚举变量占用的字节数？"><a href="#四、枚举变量占用的字节数？" class="headerlink" title="四、枚举变量占用的字节数？"></a>四、枚举变量占用的字节数？</h3><p>实测程序：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">enum</span> DAY<span class="token punctuation">{</span>  MON<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> TUE<span class="token punctuation">,</span> WED<span class="token punctuation">,</span> THU<span class="token punctuation">,</span> FRI<span class="token punctuation">,</span> SAT<span class="token punctuation">,</span> SUN<span class="token punctuation">}</span>DAY<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> DAY good_day<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(DAY) = %d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>DAY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(good_day) = %d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>good_day<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(int) = %d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果：</p><p><a href="https://imgchr.com/i/VH8U3j" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH8U3j.md.png" alt="VH8U3j.md.png"></a></p><p>从该程序运行结果也可看出，枚举类型变量需要存放的是一个整数，它的长度和int的长度相同。</p><p>以上就是关于枚举类型enum的一些笔记，如有错误欢迎指出。</p><p>最后，分享两篇关于枚举的文章，都讲得很详细。</p><pre class=" language-c"><code class="language-c">https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>cnblogs<span class="token punctuation">.</span>com<span class="token operator">/</span>JCSU<span class="token operator">/</span>articles<span class="token operator">/</span><span class="token number">1299051</span><span class="token punctuation">.</span>htmlhttp<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>c<span class="token punctuation">.</span>biancheng<span class="token punctuation">.</span>net<span class="token operator">/</span>cpp<span class="token operator">/</span>html<span class="token operator">/</span><span class="token number">99</span><span class="token punctuation">.</span>html</code></pre><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】整数溢出问题</title>
      <link href="/2019/01/10/c-yu-yan-bi-ji-zheng-shu-yi-chu-wen-ti/"/>
      <url>/2019/01/10/c-yu-yan-bi-ji-zheng-shu-yi-chu-wen-ti/</url>
      
        <content type="html"><![CDATA[<h3 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h3><p>整数溢出是一种未定义的行为，当产生溢出行为时，系统并不会通知用户，所以应当多加小心。如下是整数溢出的一个案例：</p><p><a href="https://imgchr.com/i/VHnOiR" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHnOiR.md.png" alt="VHnOiR.md.png"></a></p><p>SMT爆出的美图BEC代币出现的安全漏洞—整数溢出，该漏洞代理的直接经济损失高达上亿元人民币，间接产生的负面影响目前无法估量。</p><h3 id="二、什么是整数溢出？"><a href="#二、什么是整数溢出？" class="headerlink" title="二、什么是整数溢出？"></a>二、什么是整数溢出？</h3><p>计算机语言中整数类型都有一个取值范围，两个整数进行运算时，若其结果大于最大值（<code>上溢</code>）或者小于最小值（<code>下溢</code>）就是溢出。</p><p>假如最大值为 <code>a</code> ，在最大值和最小值之间如果发生以下计算：</p><blockquote><p>a+1=0或0-1=a</p></blockquote><p>此时就会发生溢出，其中<code>a+1=0</code>会发生上溢，<code>0-1=a</code>会发生下溢。</p><h3 id="三、程序实例"><a href="#三、程序实例" class="headerlink" title="三、程序实例"></a>三、程序实例</h3><p>示例（在32bit环境中编译）</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// 整数溢出例子</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">short</span> i <span class="token operator">=</span> <span class="token number">32767</span><span class="token punctuation">;</span> <span class="token keyword">unsigned</span> <span class="token keyword">short</span> j <span class="token operator">=</span> <span class="token number">65535</span><span class="token punctuation">;</span> <span class="token keyword">unsigned</span> <span class="token keyword">short</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 上溢例子</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%hd %hd %hd\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// 上溢例子</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%hu %hu %hu\n"</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 下溢例子</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%hu %hu %hu\n"</span><span class="token punctuation">,</span> k<span class="token punctuation">,</span> k<span class="token number">-1</span><span class="token punctuation">,</span> k<span class="token number">-2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><p><a href="https://imgchr.com/i/VHnzQK" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHnzQK.md.png" alt="VHnzQK.md.png"></a></p><p>在32bit环境中，short（占两个字节）的范围为：</p><pre class=" language-c"><code class="language-c"><span class="token operator">-</span><span class="token number">32768</span><span class="token operator">~</span><span class="token number">32767</span></code></pre><p>unsigned short的范围为：</p><pre><code>0~65535</code></pre><p>所以<code>short</code>类型的<code>i=32767</code>加1、加2时会产生上溢。<code>unsigned short</code>类型的<code>j=65535</code>加1、加2时会产生上溢。<code>unsigned short</code>类型的k=0减1、减2时会产生下溢。</p><p>（ps：可以使用程序来查看整数数据类型的范围，具体可移步至<a href="https://zhengnianli.github.io/2018/12/06/c-yu-yan-bi-ji-shi-me-shi-ansi-c-biao-zhun/">【C语言笔记】如何查看数据类型范围？</a>进行查看）</p><p>以上就是关于整数溢出的笔记分享，如有错误欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】函数指针作为函数的参数</title>
      <link href="/2019/01/04/c-yu-yan-bi-ji-han-shu-zhi-zhen-zuo-wei-han-shu-de-can-shu/"/>
      <url>/2019/01/04/c-yu-yan-bi-ji-han-shu-zhi-zhen-zuo-wei-han-shu-de-can-shu/</url>
      
        <content type="html"><![CDATA[<p>函数指针有两种常用的用法，一种是作为结构体成员，关于函数指针作为结构体成员的用法可移步至上一篇<a href="https://zhengnianli.github.io/2019/01/03/c-yu-yan-bi-ji-han-shu-zhi-zhen-zuo-wei-jie-gou-ti-cheng-yuan/">【C语言笔记】函数指针作为结构体成员</a>进行查看。另一种是函数指针作为函数的参数。这一篇分享的是函数指针作为函数的参数。</p><h3 id="一、函数指针作为函数的参数"><a href="#一、函数指针作为函数的参数" class="headerlink" title="一、函数指针作为函数的参数"></a>一、函数指针作为函数的参数</h3><p>函数指针可以作为一个参数传递给另一个函数。这时函数指针的使用就像普通的常量和变量一样。当函数指针作为参数传递的时候，这时接收参数传递的函数通常需要根据这个指针调用这个函数。作为参数传递的函数指针通常表示<code>回调函数（Callback Functions）</code>。</p><h4 id="1、什么是回调函数？"><a href="#1、什么是回调函数？" class="headerlink" title="1、什么是回调函数？"></a>1、什么是回调函数？</h4><p>回调函数就是一个通过函数指针调用的函数。如果你把函数的指针（地址）作为参数传递给另一个函数，当这个指针被用来调用其所指向的函数时，我们就说这是回调函数。</p><h4 id="2、回调函数在实际中有什么作用？"><a href="#2、回调函数在实际中有什么作用？" class="headerlink" title="2、回调函数在实际中有什么作用？"></a>2、回调函数在实际中有什么作用？</h4><p>先假设有这样一种情况：我们要编写一个库，它提供了某些排序算法的实现（如冒泡排序、快速排序等等），为了能让库更加通用，不想在函数中嵌入排序逻辑，而让使用者来实现相应的逻辑；或者，能让库可用于多种数据类型（int、float、string），此时，该怎么办呢？可以使用函数指针，并进行回调。</p><p>例如，在C语言的通用工具库stdlib.h中，有如下一个函数原型：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">qsort</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">,</span> size_t<span class="token punctuation">,</span> size_t<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token punctuation">(</span>comp<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>这是在C通用工具库中声明的一个快速排序算法函数，其可以用来排序int类型、float类型以及字符串数据，可以按从小到大的顺序也可以按从大到小的顺序排序。其关键在于函数指针comp指向的函数的具体实现。</p><h3 id="二、举例说明"><a href="#二、举例说明" class="headerlink" title="二、举例说明"></a>二、举例说明</h3><p>上一节我们使用函数指针作为结构体成员来实现四则运算，这里一节我们稍微修改一下代码，使用函数指针作为函数参数来实现四则运算。</p><p>设计如下函数：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> fun_t operation<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> result<span class="token punctuation">;</span> result <span class="token operator">=</span> <span class="token function">operation</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 运算</span> <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>其中，fun_t是一个函数指针，其定义为：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>fun_t<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>该函数指针<code>fun_t</code>指向一个带两个<code>int</code>类型的形参、<code>int</code>类型的返回值的函数。使用关键字<code>typedef</code>对<code>int (*)(int, int)</code>进行重命名（封装）为<code>fun_t</code>。关于typedef与define的区别可查看往期笔记：<a href="https://zhengnianli.github.io/2018/10/11/c-yu-yan-bi-ji-define-yu-typedef-de-qu-bie/">【C语言笔记】#define与typedef的区别？</a></p><p>根据函数指针变量<code>operation</code>指向不同的运算函数可实现加法运算、减法运算、乘法运算、除法运算。</p><p>主函数代码如下：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">192</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 两个数相加的操作 */</span> result <span class="token operator">=</span> <span class="token function">calculate</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> add2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"加法运算: %d+%d = %d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 两个数相减的操作 */</span> result <span class="token operator">=</span> <span class="token function">calculate</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> sub2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"减法运算: %d-%d = %d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 两个数相乘的操作 */</span> result <span class="token operator">=</span> <span class="token function">calculate</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mul2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"乘法运算: %d*%d = %d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 两个数相除的操作 */</span> result <span class="token operator">=</span> <span class="token function">calculate</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> div2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"除法运算: %d/%d = %d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>实现运算的4个函数很简单，如下：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">add2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">sub2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token operator">-</span>b<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">mul2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token operator">*</span>b<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">div2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token operator">/</span>b<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><p><a href="https://imgchr.com/i/VHQH6x" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHQH6x.md.png" alt="VHQH6x.md.png"></a></p><p>以上就是关于函数指针作为函数参数的笔记，如有错误欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】函数指针作为结构体成员</title>
      <link href="/2019/01/03/c-yu-yan-bi-ji-han-shu-zhi-zhen-zuo-wei-jie-gou-ti-cheng-yuan/"/>
      <url>/2019/01/03/c-yu-yan-bi-ji-han-shu-zhi-zhen-zuo-wei-jie-gou-ti-cheng-yuan/</url>
      
        <content type="html"><![CDATA[<h3 id="函数指针在C语言中的意义"><a href="#函数指针在C语言中的意义" class="headerlink" title="函数指针在C语言中的意义"></a>函数指针在C语言中的意义</h3><p>在C语言程序中，数据结构和算法是两个基本的元素。C语言的基本数据类型、结构体、数组和联合体是数据结构的代表；C语言中的函数则是算法的代表。只有将数据结构和算法有机结合才能构成具有一定功能的程序。</p><h3 id="函数指针的应用"><a href="#函数指针的应用" class="headerlink" title="函数指针的应用"></a>函数指针的应用</h3><p>函数指针在嵌入式中的应用非常广泛，常常把函数指针作为结构体的成员、作为函数的参数等。如在物联网操作系统RT-Thread内核源码中，有如下代码：</p><h4 id="1、函数指针作为结构体成员"><a href="#1、函数指针作为结构体成员" class="headerlink" title="1、函数指针作为结构体成员"></a>1、函数指针作为结构体成员</h4><p><a href="https://imgchr.com/i/VHlag1" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHlag1.md.png" alt="VHlag1.md.png"></a></p><h4 id="2、函数指针作为函数的参数"><a href="#2、函数指针作为函数的参数" class="headerlink" title="2、函数指针作为函数的参数"></a>2、函数指针作为函数的参数</h4><h3 id="举例说明"><a href="#举例说明" class="headerlink" title="举例说明"></a>举例说明</h3><p>建立一个结构体，用于四则运算（根据函数指针的指向可以选择加法运算、减法运算、乘法运算、除法运算），如</p><pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>fun_t<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 包含了数据和算法的结构体</span><span class="token keyword">struct</span> Source<span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 数据a</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 数据b</span> fun_t operation<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 算法operation</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>主函数内可以进行如下操作：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> Source data<span class="token punctuation">;</span><span class="token keyword">int</span> result<span class="token punctuation">;</span>data<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>data<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/* 两个数相加的操作 */</span>data<span class="token punctuation">.</span>operation <span class="token operator">=</span> add2<span class="token punctuation">;</span>  result <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>a<span class="token punctuation">,</span> data<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"加法运算: %d+%d = %d\n"</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>a<span class="token punctuation">,</span> data<span class="token punctuation">.</span>b<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>函数指针<code>data.operation</code>指向加法函数<code>add2</code>，则调用<code>data.operation</code>就可以进行加法运算。同理，有：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* 两个数相减的操作 */</span>data<span class="token punctuation">.</span>operation <span class="token operator">=</span> sub2<span class="token punctuation">;</span>result <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>a<span class="token punctuation">,</span> data<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"减法运算: %d-%d = %d\n"</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>a<span class="token punctuation">,</span> data<span class="token punctuation">.</span>b<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/* 两个数相乘的操作 */</span>data<span class="token punctuation">.</span>operation <span class="token operator">=</span> mul2<span class="token punctuation">;</span>result <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>a<span class="token punctuation">,</span> data<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"乘法运算: %d*%d = %d\n"</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>a<span class="token punctuation">,</span> data<span class="token punctuation">.</span>b<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/* 两个数相除的操作 */</span>data<span class="token punctuation">.</span>operation <span class="token operator">=</span> div2<span class="token punctuation">;</span>result <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>a<span class="token punctuation">,</span> data<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"除法运算: %d/%d = %d\n"</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>a<span class="token punctuation">,</span> data<span class="token punctuation">.</span>b<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>运行结果：</p><p><a href="https://imgchr.com/i/VHl4Df" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHl4Df.md.png" alt="VHl4Df.md.png"></a></p><p>以上就是函数指针作为结构体成员的笔记，如有错误欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】你的黑窗口闪退？</title>
      <link href="/2018/12/24/c-yu-yan-bi-ji-ni-de-hei-chuang-kou-shan-tui/"/>
      <url>/2018/12/24/c-yu-yan-bi-ji-ni-de-hei-chuang-kou-shan-tui/</url>
      
        <content type="html"><![CDATA[<p>上一篇中写到了Windows下体验Linux环境，其中的测试代码简单的打印一句话，如：</p><p><a href="https://imgchr.com/i/V73PHO" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V73PHO.md.png" alt="V73PHO.md.png"></a></p><p>编译后得到<code>test.exe</code>，运行得到如下结果：</p><p><a href="https://imgchr.com/i/V73uKP" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V73uKP.md.png" alt="V73uKP.md.png"></a></p><p>在命令行下运行可以输出结果，但是在文件夹下，双击运行test1.exe却发现黑窗口一闪而过：</p><p><a href="https://imgchr.com/i/V73GCj" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V73GCj.md.png" alt="V73GCj.md.png"></a></p><p>怎么让黑窗口暂停呢？这里有两种方法：</p><p>【方法一】在程序的最后添加一行代码：</p><pre class=" language-c"><code class="language-c"><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>同时，添加头文件<code>stdlib.h</code>，即</p><p><a href="https://imgchr.com/i/V73arV" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V73arV.md.png" alt="V73arV.md.png"></a></p><p><code>system</code>是C函数库<code>stdlib.h</code>中的一个函数，函数原型为：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">system</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> command<span class="token punctuation">)</span>；</code></pre><p>将命令<code>command</code>传给系统，其中<code>pause</code>命令的意思是让程序暂停一下，显示一个中文信息：<code>请按任意键继续. . .</code>，或者英文信息：<code>Press any key to continue . . .</code>。</p><p>编译，运行结果为：</p><p><a href="https://imgchr.com/i/V73sPJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V73sPJ.md.png" alt="V73sPJ.md.png"></a></p><p>有些<code>IDE（集成开发环境）</code>会自动输出<code>请按任意键继续. . .</code>这一句，有些没有，想让程序暂停一下就得手动添加<code>system(&quot;pause&quot;);</code>这一句代码。</p><p>【方法二】在程序的最后添加一行代码：</p><pre class=" language-c"><code class="language-c"><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>即：</p><p><a href="https://imgchr.com/i/V78SiQ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V78SiQ.md.png" alt="V78SiQ.md.png"></a></p><p><code>getchar()</code>用于读取一次按键按下（读取字符）。当程序调用<code>getchar()</code>时，程序就等着用户按键。用户输入的字符被存放在键盘缓冲区中，直到用户按回车为止（回车字符也放在缓冲区中）。关于getchar()，可以查看往期笔记getchar()、getche()、getch()的区别？</p><p>编译，运行结果：</p><p><a href="https://imgchr.com/i/V78EZT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V78EZT.md.png" alt="V78EZT.md.png"></a></p><p>以上就是解决黑窗口闪退的两种方法，如有错误，欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】windows命令行下编译C程序</title>
      <link href="/2018/12/23/c-yu-yan-bi-ji-windows-ming-ling-xing-xia-bian-yi-c-cheng-xu/"/>
      <url>/2018/12/23/c-yu-yan-bi-ji-windows-ming-ling-xing-xia-bian-yi-c-cheng-xu/</url>
      
        <content type="html"><![CDATA[<p>有关注我的朋友可能会知道我的C开发环境是：<code>Notepad++</code>与<code>MinGW</code>相结合，即用<code>Notepad++</code>写代码，用<code>MinGW</code>这个工具包中的<code>gcc编译器</code>进行编译。如：</p><p>在Notepad++里写代码：</p><p><a href="https://imgchr.com/i/VH1SVU" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH1SVU.md.png" alt="VH1SVU.md.png"></a></p><p>在黑窗口下编译及运行代码：</p><p><a href="https://imgchr.com/i/VH1954" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH1954.md.png" alt="VH1954.md.png"></a></p><p>此处，编译命令为:</p><pre class=" language-c"><code class="language-c">gcc hello<span class="token punctuation">.</span>c</code></pre><p>生成的可执行文件默认为<code>a.exe</code>，输入<code>a.exe</code>即可运行该可执行程序。同样，也可添加<code>-o</code>参数给<code>a.exe</code>进行重命名，如把<code>hello.c</code>编译生成的可执行文件命名为<code>hello.exe</code>的编译命令为:</p><pre class=" language-c"><code class="language-c">gcc hello<span class="token punctuation">.</span>c <span class="token operator">-</span>o hello<span class="token punctuation">.</span>exe</code></pre><p>此时就可以输出<code>hello.exe</code>运行该程序，如：</p><p><a href="https://imgchr.com/i/VH1iG9" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH1iG9.md.png" alt="VH1iG9.md.png"></a></p><p>学会这种编译方式后，之后转到Linux环境下进行编译也是类似的，编译的命令是一样的。之前已经分享过了这个环境的安装配置方法，可能有些朋友还不是很清楚怎么配置（配置方法请查看使用<a href="https://zhengnianli.github.io/2018/10/05/c-yu-yan-bi-ji-shi-yong-notepad-mingw-lai-kai-fa-c-cheng-xu/">【C语言笔记】使用Notepad++来开发C程序</a>）。</p><p>这不，昨天有位朋友问我怎么在黑窗口下切换路径的问题，因为不会切换路径所以无法找到代码文件的位置。现教大家怎么切换路径：</p><p>（1）首先要知道怎么切换盘符，切换盘符示例：</p><p><a href="https://imgchr.com/i/VH1GsP" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH1GsP.md.png" alt="VH1GsP.md.png"></a></p><p>（2）其次，就可以找到该盘符下你的代码的位置，比如我的代码在<code>D:\c_test</code>路径下，那么我就可以如下操作切换到<code>D:\c_test</code>路径：</p><p><a href="https://imgchr.com/i/VH10Rs" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH10Rs.md.png" alt="VH10Rs.md.png"></a></p><p>还有方法是，你可以直接<code>cd</code>至你源代码所在目录的绝对路径，如：</p><p><a href="https://imgchr.com/i/VH1Wi4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH1Wi4.md.png" alt="VH1Wi4.md.png"></a></p><p><a href="https://imgchr.com/i/VH1zQI" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH1zQI.md.png" alt="VH1zQI.md.png"></a></p><p>此外，有两个小技巧要告诉大家：</p><p>（1）<code>【Tab】键</code>具有补齐功能，比如你输出<code>cd c_</code>,然后按下<code>【Tab】键</code>就可以自动补齐为：<code>cd c_test</code>。</p><p>（2）你不记得文件夹的名字时可以输入<code>dir命令</code>（类似于linux系统中的ls命令）查看当前文件夹下的所有文件及文件夹，如：</p><p><a href="https://imgchr.com/i/VH3Cef" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH3Cef.md.png" alt="VH3Cef.md.png"></a></p><p>以上就是在黑窗口下切换至源码路径的一种方法，如果你不会的话，还有另一种更为简单的方法：</p><p>在记事本中就可以很方便的在黑窗口中打开你的源码所在的路径：</p><p><a href="https://imgchr.com/i/VH3MwT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH3MwT.md.png" alt="VH3MwT.md.png"></a></p><p>既然已经讲了那么多了，就顺便讲一下多个文件该怎么编译。其实和编译一个文件也差不多，编译多个文件就把要编译的文件都加到编译命令中就可以了，如：</p><pre class=" language-c"><code class="language-c">gcc cJSON<span class="token punctuation">.</span>c json_parse_now<span class="token punctuation">.</span>c <span class="token operator">-</span>o test<span class="token punctuation">.</span>exe</code></pre><p>该命令同时编译链接<code>JSON.c</code>和<code>json_parse_now.c</code>文件。</p><p>以上就是关于如何在window命令行下编译C程序的一点补充的笔记，掌握这一点就可以无缝切换到Linux下进行编译C程序了（相关笔记：<a href="https://zhengnianli.github.io/2018/12/23/c-yu-yan-bi-ji-windows-xia-ti-yan-linux-huan-jing/">【C语言笔记】windows下体验Linux环境</a>）。关于C程序的编译过程可查看往期笔记：<a href="https://zhengnianli.github.io/2018/10/14/c-yu-yan-bi-ji-c-yu-yan-bian-yi-de-guo-cheng/">【C语言笔记】C语言编译的过程</a></p><p>以上就是关于在windows命令行编译C程序的方法，如有错误，欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】Windows下体验Linux环境</title>
      <link href="/2018/12/23/c-yu-yan-bi-ji-windows-xia-ti-yan-linux-huan-jing/"/>
      <url>/2018/12/23/c-yu-yan-bi-ji-windows-xia-ti-yan-linux-huan-jing/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>若要使用Linux环境，可以把Linux操作系统装在真机上，也可以把Linux操作系统安装在虚拟机上（如VMware）。本文介绍除了这两种方法之外的第三种可以使用Linux环境的方法，请往下看。</p><p>在Windows系统下可以使用集成开发环境（如Visual Studio、VC++、C-free等）编译C语言源代码文件，也可以使用命令行编译。</p><p>若要使用命令行编译C文件，就必须得安装C编译器，因为C编译器不是标准Windows软件包的一部分，因此需要从别处获取并安装。常用的有两种：一种是<code>MinGW</code>（之前已经分享过，可移步至MinGW进行查看）；另一种是<code>Cygwin</code>，本文着重介绍Cygwin。</p><h3 id="Cygwin简介"><a href="#Cygwin简介" class="headerlink" title="Cygwin简介"></a>Cygwin简介</h3><p><code>Cygwin</code>是一个在windows平台上运行的<code>类UNIX</code>模拟环境，是<code>cygnus solutions</code>公司开发的自由软件（该公司开发的著名工具还有<code>eCos</code>，不过现已被<code>Redhat</code>收购）。</p><p>它对于学习<code>UNIX/Linux</code>操作环境，或者从<code>UNIX</code>到<code>Windows</code>的应用程序移植，或者进行某些特殊的开发工作，尤其是使用<code>GNU</code>工具集在<code>Windows</code>上进行嵌入式系统开发，非常有用。随着嵌入式系统开发在国内日渐流行，越来越多的开发者对<code>Cygwin</code>产生了兴趣。</p><h3 id="Cygwin下载、安装"><a href="#Cygwin下载、安装" class="headerlink" title="Cygwin下载、安装"></a>Cygwin下载、安装</h3><p>1、下载链接</p><blockquote><p><a href="https://cygwin.com/install.html" target="_blank" rel="noopener">https://cygwin.com/install.html</a></p></blockquote><p>打开该网址，可以看到如下页面：</p><p><a href="https://imgchr.com/i/V7hayn" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7hayn.md.png" alt="V7hayn.md.png"></a></p><p>根据自己的需求选择下载32bit或者64bit的Cygwin包。</p><p>2、安装</p><p>由上一步下载得到.exe结尾的软件，双击进行安装，一直点击下一步直至安装完成。安装的路径根据自己的需要进行选择。</p><h3 id="Cygwin的使用"><a href="#Cygwin的使用" class="headerlink" title="Cygwin的使用"></a>Cygwin的使用</h3><p>打开上一步安装的路径，如：</p><p><a href="https://imgchr.com/i/V7hBwV" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7hBwV.md.png" alt="V7hBwV.md.png"></a></p><p>双击<code>Cygwin.bat</code>文件即可打开Linux命令行。双击后得到如下界面：</p><p><a href="https://imgchr.com/i/V7hDoT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7hDoT.md.png" alt="V7hDoT.md.png"></a></p><p>这就是Linux命令行，然后就可以进行一些Linux练习啦。如：</p><p><a href="https://imgchr.com/i/V7h6W4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7h6W4.md.png" alt="V7h6W4.md.png"></a></p><p>进行如上操作后，就可以在<code>/c_test/test1/</code>路径下看到<code>test.c</code>文件啦（以上创建文件及文件夹的操作也可以直接在Windows下完成）。如：</p><p><a href="https://imgchr.com/i/V7vLeU" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7vLeU.md.png" alt="V7vLeU.md.png"></a></p><p>使用<code>notepad++</code>打开该<code>test1.c</code>输入如下代码并保存：</p><p><a href="https://imgchr.com/i/V7x3Tg" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7x3Tg.md.png" alt="V7x3Tg.md.png"></a></p><p>然后在我们的Linux终端中进行编译：</p><p><a href="https://imgchr.com/i/V7xTtH" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7xTtH.md.png" alt="V7xTtH.md.png"></a></p><p>以上就是关于在windows下体验Linux的方法。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】分享一个C语言测试程序模板</title>
      <link href="/2018/12/14/c-yu-yan-bi-ji-fen-xiang-yi-ge-c-yu-yan-ce-shi-cheng-xu-mo-ban/"/>
      <url>/2018/12/14/c-yu-yan-bi-ji-fen-xiang-yi-ge-c-yu-yan-ce-shi-cheng-xu-mo-ban/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>平时需要测试一些比较模糊的知识点，或则想要验证一些函数时，我们常常会建一个<code>test.c</code>文件，然后在这个文件里写我们的测试代码，测试完毕后常常会删掉该文件。下次再遇到同样的问题的时候，可能又是记不清楚了，常常又需要测试一遍，这是件很浪费时间的事情。</p><p>所以，我们可以编写一个专门用于测试的程序：（1）有菜单，可以通过菜单选择想要测试的函数；（2）有功能函数，把一些需要测试的功能封装成一个函数；（3）有测试函数，用于测试功能函数及一些知识点。</p><p>该测试程序大致如下：</p><p><a href="https://imgchr.com/i/V7zbaF" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7zbaF.md.png" alt="V7zbaF.md.png"></a></p><p>我们只要输入菜单前面的数字就可以进行对应的测试啦。挺方便的，日积月累，渐渐的，就可以积累很多知识点。如：</p><p><a href="https://imgchr.com/i/V7zXG9" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7zXG9.md.png" alt="V7zXG9.md.png"></a></p><h3 id="该测试程序代码模板"><a href="#该测试程序代码模板" class="headerlink" title="该测试程序代码模板"></a>该测试程序代码模板</h3><h3 id="1、菜单函数如下："><a href="#1、菜单函数如下：" class="headerlink" title="1、菜单函数如下："></a>1、菜单函数如下：</h3><p><a href="https://imgchr.com/i/V7zvx1" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/V7zvx1.md.png" alt="V7zvx1.md.png"></a></p><h3 id="2、主函数如下："><a href="#2、主函数如下：" class="headerlink" title="2、主函数如下："></a>2、主函数如下：</h3><p><a href="https://imgchr.com/i/VHSiIe" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHSiIe.md.png" alt="VHSiIe.md.png"></a></p><h3 id="3、该测试程序函数声明部分如下"><a href="#3、该测试程序函数声明部分如下" class="headerlink" title="3、该测试程序函数声明部分如下"></a>3、该测试程序函数声明部分如下</h3><p><a href="https://imgchr.com/i/VHSeMt" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHSeMt.md.png" alt="VHSeMt.md.png"></a></p><p>完整程序</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/*---------------------------------------------------------------------------------------- 程序说明：这是一个测试程序 创建日期：2018.12.14 by LiZhengNian----------------------------------------------------------------------------------------*/</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;limits.h></span></span><span class="token comment" spellcheck="true">// 功能函数声明</span><span class="token keyword">void</span> <span class="token function">exchange</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 交换a，b的值最好的方法</span><span class="token comment" spellcheck="true">// 测试函数声明</span><span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 测试函数1：交换a，b的值</span><span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 测试函数2：C语言预定义宏</span><span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 测试函数3：C89与C99标准的区别</span><span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 测试函数4：输出当前编译器数据类型范围</span><span class="token comment" spellcheck="true">// 菜单</span><span class="token keyword">int</span> <span class="token function">menu</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/*=============================================================================               主函数==============================================================================*/</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> cmd <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span>      <span class="token comment" spellcheck="true">// 死循环，等价于while(1)</span> <span class="token punctuation">{</span>   cmd <span class="token operator">=</span> <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 读取用户输入的指令</span>   <span class="token keyword">switch</span> <span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>   <span class="token punctuation">{</span>     <span class="token keyword">case</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 测试函数1：交换a，b的值</span>     <span class="token keyword">case</span> <span class="token number">2</span> <span class="token punctuation">:</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 测试函数2：C语言预定义宏</span>     <span class="token keyword">case</span> <span class="token number">3</span> <span class="token punctuation">:</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 测试函数3：C89与C99标准的区别</span>     <span class="token keyword">case</span> <span class="token number">4</span> <span class="token punctuation">:</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 测试函数4：输出当前编译器数据类型范围</span>     <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 退出程序</span>     <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 清空屏幕</span>     <span class="token keyword">default</span><span class="token punctuation">:</span><span class="token keyword">break</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*=============================================================================               以下是功能函数实体==============================================================================*/</span><span class="token comment" spellcheck="true">/* 交换a，b的值 */</span><span class="token keyword">void</span> <span class="token function">exchange</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token operator">*</span>a<span class="token operator">^</span><span class="token operator">*</span>b<span class="token punctuation">;</span> <span class="token operator">*</span>b <span class="token operator">=</span> <span class="token operator">*</span>a<span class="token operator">^</span><span class="token operator">*</span>b<span class="token punctuation">;</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token operator">*</span>a<span class="token operator">^</span><span class="token operator">*</span>b<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*=============================================================================               以下是测试函数实体==============================================================================*/</span><span class="token comment" spellcheck="true">/* 交换a，b的值 */</span><span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"交换之前a = %d, b = %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">exchange</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"交换之后a = %d, b = %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/* C语言预定义宏 */</span><span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前代码行号：%d\n"</span><span class="token punctuation">,</span> <span class="token constant">__LINE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前编译日期：%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__DATE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前编译时间：%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__TIME__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前文件名称：%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前函数名称：%s\n"</span><span class="token punctuation">,</span> __FUNCTION__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/* C89与C99标准的区别 */</span><span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// C99允许在for循环内定义循环变量，而C89不允许</span> <span class="token comment" spellcheck="true">// gcc -std=c99 test.c -o test.exe</span> <span class="token comment" spellcheck="true">// for (int i = 0; i &lt; 5; i++)  </span> <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"hello world!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/* 输出当前编译器数据类型范围 */</span><span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"char的范围为: %d —— %d\n"</span><span class="token punctuation">,</span> CHAR_MIN<span class="token punctuation">,</span> CHAR_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned char的范围为: %u —— %u\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UCHAR_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"short的范围为: %hd —— %hd\n"</span><span class="token punctuation">,</span> SHRT_MIN<span class="token punctuation">,</span> SHRT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned short的范围为: %hu —— %hu\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> USHRT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"int的范围为: %d —— %d\n"</span><span class="token punctuation">,</span> INT_MIN<span class="token punctuation">,</span> INT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned int的范围为: %u —— %u\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UINT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"long的范围为: %ld —— %ld\n"</span><span class="token punctuation">,</span> LONG_MIN<span class="token punctuation">,</span> LONG_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned long的范围为: %lu —— %lu\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ULONG_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"long long的范围为: %lld —— %lld\n"</span><span class="token punctuation">,</span> LLONG_MIN<span class="token punctuation">,</span> LLONG_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned long long的范围为: %llu —— %llu\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ULLONG_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*=============================================================================               以下是菜单函数==============================================================================*/</span><span class="token keyword">int</span> <span class="token function">menu</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> cmd <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 菜单信息输出</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"=============================菜单==============================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[01]测试：交换a，b的值\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[02]测试：C语言预定义宏\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[03]测试：C89与C99标准的区别\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[04]测试：输出当前编译器数据类型范围\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[-1]退出\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[-2]清屏\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"===============================================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span><span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入您的选择："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">gets</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>   cmd <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cmd <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> cmd <span class="token operator">></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> cmd<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>每当需要测试一些知识点时，就可以按照这样子的格式在后边添加，可以很好地进行积累。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】如何查看数据类型范围？</title>
      <link href="/2018/12/07/c-yu-yan-bi-ji-ru-he-cha-kan-shu-ju-lei-xing-fan-wei/"/>
      <url>/2018/12/07/c-yu-yan-bi-ji-ru-he-cha-kan-shu-ju-lei-xing-fan-wei/</url>
      
        <content type="html"><![CDATA[<h3 id="1-知识点一：查看整数范围"><a href="#1-知识点一：查看整数范围" class="headerlink" title="1. 知识点一：查看整数范围"></a>1. 知识点一：查看整数范围</h3><p>当前的编译环境下，你可能不知道int的数据范围是多少，或者记不清无符号短整型的范围是<code>0~65535</code>还是<code>0~65536</code>?这时候就可以按照如下程序进行输出查看：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;limits.h></span></span><span class="token comment" spellcheck="true">/* 输出当前编译器数据类型范围 */</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nchar的范围为: %d —— %d\n"</span><span class="token punctuation">,</span> CHAR_MIN<span class="token punctuation">,</span> CHAR_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned char的范围为: %u —— %u\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UCHAR_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"short的范围为: %hd —— %hd\n"</span><span class="token punctuation">,</span> SHRT_MIN<span class="token punctuation">,</span> SHRT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned short的范围为: %hu —— %hu\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> USHRT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"int的范围为: %d —— %d\n"</span><span class="token punctuation">,</span> INT_MIN<span class="token punctuation">,</span> INT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned int的范围为: %u —— %u\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UINT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"long的范围为: %ld —— %ld\n"</span><span class="token punctuation">,</span> LONG_MIN<span class="token punctuation">,</span> LONG_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned long的范围为: %lu —— %lu\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ULONG_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"long long的范围为: %lld —— %lld\n"</span><span class="token punctuation">,</span> LLONG_MIN<span class="token punctuation">,</span> LLONG_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unsigned long long的范围为: %llu —— %llu\n\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ULLONG_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序输出结果为：</p><p><a href="https://imgchr.com/i/VH925D" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH925D.md.png" alt="VH925D.md.png"></a></p><p>其中，<code>CHAR_MIN</code>、<code>CHAR_MAX</code>等符号常量是从哪来的呢？其实这些符号常量是头文件<code>limits.h</code>里的宏定义，<code>limits.h</code>内容部分截图如下：</p><p><a href="https://imgchr.com/i/VH9h2d" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH9h2d.md.png" alt="VH9h2d.md.png"></a></p><p>以上输出的范围中，<code>long long</code>与<code>unsigned long long</code>是<code>C99标准</code>引进的新的数据类型，关于C语言的几个标准可以查看小编的上一篇笔记：<a href="https://zhengnianli.github.io/2018/12/06/c-yu-yan-bi-ji-shi-me-shi-ansi-c-biao-zhun/">【C语言笔记】什么是ANSI C标准？</a></p><h3 id="2-知识点二：C语言的预定义宏"><a href="#2-知识点二：C语言的预定义宏" class="headerlink" title="2. 知识点二：C语言的预定义宏"></a>2. 知识点二：C语言的预定义宏</h3><p>标准C语言预处理要求定义某些对象宏，每个预定义宏的名称由两个下划线开头和两个下划线结尾，这些预定义宏不能被取消定义<code>（#undef）</code>。</p><p>常用的几个预处理宏有：</p><pre class=" language-c"><code class="language-c"><span class="token constant">__LINE__</span>：表示当前源代码的行号；<span class="token constant">__FILE__</span>：表示当前源文件的名称；<span class="token constant">__DATE__</span>：表示当前的编译日期；<span class="token constant">__TIME__</span>：表示当前的编译时间；__FUNCTION__：表示当前函数；</code></pre><p>代码演示：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前代码行号：%d\n"</span><span class="token punctuation">,</span> <span class="token constant">__LINE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前编译日期：%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__DATE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前编译时间：%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__TIME__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前文件名称：%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前函数名称：%s\n"</span><span class="token punctuation">,</span> __FUNCTION__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序输出结果为：</p><p><a href="https://imgchr.com/i/VH9XGQ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VH9XGQ.md.png" alt="VH9XGQ.md.png"></a></p><p>预定义宏常用于程序运行异常的跟踪，<code>__FILE__</code>，<code>__LINE__</code>，<code>__FUNCTION__</code>这是最常用的组合，表示文件名、行数和函数名。除了以上提到的这五个预定义宏之外，还有<code>C99标准</code>提出的预定义宏如：<code>__STDC_HOSTED__</code>等，有兴趣的可以查一下。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】什么是ANSI C标准？</title>
      <link href="/2018/12/06/c-yu-yan-bi-ji-shi-me-shi-ansi-c-biao-zhun/"/>
      <url>/2018/12/06/c-yu-yan-bi-ji-shi-me-shi-ansi-c-biao-zhun/</url>
      
        <content type="html"><![CDATA[<p>我们在很多地方都有看到过<code>K&amp;R C、ANSI C、ISO C、C89、C99、C11</code>等标准，具体有什么不同呢？（文末有个很好的实例）</p><h3 id="什么是K-amp-R-C？"><a href="#什么是K-amp-R-C？" class="headerlink" title="什么是K&amp;R C？"></a>什么是K&amp;R C？</h3><p><code>1978</code>年，<code>丹尼斯•里奇（Dennis Ritchie）</code>和<code>布莱恩•柯林汉（Brian Kernighan）</code>合作出版了<code>《C程序设计语言》</code>的第一版。书中介绍的C语言标准也被称作<code>K&amp;R C</code>。</p><h3 id="什么是ANSI-C、ISO-C、C89、C90标准？"><a href="#什么是ANSI-C、ISO-C、C89、C90标准？" class="headerlink" title="什么是ANSI C、ISO C、C89、C90标准？"></a>什么是ANSI C、ISO C、C89、C90标准？</h3><p>随着C语言使用得越来越广泛，出现了许多新问题，人们日益强烈地要求对C语言进行标准化。<code>1983</code>年，<code>美国国家标准协会（ANSI）</code>组成了一个委员会，<code>X3J11</code>，为了创立 C 的一套标准。经过漫长而艰苦的过程，该标准于<code>1989</code>年完成，这个版本的语言经常被称作<code>ANSI C</code>，或有时称为<code>C89</code>（为了区别<code>C99</code>）。在<code>1990</code>年，<code>ANSI C</code>标准（带有一些小改动）被美国国家标准协会（ANSI）采纳为<code>ISO/IEC 9899:1990</code>。这个版本有时候称为<code>C90</code>或者<code>ISO C</code>。综上，<code>ANSI C、ISO C、C89、C90其实是同一种标准</code>。</p><h3 id="什么是C99标准？"><a href="#什么是C99标准？" class="headerlink" title="什么是C99标准？"></a>什么是C99标准？</h3><p><code>2000</code>年3月，<code>ANSI</code>采纳<code>了 ISO/IEC 9899:1999 标准</code>。这个标准通常指<code>C99</code>。 <code>C99</code>新增了一些特性，如：支持不定长的数组，即数组长度可以在运行时决定。变量声明不必放在语句块的开头，for语句提倡写成<code>for(int i=0;i&lt;100;++i)</code> 的形式，即i只在for语句块内部有效。</p><h3 id="什么是C11标准？"><a href="#什么是C11标准？" class="headerlink" title="什么是C11标准？"></a>什么是C11标准？</h3><p><code>C11标准</code>是C语言标准的第三版（<code>2011年由ISO/IEC发布</code>），前一个标准版本是<code>C99标准</code>。与<code>C99</code>相比，<code>C11</code>有哪些变化呢？</p><pre class=" language-cpp"><code class="language-cpp"><span class="token number">1</span>、 对齐处理：<span class="token keyword">alignof</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span>返回T的对齐方式，<span class="token function">aligned_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>以指定字节和对齐方式分配内存，头文件<span class="token operator">&lt;</span>stdalign<span class="token punctuation">.</span>h<span class="token operator">></span>定义了这些内容。<span class="token number">2</span>、 _Noreturn：_Noreturn是个函数修饰符，位置在函数返回类型的前面，声明函数无返回值，有点类似于gcc的<span class="token function">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>noreturn<span class="token punctuation">)</span><span class="token punctuation">)</span>，后者在声明语句尾部。<span class="token number">3</span>、 _Generic：_Generic支持轻量级范型编程，可以把一组具有不同类型而却有相同功能的函数抽象为一个接口。<span class="token number">4</span>、 <span class="token function">_Static_assert</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：<span class="token function">_Static_assert</span><span class="token punctuation">(</span><span class="token punctuation">)</span>，静态断言，在编译时刻进行，断言表达式必须是在编译时期可以计算的表达式，而普通的<span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">)</span>在运行时刻断言。<span class="token number">5</span>、安全版本的几个函数：<span class="token function">gets_s</span><span class="token punctuation">(</span><span class="token punctuation">)</span>取代了<span class="token function">gets</span><span class="token punctuation">(</span><span class="token punctuation">)</span>，原因是后者这个I<span class="token operator">/</span>O函数的实际缓冲区大小不确定，以至于发生常见的缓冲区溢出攻击，类似的函数还有其它的。<span class="token number">6</span>、 <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>新模式：<span class="token function">fopen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>增加了新的创建、打开模式“x”，在文件锁中比较常用。<span class="token number">7</span>、 匿名结构体、联合体。<span class="token number">8</span>、 多线程：头文件<span class="token operator">&lt;</span>threads<span class="token punctuation">.</span>h<span class="token operator">></span>定义了创建和管理线程的函数，新的存储类修饰符_Thread_local限定了变量不能在多线程之间共享。<span class="token number">9</span>、 _Atomic类型修饰符和头文件<span class="token operator">&lt;</span>stdatomic<span class="token punctuation">.</span>h<span class="token operator">></span>。<span class="token number">10</span>、改进的Unicode支持和头文件<span class="token operator">&lt;</span>uchar<span class="token punctuation">.</span>h<span class="token operator">></span>。<span class="token number">11</span>、<span class="token function">quick_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：又一种终止程序的方式，当<span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>失败时用以终止程序。<span class="token number">12</span>、复数宏，浮点数宏。<span class="token number">13</span>、time<span class="token punctuation">.</span>h新增timespec结构体，时间单位为纳秒，原来的timeval结构体时间单位为毫秒。</code></pre><p>下面看一段程序：</p><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// C99允许在for循环内定义循环变量，而C89不允许</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"hello world!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>在<code>C89标准</code>下编译，结果为：</p><p><a href="https://imgchr.com/i/VHJM0P" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHJM0P.md.png" alt="VHJM0P.md.png"></a></p><p>编译报错原因为，在<code>C89标准</code>下，循环变量不能在for循环内定义，必须把标准改为<code>C99标准</code>才可正常编译。以<code>C99</code>编译的命令为：</p><pre class=" language-cpp"><code class="language-cpp">gcc <span class="token operator">-</span>std<span class="token operator">=</span>c99 test<span class="token punctuation">.</span>c <span class="token operator">-</span>o test<span class="token punctuation">.</span>exe</code></pre><p>如下图，以C99编译能成功编译：</p><p><a href="https://imgchr.com/i/VHJ8fg" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/17/VHJ8fg.md.png" alt="VHJ8fg.md.png"></a></p><p>所以在平时的开发中应该要了解编译器支持什么标准。因为，有时候编译出错是因为当前编译器支持的标准不同。</p><p><code>GCC编译器</code>在编译的时候可指定C语言标准：</p><pre class=" language-cpp"><code class="language-cpp">指定c90标准<span class="token operator">:</span> <span class="token operator">-</span>std<span class="token operator">=</span>c90指定C99标准<span class="token operator">:</span> <span class="token operator">-</span>std<span class="token operator">=</span>c99定C11标准<span class="token punctuation">(</span>目前正在开发中<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">-</span>std<span class="token operator">=</span>c11</code></pre><p>以上就是关于C语言标准的笔记，如有错误欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】ASCII码可见字符与不可见字符</title>
      <link href="/2018/11/26/c-yu-yan-bi-ji-ascii-ma-ke-jian-zi-fu-yu-bu-ke-jian-zi-fu/"/>
      <url>/2018/11/26/c-yu-yan-bi-ji-ascii-ma-ke-jian-zi-fu-yu-bu-ke-jian-zi-fu/</url>
      
        <content type="html"><![CDATA[<h3 id="1-如何输出ASCII码？"><a href="#1-如何输出ASCII码？" class="headerlink" title="1. 如何输出ASCII码？"></a>1. 如何输出ASCII码？</h3><p><code>ASCII（American Standard Code for Information Interchange，美国信息交换标准代码）</code>是基于拉丁字母的一套电脑编码系统，主要用于显示现代英语和其他西欧语言。下面看一段示例代码，用于输出ASCII码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> c<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t字符\t十进制\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">for</span><span class="token punctuation">(</span>c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">;</span> c<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t%c\t%4d\n"</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输出结果发现：</p><p><a href="https://imgchr.com/i/Voedud" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/15/Voedud.md.png" alt="Voedud.md.png"></a></p><p><a href="https://imgchr.com/i/VoTZgH" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/15/VoTZgH.md.png" alt="VoTZgH.md.png"></a></p><p>从输出结果可以发现，ASCII码0-32及127对应的字符的显示是不正常的，这些显示不正常的就是不可打印字符，不可打印字符也叫控制字符，其他能显示出来的就是打印字符。</p><h3 id="2-ASCII码表"><a href="#2-ASCII码表" class="headerlink" title="2. ASCII码表"></a>2. ASCII码表</h3><p>完整ASCII表如下（图片来源于网络）：</p><p><a href="https://imgchr.com/i/VoT7xH" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/15/VoT7xH.md.png" alt="VoT7xH.md.png"></a></p><p>从这个表中，我们还看到有转义字符这一名词。转义字符是什么呢？C语言中定义了一些字母前加<code>\</code>来表示常见的那些不能显示的ASCII字符，如我们上面的代码用的<code>\t、\n</code>等，就称为<code>转义字符</code>，因为后面的字符，都不是它本来的ASCII字符意思了。</p><h3 id="3-转义字符对应表"><a href="#3-转义字符对应表" class="headerlink" title="3. 转义字符对应表"></a>3. 转义字符对应表</h3><p>转义字符对应表如下（图片来源于网络）：</p><p><a href="https://imgchr.com/i/VTkttU" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/VTkttU.md.png" alt="VTkttU.md.png"></a></p><p>以上就是关于ASCII码的一点笔记。ASCII码有可见字符与不可见字符（控制字符）之分。其中一些常用的不可见字符可用一些字母前加<code>\</code>来表示，也即转义字符。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】变参函数</title>
      <link href="/2018/11/22/c-yu-yan-bi-ji-bian-can-han-shu/"/>
      <url>/2018/11/22/c-yu-yan-bi-ji-bian-can-han-shu/</url>
      
        <content type="html"><![CDATA[<p>提到变参函数，我们的感觉是不是既熟悉又陌生？感觉熟悉是因为我们平时都在使用着，如我们常使用的printf()函数与scanf()函数就是典型的变参函数。因为printf()函数是变参函数我们才可以根据我们的需要灵活地输出变量的值。如：</p><pre class=" language-c"><code class="language-c"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//给printf函数传入1个参数</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//给printf函数传入2个参数</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s  %d"</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//给printf函数传入3个参数</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                      <span class="token comment" spellcheck="true">//给printf函数传入n个参数</span></code></pre><p>我们可以根据需要给printf()函数传入n个参数，这就是变参函数。</p><p>感觉陌生是因为我们没有试着创建变参函数。要创建变参函数需要包含头文件<code>stdarg.h</code>，并且创建变参函数应按照如下步骤进行：</p><p><code>【第一步】</code>定义一个使用省略号的函数原型，如printf()与scanf()函数的原型为</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">printf</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>__format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token keyword">int</span> <span class="token function">scanf</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>【第二步】</code>在函数定义中创建一个<code>va_list</code>类型的变量，用于存储不定的参数；</p><p><code>【第三步】</code>用宏<code>va_start</code>把该变量初始化为一个参数列表；</p><p><code>【第四步】</code>用宏<code>va_arg</code>访问参数列表；</p><p><code>【第五步】</code>用宏<code>va_end</code>完成清理工作。</p><p>示例程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdarg.h></span></span><span class="token comment" spellcheck="true">/*【第一步】:定义一个使用省略号的函数原型 */</span><span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> lim<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/*【第二步】:声明一个va_list类型的变量ap */</span> va_list ap<span class="token punctuation">;</span>     <span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 用于保存参数之和</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*【第三步】:使用va_start把变量ap初始化为参数列表 */</span> <span class="token function">va_start</span><span class="token punctuation">(</span>ap<span class="token punctuation">,</span> lim<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lim<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">/*【第四步】: 使用va_arg访问参数列表。    这里第二个参数是double类型，传入的不定参数就应是double类型   */</span>   sum <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">va_arg</span><span class="token punctuation">(</span>ap<span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">/*【第五步】:使用va_end完成清理工作 */</span> <span class="token function">va_end</span><span class="token punctuation">(</span>ap<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">double</span> sum1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> sum2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 计算 */</span> sum1 <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   sum2 <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">6.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sum1 = %f\n"</span><span class="token punctuation">,</span> sum1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sum2 = %f\n"</span><span class="token punctuation">,</span> sum2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>变参函数sum()用于求lim个数之和，并且这lim个数的类型必须是double类型，因为sum函数实体中使用va_arg访问参数列表中的参数类型为double类型。</p><p>程序输出结果为：</p><p><a href="https://imgchr.com/i/V5haRI" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5haRI.md.png" alt="V5haRI.md.png"></a></p><p>以上就是小编关于可变参数的一点小总结。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】关于随机数的总结</title>
      <link href="/2018/11/17/c-yu-yan-bi-ji-guan-yu-sui-ji-shu-de-zong-jie/"/>
      <url>/2018/11/17/c-yu-yan-bi-ji-guan-yu-sui-ji-shu-de-zong-jie/</url>
      
        <content type="html"><![CDATA[<p>C语言的库头文件<code>stdlib.h</code>中有个生成随机数的函数：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>该函数返回<code>0~RAND_MAX</code>之间的随机数，在<code>stdlib.h</code>中可知道，<code>RAND_MAX</code>为<code>0x7FFF</code>，如：</p><p><a href="https://imgchr.com/i/V71CkQ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V71CkQ.md.png" alt="V71CkQ.md.png"></a></p><p>但这里生成的随机数为<code>伪随机数</code>。所谓的伪随机数简单来说就是每次运行程序产生的随机数都是一样的。</p><p>示例程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><p><a href="https://imgchr.com/i/V71kpn" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V71kpn.md.png" alt="V71kpn.md.png"></a></p><p>程序连续运行三次，产生的由rand()函数产生的随机数都是一样的，这就是伪随机数。</p><p>那么如何才能产生真正的随机数呢？其实头文件stdlib.h里还有另一个函数：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">srand</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> seed<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这个函数的作用是产生随机数种子，<code>rand()</code>函数会根据<code>seed</code>的值来产生随机数，若在这调用<code>rand()</code>函数之前没有调用<code>srand</code>进行播种，则<code>seed</code>的值就没变，则产生的随机数就是<code>伪随机数</code>。所以，只要种子<code>seed</code>的值改变，那么调用rand()函数产生的随机数就是真正的随机数。</p><p>示例程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">srand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">srand</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">srand</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><p><a href="https://imgchr.com/i/V71n7F" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V71n7F.md.png" alt="V71n7F.md.png"></a></p><p>可见，种子<code>seed</code>不一样，生成的随机数就不一样，即真实的随机数。</p><p>把<code>seed</code>的值改为相同的，则产生的随机数就是伪随机数。</p><p>示例程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">srand</span><span class="token punctuation">(</span><span class="token number">520</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">srand</span><span class="token punctuation">(</span><span class="token number">520</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">srand</span><span class="token punctuation">(</span><span class="token number">520</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果：</p><p><img src="https://s2.ax1x.com/2019/06/16/V71YnK.png" alt="V71YnK.png"></p><p>种子<code>seed</code>不变，产生的随机数就是一样的，即伪随机数。</p><p>那么，怎么才能较方便地设置随机数的种子呢？可以使用<code>time()</code>函数的返回值作为随机数种子，<code>time()</code>函数返回的是1970年1月1日至现在的秒数，每一时刻都是不一样的，即每一时刻<code>seed</code>的值都不一样。</p><p>接下来编写一个程序用于产生10个10以内的随机数，示例程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> loop<span class="token punctuation">;</span> <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>loop <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> loop <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> loop<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><p><a href="https://imgchr.com/i/V71aAe" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/16/V71aAe.md.png" alt="V71aAe.md.png"></a></p><p>除此之外，若要生成a~b之间的数字，可以使用<code>rand()%(b-a+1)+a</code>。</p><p>以上就是关于随机数的总结，要注意<code>srand()</code>函数应与<code>rand()</code>成对使用，并且在调用<code>rand()</code>函数之前应先调用<code>srand()</code>进行播种，每次播的随机种子应该是不一样的，否则产生的随机数就是伪随机数。可用<code>time()</code>函数的返回值作为随机种子，这是典型做法。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】时间日期函数</title>
      <link href="/2018/11/16/c-yu-yan-bi-ji-shi-jian-shi-qi-han-shu/"/>
      <url>/2018/11/16/c-yu-yan-bi-ji-shi-jian-shi-qi-han-shu/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>time.h是C/C++中的日期和时间头文件。用于需要时间方面的函数。下面分享time.h头文件中几个常用函数的用法：</p><p><a href="https://imgchr.com/i/V5fE4A" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5fE4A.md.png" alt="V5fE4A.md.png"></a></p><h3 id="time-函数"><a href="#time-函数" class="headerlink" title="time()函数"></a>time()函数</h3><p>1、函数原型</p><pre class=" language-c"><code class="language-c">time_t <span class="token function">time</span><span class="token punctuation">(</span>time_t <span class="token operator">*</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>2、函数说明</p><p>time_t 是long int 类型。此函数会返回从公元1970年1月1日的UTC时间从0时0 分0秒算起到现在所经过的秒数。如果t是空指针，直接返回当前时间。如果t不是空指针，返回当前时间的同时，将返回值赋予t指向的内存空间。</p><p>3、函数返回值<br>成功则返回秒数，失败则返回((time_t)-1)值，错误原因存于errno中。</p><p>4、示例程序</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   time_t sec <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">(</span>time_t<span class="token operator">*</span><span class="token punctuation">)</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1970-01-01至现在的秒数为：%d\n"</span><span class="token punctuation">,</span> sec<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输出结果</p><pre><code>1970-01-01至现在的秒数为：1542377079</code></pre><h3 id="gmtime-函数"><a href="#gmtime-函数" class="headerlink" title="gmtime()函数"></a>gmtime()函数</h3><p>1、函数原型</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> tm <span class="token operator">*</span><span class="token function">gmtime</span><span class="token punctuation">(</span><span class="token keyword">const</span> time_t <span class="token operator">*</span>timep<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>2、函数说明</p><p>gmtime()将参数timep所指的time_t结构中的信息转换成真实世界所使用的时间日期表示方法，然后将结果由结构tm返回。</p><p>结构tm的定义为：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> tm<span class="token punctuation">{</span>   <span class="token keyword">int</span> tm_sec<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//代表目前秒数, 正常范围为0-59, 但允许至61 秒</span>   <span class="token keyword">int</span> tm_min<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//代表目前分数, 范围0-59</span>   <span class="token keyword">int</span> tm_hour<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//从午夜算起的时数, 范围为0-23</span>   <span class="token keyword">int</span> tm_mday<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//目前月份的日数, 范围01-31</span>   <span class="token keyword">int</span> tm_mon<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//代表目前月份, 从一月算起, 范围从0-11</span>   <span class="token keyword">int</span> tm_year<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//从1900 年算起至今的年数</span>   <span class="token keyword">int</span> tm_wday<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//一星期的日数, 从星期一算起, 范围为0-6</span>   <span class="token keyword">int</span> tm_yday<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//从今年1 月1 日算起至今的天数, 范围为0-365</span>   <span class="token keyword">int</span> tm_isdst<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//日光节约时间的旗标</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>3、函数返回值</p><p>返回结构tm代表目前UTC时间。</p><p>4、示例程序</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">char</span> <span class="token operator">*</span>wday<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Sun"</span><span class="token punctuation">,</span> <span class="token string">"Mon"</span><span class="token punctuation">,</span> <span class="token string">"Tue"</span><span class="token punctuation">,</span> <span class="token string">"Wed"</span><span class="token punctuation">,</span> <span class="token string">"Thu"</span><span class="token punctuation">,</span> <span class="token string">"Fri"</span><span class="token punctuation">,</span> <span class="token string">"Sat"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>   time_t t<span class="token punctuation">;</span>   <span class="token keyword">struct</span> tm <span class="token operator">*</span>p<span class="token punctuation">;</span>   <span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> mon <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> mday <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token keyword">int</span> hour <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token keyword">char</span> <span class="token operator">*</span>week <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>   <span class="token function">time</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>   p <span class="token operator">=</span> <span class="token function">gmtime</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>   year <span class="token operator">=</span> <span class="token number">1900</span> <span class="token operator">+</span> p<span class="token operator">-></span>tm_year<span class="token punctuation">;</span>   mon <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> p<span class="token operator">-></span>tm_mon<span class="token punctuation">;</span>   mday <span class="token operator">=</span> p<span class="token operator">-></span>tm_mday<span class="token punctuation">;</span>   week <span class="token operator">=</span> wday<span class="token punctuation">[</span>p<span class="token operator">-></span>tm_wday<span class="token punctuation">]</span><span class="token punctuation">;</span>   hour <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">+</span> p<span class="token operator">-></span>tm_hour<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//获取当地时间，与UTC时间相差8小时   </span>   min <span class="token operator">=</span> p<span class="token operator">-></span>tm_min<span class="token punctuation">;</span>   sec <span class="token operator">=</span> p<span class="token operator">-></span>tm_sec<span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d-%d-%d %s"</span><span class="token punctuation">,</span> year<span class="token punctuation">,</span> mon<span class="token punctuation">,</span> mday<span class="token punctuation">,</span> week<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %.2d:%.2d:%.2d\n"</span><span class="token punctuation">,</span> hour<span class="token punctuation">,</span> min<span class="token punctuation">,</span> sec<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输出结果</p><pre class=" language-c"><code class="language-c"><span class="token number">2018</span><span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span><span class="token number">16</span> Fri <span class="token number">22</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">25</span></code></pre><h3 id="localtime-函数"><a href="#localtime-函数" class="headerlink" title="localtime()函数"></a>localtime()函数</h3><p>1、函数原型</p><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> tm <span class="token operator">*</span><span class="token function">localtime</span><span class="token punctuation">(</span><span class="token keyword">const</span> time_t <span class="token operator">*</span> timep<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>2、函数说明</p><p>localtime()将参数timep所指的time_t 结构中的信息转换成真实世界所使用的时间日期表示方法，然后将结果由结构tm返回。</p><p>3、函数返回值</p><p>返回结构tm代表目前的当地时间。</p><p>4、示例程序</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">char</span> <span class="token operator">*</span>wday<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Sun"</span><span class="token punctuation">,</span> <span class="token string">"Mon"</span><span class="token punctuation">,</span> <span class="token string">"Tue"</span><span class="token punctuation">,</span> <span class="token string">"Wed"</span><span class="token punctuation">,</span> <span class="token string">"Thu"</span><span class="token punctuation">,</span> <span class="token string">"Fri"</span><span class="token punctuation">,</span> <span class="token string">"Sat"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>   time_t t<span class="token punctuation">;</span>   <span class="token keyword">struct</span> tm <span class="token operator">*</span>p<span class="token punctuation">;</span>   <span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> mon <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> mday <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token keyword">int</span> hour <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token keyword">char</span> <span class="token operator">*</span>week <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>   <span class="token function">time</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>   p <span class="token operator">=</span> <span class="token function">localtime</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//取得当地时间</span>   year <span class="token operator">=</span> <span class="token number">1900</span> <span class="token operator">+</span> p<span class="token operator">-></span>tm_year<span class="token punctuation">;</span>   mon <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> p<span class="token operator">-></span>tm_mon<span class="token punctuation">;</span>   mday <span class="token operator">=</span> p<span class="token operator">-></span>tm_mday<span class="token punctuation">;</span>   week <span class="token operator">=</span> wday<span class="token punctuation">[</span>p<span class="token operator">-></span>tm_wday<span class="token punctuation">]</span><span class="token punctuation">;</span>   hour <span class="token operator">=</span> p<span class="token operator">-></span>tm_hour<span class="token punctuation">;</span>   min <span class="token operator">=</span> p<span class="token operator">-></span>tm_min<span class="token punctuation">;</span>   sec <span class="token operator">=</span> p<span class="token operator">-></span>tm_sec<span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d-%d-%d %s"</span><span class="token punctuation">,</span> year<span class="token punctuation">,</span> mon<span class="token punctuation">,</span> mday<span class="token punctuation">,</span> week<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %.2d:%.2d:%.2d\n"</span><span class="token punctuation">,</span> hour<span class="token punctuation">,</span> min<span class="token punctuation">,</span> sec<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span> </code></pre><p>输出结果</p><pre class=" language-c"><code class="language-c"><span class="token number">2018</span><span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span><span class="token number">16</span> Fri <span class="token number">22</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">27</span></code></pre><h3 id="ctime-函数"><a href="#ctime-函数" class="headerlink" title="ctime()函数"></a>ctime()函数</h3><p>1、函数原型</p><pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">ctime</span><span class="token punctuation">(</span><span class="token keyword">const</span> time_t <span class="token operator">*</span>timep<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>2、函数说明</p><p>ctime()将参数timep所指的time_t结构中的信息转换成真实世界所使用的时间日期表示方法，然后将结果以字符串形态返回。此函数已经由时区转换成当地时间。注意：若再调用相关的时间日期函数，此字符串可能会被破坏。</p><p>3、函数返回值</p><p>返回一字符串表示目前当地的时间日期。格式：星期,月,日,小时:分:秒,年。</p><p>4、示例程序</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   time_t t<span class="token punctuation">;</span>   <span class="token function">time</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> <span class="token function">ctime</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输出结果</p><pre class=" language-c"><code class="language-c">Fri Nov <span class="token number">16</span> <span class="token number">22</span><span class="token punctuation">:</span><span class="token number">38</span><span class="token punctuation">:</span><span class="token number">51</span> <span class="token number">2018</span></code></pre><h3 id="asctime-函数"><a href="#asctime-函数" class="headerlink" title="asctime()函数"></a>asctime()函数</h3><p>1、函数原型</p><pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">asctime</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> tm <span class="token operator">*</span> timeptr<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>2、函数说明<br>asctime()将参数timeptr所指的tm结构中的信息转换成真实世界所使用的时间日期表示方法，然后将结果以字符串形态返回。此函数已经由时区转换成当地时间。注意：若再调用相关的时间日期函数，此字符串可能会被破坏。与ctime()函数的不同在于传入参数结构不同。</p><p>3、函数返回值<br>返回一字符串表示目前当地的时间日期。格式：星期,月,日,小时:分:秒,年。</p><p>4、示例程序</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   time_t t<span class="token punctuation">;</span>   <span class="token keyword">struct</span> tm <span class="token operator">*</span>p<span class="token punctuation">;</span>   <span class="token keyword">char</span> <span class="token operator">*</span>date <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>   <span class="token function">time</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>   p <span class="token operator">=</span> <span class="token function">gmtime</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>   date <span class="token operator">=</span> <span class="token function">asctime</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输出结果</p><pre class=" language-c"><code class="language-c">Fri Nov <span class="token number">16</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">48</span><span class="token punctuation">:</span><span class="token number">29</span> <span class="token number">2018</span></code></pre><p>以上就是关于time.h头文件里一些时间函数的介绍。其中gmtime()函数与localtime()函数类似，ctime()函数与asctime()函数类似，应把这两对函数对比来看。</p><pre class=" language-c"><code class="language-c">参考资料：百度百科及C语言中文网</code></pre><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】数组a与&amp;a有什么不同？</title>
      <link href="/2018/11/13/c-yu-yan-bi-ji-shu-zu-a-yu-a-you-shi-me-bu-tong/"/>
      <url>/2018/11/13/c-yu-yan-bi-ji-shu-zu-a-yu-a-you-shi-me-bu-tong/</url>
      
        <content type="html"><![CDATA[<p>首先，看一段代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d , &amp;a = %d \n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>该代码运行结果为：</p><p><a href="https://imgchr.com/i/V5MJSO" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5MJSO.md.png" alt="V5MJSO.md.png"></a></p><p>可见，对于一个数组：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>a与&amp;a的值是相同的。为什么呢？</p><p>a是数组名，是一个数据区的常量，对其取地址（&amp;a）就可以得到数组存储区域的地址，同样，a本身也代表了数组存储区的首地址。所以，a与&amp;a的值是一样的。但是，虽然a与&amp;a指向同一个地址，但是他们的含义是不同的。下面我们修改一下上面的代码看看”a+1”与”&amp;a+1”是否还相等？修改后的代码运行结果为：</p><p><a href="https://imgchr.com/i/V5GRnU" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5GRnU.md.png" alt="V5GRnU.md.png"></a></p><p>可见，a+1的值比a的值大4，即sizeof(a[0])；&amp;a+1比&amp;a的值大20，即sizeof(a)。由此，可得出结论：a+1指向的地址相对与a指向的地址向后偏移了sizeof（a[0]）个字节，&amp;a+1指向的地址相对与&amp;a指向的地址向后偏移了sizeof(a)个字节，其描述图如下：</p><p><a href="https://imgchr.com/i/V5G5N9" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5G5N9.md.png" alt="V5G5N9.md.png"></a></p><p>下面分析一段代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*(a+1) = %d, *(ptr-1) = %d\n"</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>ptr<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果为：</p><pre class=" language-c"><code class="language-c"><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>ptr<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span></code></pre><p><code>*(a+1) = 1</code>，是因为<code>a+1</code>代表数组第二个元素的地址，即<code>&amp;a[1]</code>，<code>*(a+1)</code>为取该地址上的值，即为1；<code>*（ptr-1)=4</code>，是因为ptr指向的是整个数组内存区域之后的内存，即数组最后一个元素之后的地址，<code>ptr-1</code>就是指向数组的最后一个元素，<code>*（ptr-1)</code>为取该地址上的值，即为4。</p><p>以上就是今天分享的关于数组的一个小知识点,如有错误欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】两个小知识</title>
      <link href="/2018/11/13/c-yu-yan-bi-ji-liang-ge-xiao-zhi-shi/"/>
      <url>/2018/11/13/c-yu-yan-bi-ji-liang-ge-xiao-zhi-shi/</url>
      
        <content type="html"><![CDATA[<h3 id="一、关于头文件包含问题"><a href="#一、关于头文件包含问题" class="headerlink" title="一、关于头文件包含问题"></a>一、关于头文件包含问题</h3><p>C语言包含头文件时应该使用尖括号还是双引号？使用尖括号&lt;&gt;,编译器会到系统路径下查找头文件；而使用双引号“”，编译器首先在当前路径目录下查找头文件，如果没有找到，再转到系统目录下查找。所以，通常使用尖括号包含标准头文件，使用双引号包含自定义头文件。如：</p><p><a href="https://imgchr.com/i/V5W5pq" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5W5pq.md.png" alt="V5W5pq.md.png"></a></p><h3 id="二、关于头文件重复包含问题"><a href="#二、关于头文件重复包含问题" class="headerlink" title="二、关于头文件重复包含问题"></a>二、关于头文件重复包含问题</h3><p>同一个头文件在不同的C文件里可能会被包含很多次，可能会产生重复包含的错误。我们可以使用宏保护来解决这个问题，如test.h中可以使用如下宏保护：</p><p><a href="https://imgchr.com/i/V5WocV" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5WocV.md.png" alt="V5WocV.md.png"></a></p><p>第一次包含头文件，会定义宏_TEST_H，并执行“头文件“的代码；第二次包含时因为之前已经有定义宏_TEST_H，不会重复执行”#ifndef _TEST_H“与”#endif“之间的代码。</p><p>stm32单片机中的库文件就是这么做的，如</p><p><a href="https://imgchr.com/i/V5WOAJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5WOAJ.md.png" alt="V5WOAJ.md.png"></a></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】指针函数与函数指针？</title>
      <link href="/2018/11/08/c-yu-yan-bi-ji-zhi-zhen-han-shu-yu-han-shu-zhi-zhen/"/>
      <url>/2018/11/08/c-yu-yan-bi-ji-zhi-zhen-han-shu-yu-han-shu-zhi-zhen/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>函数、指针这两个词结合的顺序不同其意义也不同，即指针函数与函数指针的意义不同。</p><h3 id="指针函数"><a href="#指针函数" class="headerlink" title="指针函数"></a>指针函数</h3><p>指针函数的本质是一个函数，其返回值是一个指针。示例如下：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">pfun</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>由于“*”的优先级低于“()”的优先级，因而pfun首先和后面的“()”结合，也就意味着，pfun是一个函数。即：<code>int *(pfun(int, int));</code></p><p>接着再和前面的“*”结合，说明这个函数的返回值是一个指针。由于前面还有一个int，也就是说，pfun是一个返回值为整型指针的函数。</p><p>指针函数示例程序如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token comment" spellcheck="true">//这是一个指针函数的声明</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">pfun</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//指针函数的调用</span> p <span class="token operator">=</span> <span class="token function">pfun</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"array[%d] = %d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//这是一个指针函数，其返回值为指向整形的指针</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">pfun</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> arr<span class="token punctuation">;</span> <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果如下：</p><p><a href="https://imgchr.com/i/V5wndf" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5wndf.md.png" alt="V5wndf.md.png"></a></p><p>主函数中，把一个数组的首地址与数组长度作为实参传入指针函数pfun里，把指针函数的返回值（即指向数组的指针）赋给整形指针p。最后使用指针p来遍历数组元素并打印输出。</p><h3 id="函数指针"><a href="#函数指针" class="headerlink" title="函数指针"></a>函数指针</h3><p>函数指针其本质是一个指针变量，该指针变量指向一个函数。C程序在编译时，每一个函数都有一个入口地址，该入口地址就是函数指针所指向的地址。函数指针示例：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/*声明一个函数指针 */</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>fptr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 函数指针指向函数func */</span>fptr <span class="token operator">=</span> func<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 或者fptr = &amp;func;</span></code></pre><p>func是一个函数名，那么func与&amp;func都表示的是函数的入口地址。同样的，在函数的调用中可以使用：方式一：func()，也可以使用方式二：(*fun)()。这两种调用方式是等价的，只是我们平时大多都习惯用方式一的调用方法。</p><p>至于为什么func与&amp;func的含义相同，<code>《嵌入式Linux上的C语言编程实践》</code>这本书中有如下解释：</p><blockquote><p>对于函数func来说，函数的名称就是函数代码区的常量，对它取地址(&amp;func)可以得到函数代码区的地址，同时，func本身也可以视为函数代码区的地址。因此，函数名称和对其取地址其含义是相同的。</p></blockquote><p>函数指针示例程序如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>fptr<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//定义一个函数指针</span> <span class="token keyword">int</span> res<span class="token punctuation">;</span> fptr <span class="token operator">=</span> add<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//函数指针fptr指向函数add</span> <span class="token comment" spellcheck="true">/* 通过函数指针调用函数 */</span> res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>fptr<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//等价于res = fptr(1,2);</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a + b = %d\n"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果如下：</p><p><a href="https://imgchr.com/i/V5wJLq" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5wJLq.md.png" alt="V5wJLq.md.png"></a></p><p>以上就是关于指针函数与函数指针的简单区分。其中，函数指针广泛应用于嵌入式软件开发中，其常用的两个用途：调用函数和做函数的参数。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】关于有符号数与无符号数的一些总结</title>
      <link href="/2018/10/30/c-yu-yan-bi-ji-guan-yu-you-fu-hao-shu-yu-wu-fu-hao-shu-de-yi-xie-zong-jie/"/>
      <url>/2018/10/30/c-yu-yan-bi-ji-guan-yu-you-fu-hao-shu-yu-wu-fu-hao-shu-de-yi-xie-zong-jie/</url>
      
        <content type="html"><![CDATA[<h3 id="有、无符号数之间的运算"><a href="#有、无符号数之间的运算" class="headerlink" title="有、无符号数之间的运算"></a>有、无符号数之间的运算</h3><p>有符号数与无符号数之间的运算，编译器会进行隐式类型转换。</p><p>请看如下代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> a<span class="token operator">+</span>b <span class="token operator">></span> <span class="token number">6</span> <span class="token punctuation">)</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a+b大于6\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a+b小于6\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序输出结果为：</p><pre class=" language-c"><code class="language-c">a<span class="token operator">+</span>b大于<span class="token number">6</span></code></pre><p>原因是因为编译器会将有符号数b转换成为一个无符号数，即此处<code>a+b</code>等价于<code>a+(unsigned int)b</code>。</p><p>该程序运行在32bit环境下，b的值为<code>0xFFFFFFFF-20+1 = 4294967276</code>，即a+b将远远大于6。</p><p>C 语言按照一定的规则来进行此类运算的转换，这种规则称为<code>正常算术转换</code>，转换的顺序为：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">double</span><span class="token operator">></span><span class="token keyword">float</span><span class="token operator">></span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token operator">></span><span class="token keyword">long</span><span class="token operator">></span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token keyword">int</span></code></pre><p>即操作数类型排在后面的与操作数类型排在前面的进行运算时，排在后面的类型将隐式转换为排在前面的类型。</p><h3 id="有、无符号数转化为更大类型"><a href="#有、无符号数转化为更大类型" class="headerlink" title="有、无符号数转化为更大类型"></a>有、无符号数转化为更大类型</h3><p>请看如下代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//情况一</span> <span class="token keyword">signed</span> <span class="token keyword">char</span> c1 <span class="token operator">=</span> <span class="token number">0xff</span><span class="token punctuation">;</span>   <span class="token keyword">unsigned</span> <span class="token keyword">char</span> c2 <span class="token operator">=</span> <span class="token number">0xff</span><span class="token punctuation">;</span> <span class="token keyword">int</span> a1<span class="token punctuation">,</span>a2<span class="token punctuation">;</span> a1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c1<span class="token punctuation">;</span> a2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c2<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a1=%d(%#.8X),a2=%d(%#.8X)\n"</span><span class="token punctuation">,</span>a1<span class="token punctuation">,</span>a1<span class="token punctuation">,</span>a2<span class="token punctuation">,</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//情况二</span> <span class="token keyword">signed</span> <span class="token keyword">char</span> c3 <span class="token operator">=</span> <span class="token number">0x80</span><span class="token punctuation">;</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> c4 <span class="token operator">=</span> <span class="token number">0x80</span><span class="token punctuation">;</span> <span class="token keyword">int</span> a3<span class="token punctuation">,</span>a4<span class="token punctuation">;</span> a3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c3<span class="token punctuation">;</span> a4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c4<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a3=%d(%#.8X),a4=%d(%#.8X)\n"</span><span class="token punctuation">,</span>a3<span class="token punctuation">,</span>a3<span class="token punctuation">,</span>a4<span class="token punctuation">,</span>a4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//情况三</span> <span class="token keyword">signed</span> <span class="token keyword">char</span> c5 <span class="token operator">=</span> <span class="token number">0x7f</span><span class="token punctuation">;</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> c6 <span class="token operator">=</span> <span class="token number">0x7f</span><span class="token punctuation">;</span> <span class="token keyword">int</span> a5<span class="token punctuation">,</span>a6<span class="token punctuation">;</span> a5 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c5<span class="token punctuation">;</span> a6 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c6<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a5=%d(%#.8X),a6=%d(%#.8X)\n"</span><span class="token punctuation">,</span>a5<span class="token punctuation">,</span>a5<span class="token punctuation">,</span>a6<span class="token punctuation">,</span>a6<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序输出结果为：</p><pre class=" language-c"><code class="language-c">a1<span class="token operator">=</span><span class="token operator">-</span><span class="token function">1</span><span class="token punctuation">(</span><span class="token number">0XFFFFFFFF</span><span class="token punctuation">)</span><span class="token punctuation">,</span>a2<span class="token operator">=</span><span class="token function">255</span><span class="token punctuation">(</span><span class="token number">0X000000FF</span><span class="token punctuation">)</span>a3<span class="token operator">=</span><span class="token operator">-</span><span class="token function">128</span><span class="token punctuation">(</span><span class="token number">0XFFFFFF80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>a4<span class="token operator">=</span><span class="token function">128</span><span class="token punctuation">(</span><span class="token number">0X00000080</span><span class="token punctuation">)</span>a5<span class="token operator">=</span><span class="token function">127</span><span class="token punctuation">(</span><span class="token number">0X0000007F</span><span class="token punctuation">)</span><span class="token punctuation">,</span>a6<span class="token operator">=</span><span class="token function">127</span><span class="token punctuation">(</span><span class="token number">0X0000007F</span><span class="token punctuation">)</span></code></pre><p>可见：</p><p>（1）将无符号数转换为更大的数据类型时, 只需简单地在开头添加0至所需位数，这种运算称为0扩展。</p><p>（2）将有符号数转换为更大的数据类型需要执行符号扩展，规则是将符号位扩展至所需的位数，即符号位为0时在开头添加0至所需位数，符号位为1时在开头添加1至所需位数。</p><p>此外，还需注意，对于一个signed char类型数据，0xff代表的是-1，因为整数在内存中是以补码的形式存储的。</p><p>正数的原码、反码、补码都相等。负数的反码是将原码中除符号位以外的所有位（数值位）取反，也就是 0 变成 1，1 变成 0；负数的补码是其反码加 1。</p><p>此处，对于一个signed char类型数据，-1的原码为1000 0001，反码为1111 1110，所以补码为1111 1111。</p><p>signed char的负数对应表为（图片来源于网络）：</p><p><a href="https://imgchr.com/i/V5Fk0U" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5Fk0U.md.png" alt="V5Fk0U.md.png"></a></p><p>其中，-128最为特殊，需要特别记住，其不遵循传统的由补码计算原码的方法。</p><p>以上就是关于有符号数与无符号数的两点总结：（1）有符号数与无符号数之间的运算，编译器会进行隐式类型转换。（2）有符号数、无符号数转换为更大的数据类型。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】数组与指针不等价</title>
      <link href="/2018/10/25/c-yu-yan-bi-ji-shu-zu-yu-zhi-zhen-bu-deng-jie/"/>
      <url>/2018/10/25/c-yu-yan-bi-ji-shu-zu-yu-zhi-zhen-bu-deng-jie/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>数组与指针是不等价的，如：</p><ul><li><p>数组名不可以改变，而指向数组的指针是可以改变的。</p></li><li><p>字符串指针指向的字符串中的字符是不能改变的，而字符数组中的字符是可以改变的。</p></li><li><p>求数组长度时，借用数组名可求得数组长度，而借用指针却得不到数组长度。</p></li></ul><h3 id="区别一"><a href="#区别一" class="headerlink" title="区别一"></a>区别一</h3><p>数组名的指向不可以改变，而指向数组的指针是可以改变的。</p><p>请看如下代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">*</span>p <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token keyword">char</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 数组遍历方式一</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a[%d] = %d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// 数组遍历方式二</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a[%d] = %d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token operator">*</span>a<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>数组遍历方式一：使用指针遍历数组元素，<em>p++等价于</em>(p++)，即指针指向的地址每次后移一个单位，然后再取地址上的值。这里的一个单位是sizeof(int)个字节。</p><p>数组遍历方式二：使用数组名自增遍历数组元素，编译出错，错误如下：</p><pre class=" language-c"><code class="language-c">error<span class="token punctuation">:</span> value required as increment operand</code></pre><p>因为数组名的指向是不可以改变的，使用自增运算符自增就会改变其指向，这是不对的，数组名只能指向数组的开头。但是可以改为如下遍历方式：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a[%d] = %d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre><p>这可以正确遍历数组元素。因为*(a+i)与a[i]是等价的。</p><h3 id="区别二"><a href="#区别二" class="headerlink" title="区别二"></a>区别二</h3><p>字符串指针指向的字符串中的字符是不能改变的，而字符数组中的字符是可以改变的。</p><p>请看如下代码：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//字符串定义方式一</span><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"happy"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//字符串定义方式二</span><span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token string">"happy"</span><span class="token punctuation">;</span></code></pre><p>字符串定义方式一：字符串中的字符是可以改变的。如可以使用类似str[3]=’q’这样的语句来改变其中的字符。原因就是：这种方式定义的字符串保存在全局数据区或栈区，是可读写的。</p><p>字符串定义方式二：字符串中的字符是不可以改变的。原因就是：这种方式定义的字符串保存在常量区，是不可修改的。</p><h3 id="区别三"><a href="#区别三" class="headerlink" title="区别三"></a>区别三</h3><p>求数组长度时，借用数组名可求得数组长度，而借用指针却得不到数组长度。</p><p>请看如下代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">*</span>p <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token keyword">char</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 求数组长度方式一</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"方式一：len=%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 求数组长度方式二</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"方式二：len=%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果</p><pre class=" language-c"><code class="language-c">方式一：len<span class="token operator">=</span><span class="token number">5</span>方式二：len<span class="token operator">=</span><span class="token number">1</span></code></pre><p>求数组长度方式一：借用数组名来求数组长度，可求得数组有5个元素，正确。</p><p>求数组长度方式二：借用指针求数组长度，求得长度为1，错误。原因是：</p><p>p只是一个指向int类型的指针，编译器不知道其指向的是一个整数还是指向一个数组。sizeof(p)求得的是p这个指针变量本身所占用的字节数，而不是整个数组占用的字节数。</p><p>以上就是指针与其指向的数组的三个典型的区别：（1）遍历数组时需要注意；（2）修改字符串中的字符时需要注意；（3）求数组长度时需要注意。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】关于二维数组作为函数参数的问题</title>
      <link href="/2018/10/25/c-yu-yan-bi-ji-guan-yu-er-wei-shu-zu-zuo-wei-han-shu-can-shu-de-wen-ti/"/>
      <url>/2018/10/25/c-yu-yan-bi-ji-guan-yu-er-wei-shu-zu-zuo-wei-han-shu-can-shu-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<p>在构建过二维数组作为函数的参数时遇到了一个问题。首先，我们看一个函数：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span>   <span class="token punctuation">{</span>     <span class="token comment" spellcheck="true">//printf("%d ", array[i][j] );</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>array<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>函数设计的功能很简单，就是打印输出二维数组中的所有元素。</p><p>假如我们的主函数为：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>大家觉得输出结果会是什么呢？结果是什么都没输出。出错原因是因为二维数组作为函数参数时要给出二维长度。但是，是不是就不能使用这个函数了呢？还是可以使用的，只要在主函数中定义一个指针数组作为中间桥梁即可正确输出。即主函数修改为如下所示：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//a[0]</span> p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//a[1]</span> p<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//a[2]</span> <span class="token function">func1</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>         </code></pre><p>定义一个指针数组，该指针数组中的元素分别指向每一行的第一个元素。再把该指针数组作为形参传入func1函数中。</p><p>除此之外，还有如下三种方法构造函数：</p><p>（1）形参声明为一级指针</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token operator">*</span>n<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>（2）形参给出二维长度</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>   <span class="token punctuation">{</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span>   <span class="token punctuation">{</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>（3）形参声明为指向数组的指针（数组指针）</p><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>array<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span>   <span class="token punctuation">{</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>以上代码关于二维数组作为函数参数时，函数的定义方法。如有错误，欢迎指出~</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】static关键字</title>
      <link href="/2018/10/25/c-yu-yan-bi-ji-static-guan-jian-zi/"/>
      <url>/2018/10/25/c-yu-yan-bi-ji-static-guan-jian-zi/</url>
      
        <content type="html"><![CDATA[<pre class=" language-c"><code class="language-c">参考：https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>csdn<span class="token punctuation">.</span>net<span class="token operator">/</span>keyeagle<span class="token operator">/</span>article<span class="token operator">/</span>details<span class="token operator">/</span><span class="token number">6708077</span><span class="token operator">?</span>utm_source<span class="token operator">=</span>copy </code></pre><p>C语言代码是以文件为单位来组织的，在一个源程序的所有源文件中，一个外部变量（注意不是局部变量）或者函数只能在一个源程序中定义一次，如果有重复定义的话编译器就会报错。</p><p>伴随着不同源文件变量和函数之间的相互引用以及相互独立的关系，产生了extern和static关键字。</p><p>下面，详细分析一下static关键字在编写程序时有的三大类用法：</p><h3 id="static定义全局变量"><a href="#static定义全局变量" class="headerlink" title="static定义全局变量"></a>static定义全局变量</h3><p>一个进程在内存中的布局如图1所示：</p><p><a href="https://imgchr.com/i/V5F0nf" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5F0nf.md.png" alt="V5F0nf.md.png"></a></p><p>其中<code>.text段</code>保存进程所执行的程序二进制文件，<code>.data段</code>保存进程所有的已初始化的全局变量，<code>.bss段</code>保存进程未初始化的全局变量（其他段中还有很多乱七八糟的段，暂且不表）。在进程的整个生命周期中，.data段和.bss段内的数据时跟整个进程同生共死的，也就是在进程结束之后这些数据才会寿终就寝。</p><p>当一个进程的全局变量被声明为static之后，它的中文名叫<code>静态全局变量</code>。静态全局变量和其他的全局变量的存储地点并没有区别，都是在.data段（已初始化）或者.bss段（未初始化）内，但是它只在定义它的源文件内有效，其他源文件无法访问它。所以，普通全局变量穿上static外衣后，它就变成了新娘，已心有所属，只能被定义它的源文件（新郎）中的变量或函数访问。</p><p>以下是示例程序：</p><p>file1.h如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">void</span> <span class="token function">printStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>我们在file1.c中定义一个静态全局变量hello, 供file1.c中的函数printStr访问。</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"file1.h"</span></span><span class="token keyword">static</span> <span class="token keyword">char</span><span class="token operator">*</span> hello <span class="token operator">=</span> <span class="token string">"hello ZhengNian!"</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">printStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> hello<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>main.c如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"file1.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> hello<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>main.c是我们的主程序所在文件，main.c中如果引用hello会编译出错，报错如下：</p><p><a href="https://imgchr.com/i/V5knUg" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5knUg.md.png" alt="V5knUg.md.png"></a></p><p>如果我们将main.c改为下面的形式：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"file1.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>则会顺利编译连接。运行结果如下：</p><p><a href="https://imgchr.com/i/V5ku5Q" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5ku5Q.md.png" alt="V5ku5Q.md.png"></a></p><h3 id="static定义局部变量"><a href="#static定义局部变量" class="headerlink" title="static定义局部变量"></a>static定义局部变量</h3><p>static局部变量中文名叫静态局部变量。它与普通的局部变量比起来有如下几个区别：</p><p>（1）位置：静态局部变量被编译器放在全局存储区.data（注意：不在.bss段内，原因见（3）），所以它虽然是局部的，但是在程序的整个生命周期中存在。</p><p>（2）访问权限：静态局部变量只能被其作用域内的变量或函数访问。也就是说虽然它会在程序的整个生命周期中存在，由于它是static的，它不能被其他的函数和源文件访问。</p><p>（3）值：静态局部变量如果没有被用户初始化，则会被编译器自动赋值为0，以后每次调用静态局部变量的时候都用上次调用后的值。这个比较好理解，每次函数调用静态局部变量的时候都修改它然后离开，下次读的时候从全局存储区读出的静态局部变量就是上次修改后的值。</p><p>以下是示例程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> normal_var <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">static</span> <span class="token keyword">int</span> static_var <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"normal_var:%d  static_var:%d\n"</span><span class="token punctuation">,</span> normal_var<span class="token punctuation">,</span> static_var<span class="token punctuation">)</span><span class="token punctuation">;</span> normal_var<span class="token operator">++</span><span class="token punctuation">;</span> static_var<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果如下：</p><p><a href="https://imgchr.com/i/V5kl2n" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5kl2n.md.png" alt="V5kl2n.md.png"></a></p><p>可以看出，函数每次被调用，普通局部变量都是重新分配，而静态局部变量保持上次调用的值不变。</p><p>需要注意的是由于static局部变量的这种特性，使得含静态局部变量的函数变得不可重入，即每次调用可能会产生不同的结果。这在多线程编程时可能会成为一种隐患。需要多加注意。</p><h3 id="static定义函数"><a href="#static定义函数" class="headerlink" title="static定义函数"></a>static定义函数</h3><p>当你的程序中有很多个源文件的时候，你肯定会让某个源文件只提供一些外界需要的接口，其他的函数可能是为了实现这些接口而编写，这些其他的函数你可能并不希望被外界（非本源文件）所看到，这时候就可以用static修饰这些“其他的函数”。</p><p>所以static函数的作用域是本源文件。static定义函数与static定义全局变量类似，不再举例说明，可参考“static定义全局变量”的程序定义全局变量的套路。</p><p>以上就是关于static的三种用法，如有错误，欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】关于数组与指针的总结</title>
      <link href="/2018/10/23/c-yu-yan-bi-ji-guan-yu-shu-zu-yu-zhi-zhen-de-zong-jie/"/>
      <url>/2018/10/23/c-yu-yan-bi-ji-guan-yu-shu-zu-yu-zhi-zhen-de-zong-jie/</url>
      
        <content type="html"><![CDATA[<blockquote><p>参考：C语言中文网</p></blockquote><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>数组与指针有很密切的联系，常见的结合情况有以下三种：</p><ul><li>数组指针</li><li>指针数组</li><li>二维数组指针</li></ul><h3 id="数组指针"><a href="#数组指针" class="headerlink" title="数组指针"></a>数组指针</h3><p>数组指针：指向数组的指针。如：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> arr<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//也可写作int *p=&amp;arr[0]</span></code></pre><p>也就是说，p，arr，&amp;arr[0]都是指向数组的开头，即第0个元素的地址。</p><p>如果一个指针p指向一个数组arr[]的开头，那么p+i为数组第i个元素的地址，即&amp;arr[i]，那么*(p+i)为数组第i个元素的值，即arr[i]。</p><p>同理，若指针p指向数组的第n个元素，那么p+i为第n+1个元素的地址；不管 p 指向了数组的第几个元素，p+1 总是指向下一个元素，p-1 也总是指向上一个元素。</p><p>下面示例证实了这一点：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>   <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//也可以写作 int *p = arr + 3;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d, %d, %d, %d, %d\n"</span><span class="token punctuation">,</span>    <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token number">-3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token number">-2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果为：</p><pre class=" language-c"><code class="language-c"><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span></code></pre><h3 id="指针数组"><a href="#指针数组" class="headerlink" title="指针数组"></a>指针数组</h3><p>指针数组：数组中每个元素都是指针。如：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>示例程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//定义一个指针数组</span>   <span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//也可以不指定长度，直接写作 int *parr[]</span>   <span class="token comment" spellcheck="true">//定义一个指向指针数组的指针</span>   <span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span>parr <span class="token operator">=</span> arr<span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d, %d, %d\n"</span><span class="token punctuation">,</span> <span class="token operator">*</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d, %d, %d\n"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">(</span>parr<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">(</span>parr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">(</span>parr<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>第一个 printf() 语句中，arr[i] 表示获取第 i 个元素的值，该元素是一个指针，还需要在前面增加一个 * 才能取得它指向的数据，也即 *arr[i] 的形式。</p><p>第二个 printf() 语句中，parr+i 表示第 i 个元素的地址，<em>(parr+i) 表示获取第 i 个元素的值（该元素是一个指针），*</em>(parr+i) 表示获取第 i 个元素指向的数据。</p><p>指针数组还可以和字符串数组结合使用，请看下面的例子：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span>  <span class="token punctuation">{</span>       <span class="token string">"hello C"</span><span class="token punctuation">,</span>       <span class="token string">"hello C++"</span><span class="token punctuation">,</span>       <span class="token string">"hello Java"</span>   <span class="token punctuation">}</span><span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n%s\n%s\n"</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果为：</p><pre class=" language-c"><code class="language-c">hello Chello C<span class="token operator">++</span>hello Java</code></pre><h3 id="二维数组指针"><a href="#二维数组指针" class="headerlink" title="二维数组指针"></a>二维数组指针</h3><p>二维数组指针：指向二维数组的指针。如：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span></code></pre><p>a[3][4]表示一个3行4列的二维数组，其所有元素在内存中是连续存储的。</p><p>请看如下程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span> <span class="token keyword">for</span><span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">for</span><span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span>   <span class="token punctuation">{</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a[%d][%d]=%d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果为：</p><pre class=" language-c"><code class="language-c">a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422216</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422220</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422224</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422228</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422232</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422236</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422240</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422244</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422248</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422252</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422256</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">6422260</span></code></pre><p>可见，每个元素的地址都是相差4个字节，即每个连续在内存中是连续存储的。</p><p>按照以上定义可归纳出如下4个结论：</p><p>（1）p指向数组a的开头，也即第1行；p+1前进一行，指向第2行。</p><p>（2）*(p+1)表示取第2行元素（一整行元素）。</p><p>（3）*(p+1)+1表示第2行第2个元素的地址。</p><p>（4）<em>(</em>(p+1)+1)表示第2行第2个元素的值。</p><p>综上4点，可得出如下结论：</p><pre class=" language-c"><code class="language-c">a<span class="token operator">+</span>i <span class="token operator">==</span> p<span class="token operator">+</span>i <span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span>i<span class="token punctuation">)</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token operator">==</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">+</span>j<span class="token punctuation">)</span></code></pre><p>以上就是数组与指针常用的三种结合形式。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】指针变量的运算</title>
      <link href="/2018/10/22/c-yu-yan-bi-ji-zhi-zhen-bian-liang-de-yun-suan/"/>
      <url>/2018/10/22/c-yu-yan-bi-ji-zhi-zhen-bian-liang-de-yun-suan/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>指针变量也是可以进行运算的，如指针变量对其自身加上某个整数或减去某个整数，这在内存上体现为：相对这个指针向后偏移多少个单位或向前偏移了多少个单位，这里的单位与指针变量的类型有关。在32bit环境下，int类型占4个字节，float占4字节，double类型占8字节，char占1字节。</p><p>【注意】一些处理整数的操作不能用来处理指针。例如，可以把两个整数相乘，但是不能把两个指针相乘。</p><h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span>    a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">*</span>pa <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>    <span class="token keyword">float</span>  b <span class="token operator">=</span> <span class="token number">6.6</span><span class="token punctuation">,</span> <span class="token operator">*</span>pb <span class="token operator">=</span> <span class="token operator">&amp;</span>b<span class="token punctuation">;</span>    <span class="token keyword">char</span>   c <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token operator">*</span>pc <span class="token operator">=</span> <span class="token operator">&amp;</span>c<span class="token punctuation">;</span>    <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token number">2.14e9</span><span class="token punctuation">,</span> <span class="token operator">*</span>pd <span class="token operator">=</span> <span class="token operator">&amp;</span>d<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//最初的值</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa0=%d, pb0=%d, pc0=%d, pd0=%d\n"</span><span class="token punctuation">,</span> pa<span class="token punctuation">,</span> pb<span class="token punctuation">,</span> pc<span class="token punctuation">,</span> pd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//加法运算</span>    pa <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>     pb <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>     pc <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    pd <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa1=%d, pb1=%d, pc1=%d, pd1=%d\n"</span><span class="token punctuation">,</span> pa<span class="token punctuation">,</span> pb<span class="token punctuation">,</span> pc<span class="token punctuation">,</span> pd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//减法运算</span>    pa <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     pb <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     pc <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    pd <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa2=%d, pb2=%d, pc2=%d, pd2=%d\n"</span><span class="token punctuation">,</span> pa<span class="token punctuation">,</span> pb<span class="token punctuation">,</span> pc<span class="token punctuation">,</span> pd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果为：</p><pre class=" language-c"><code class="language-c">pa0<span class="token operator">=</span><span class="token number">6422268</span><span class="token punctuation">,</span> pb0<span class="token operator">=</span><span class="token number">6422264</span><span class="token punctuation">,</span> pc0<span class="token operator">=</span><span class="token number">6422263</span><span class="token punctuation">,</span> pd0<span class="token operator">=</span><span class="token number">6422248</span>pa1<span class="token operator">=</span><span class="token number">6422276</span><span class="token punctuation">,</span> pb1<span class="token operator">=</span><span class="token number">6422272</span><span class="token punctuation">,</span> pc1<span class="token operator">=</span><span class="token number">6422265</span><span class="token punctuation">,</span> pd1<span class="token operator">=</span><span class="token number">6422264</span>pa2<span class="token operator">=</span><span class="token number">6422272</span><span class="token punctuation">,</span> pb2<span class="token operator">=</span><span class="token number">6422268</span><span class="token punctuation">,</span> pc2<span class="token operator">=</span><span class="token number">6422264</span><span class="token punctuation">,</span> pd2<span class="token operator">=</span><span class="token number">6422256</span></code></pre><p>解析：</p><p>举例说明<code>pa0→pa1→pa2</code>的过程，其他类似。<code>pa0+2*sizeof(int)=pa1,pa1-1*sizeof(int)=pa2</code>。因为pa为int类型的指针，所以加减运算是以4字节（即sizeof(int)）为单位地址向前向后偏移的。看下图：</p><p><a href="https://imgchr.com/i/V59WwQ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V59WwQ.md.png" alt="V59WwQ.md.png"></a></p><p>如图：pa1所指向的地址在pa0所指向地址往后8字节处，pa2指向地址在pa1指向地址往前4字节处。</p><p>从本示例程序中，还可以看出：连续定义的变量在内存的存储有可能是紧挨着的，有可能是分散着的。</p><p>以上就是关于C语言指针变量运算的一些总结：指针变量与整数相加相减是相对该指针指向的地址向后向前偏移多少个单位。这里的单位不能认为总是1。在32bit环境下，char类型指针的偏移单位才是1字节，int类型指针偏移单位是4字节，float类型指针偏移单位是4字节，double类型指针偏移单位是8字节。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】结构体内存对齐</title>
      <link href="/2018/10/20/c-yu-yan-bi-ji-jie-gou-ti-nei-cun-dui-qi/"/>
      <url>/2018/10/20/c-yu-yan-bi-ji-jie-gou-ti-nei-cun-dui-qi/</url>
      
        <content type="html"><![CDATA[<p>先看一个结构体：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> Test<span class="token punctuation">{</span> <span class="token keyword">char</span> a1<span class="token punctuation">;</span> <span class="token keyword">int</span> a2<span class="token punctuation">;</span> <span class="token keyword">char</span> a3<span class="token punctuation">;</span> <span class="token keyword">short</span> a4<span class="token punctuation">;</span><span class="token punctuation">}</span>Test_T<span class="token punctuation">;</span></code></pre><p>在32位编译系统下这一个结构体的字节数是多少呢？是1+4+1+2=8字节吗？不是的，实际结果为12字节。为什么呢？因为编译器会对不足4字节的变量空间自动补齐为4个字节（这就是内存对齐），以提高CPU的寻址效率（32位CPU以4个字节步长寻址的）。</p><p>内存对齐是编译器的“管辖范围”。编译器为程序中的每个”数据单元“安排在适当的位置上，以便于能快速的找到每个“数据单元”。对于32bit的CPU，其寻址的步长为4个字节（即unsigned int 字节长度），这就是常说的“4字节对齐”。同理，对于64bit的CPU，就有“8字节对齐”。本文以32位的CPU为例。</p><p>请看下面代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> Test<span class="token punctuation">{</span> <span class="token keyword">char</span> a1<span class="token punctuation">;</span> <span class="token keyword">int</span> a2<span class="token punctuation">;</span> <span class="token keyword">char</span> a3<span class="token punctuation">;</span> <span class="token keyword">short</span> a4<span class="token punctuation">;</span><span class="token punctuation">}</span>Test_T<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Test_T T<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nsizeof(T) = %d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a1地址：%d\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>T<span class="token punctuation">.</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a2地址：%d\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>T<span class="token punctuation">.</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a3地址：%d\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>T<span class="token punctuation">.</span>a3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a4地址：%d\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>T<span class="token punctuation">.</span>a4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果为：<br><a href="https://imgchr.com/i/V5iCZD" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5iCZD.md.png" alt="V5iCZD.md.png"></a></p><p>可见，正好印证了上述的说法，补齐之后结构体成员a1,a2,a3的地址之间正好相差4个字节,a3与a4之间相差两个字节也是因为在其中多留出了1个空白字节。该程序的运行结果可形象地描述为下图：</p><p><a href="https://imgchr.com/i/V5inL8" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5inL8.md.png" alt="V5inL8.md.png"></a></p><p>a1只占用一个字节，为了内存对齐保留了三个空白字节；a3和a4加起来共3字节，为了内存对齐保留了1个空白字节。这就是编译器存储变量时做的见不得人的”手脚“，以方便其雇主——CPU能更快地找到这些变量。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】指针的基本概念</title>
      <link href="/2018/10/19/c-yu-yan-bi-ji-zhi-zhen-de-ji-ben-gai-nian/"/>
      <url>/2018/10/19/c-yu-yan-bi-ji-zhi-zhen-de-ji-ben-gai-nian/</url>
      
        <content type="html"><![CDATA[<p>我们平时定义的变量最终都会保存在内存里，内存的最小存储单位称为<code>内存单元</code>。通常，一个字节称为一个<code>内存单元</code>。而我们定义的变量就保存在这些内存单元里，为了正确地访问这些数据，必须为每个内存单元都编上编号，每个内存单元的编号是唯一的，就像每个人都有唯一的身份证号，只要知道身份证号就能找到这个人。同样，根据内存单元编号就可以准确地找到保存在该内存单元中的数据。内存单元的编号也就是地址。</p><p>下图是 4G 内存中每个字节的编号：</p><p><img src="https://s2.ax1x.com/2019/06/14/V5a4AO.png" alt="V5a4AO.png"></p><p>看一段程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\na的地址%#x\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输出</p><pre class=" language-c"><code class="language-c">a的地址<span class="token number">0x61ff0c</span></code></pre><p>a是一个int型变量，其的值1保存在地址0~0xFFFFFFFF之间的编号为0x61ff0c的地址上。</p><p>指针是一种特殊的数据类型，用指针声明的变量称为<code>指针变量</code>。  指针变量的值实际上是一个地址。</p><h3 id="一、指针变量的声明与初始化举例："><a href="#一、指针变量的声明与初始化举例：" class="headerlink" title="一、指针变量的声明与初始化举例："></a>一、指针变量的声明与初始化举例：</h3><p>1、在声明时赋值</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> a<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token operator">=</span><span class="token operator">&amp;</span>a<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//初始化赋值，&amp;a表示取变量a的首地址</span></code></pre><p>2、动态赋值</p><pre><code>int a;int *p;p=&amp;a;  //利用&amp;a获得变量a的首地址，然后赋值给p</code></pre><h3 id="二、注意区分的两个概念：指针的类型与指针所指的类型"><a href="#二、注意区分的两个概念：指针的类型与指针所指的类型" class="headerlink" title="二、注意区分的两个概念：指针的类型与指针所指的类型"></a>二、注意区分的两个概念：指针的类型与指针所指的类型</h3><p>1、指针的类型</p><pre class=" language-c"><code class="language-c"><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">int</span><span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//指针的类型是int* </span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">char</span><span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//指针的类型是char* </span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//指针的类型是int**</span></code></pre><p>从语法的角度看，只要把指针声明语句里的指针名字去掉，剩下的部分就是这个指针的类型。</p><p>2、指针所指的类型</p><pre class=" language-c"><code class="language-c"><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">int</span><span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//指针所指向的类型是int </span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">char</span><span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//指针所指向的的类型是char </span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//指针所指向的的类型是int*</span></code></pre><p>从语法的角度看，只须把指针声明语句中的指针名字和名字左边的指针声明符*去掉，剩下的就是指针所指向的类型。</p><p>以上就是指针的基本概念，关键理解指针的类型与指针所指向的类型。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】变量的初始值是？</title>
      <link href="/2018/10/18/c-yu-yan-bi-ji-bian-liang-de-chu-shi-zhi-shi/"/>
      <url>/2018/10/18/c-yu-yan-bi-ji-bian-liang-de-chu-shi-zhi-shi/</url>
      
        <content type="html"><![CDATA[<p>一个变量，即使没有给它赋初值，它也是有一个默认初值的。下面来看一段程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> a2<span class="token punctuation">;</span><span class="token keyword">float</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">;</span><span class="token keyword">char</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a3<span class="token punctuation">,</span> a4<span class="token punctuation">;</span> <span class="token keyword">float</span> b3<span class="token punctuation">,</span> b4<span class="token punctuation">;</span> <span class="token keyword">char</span> c3<span class="token punctuation">,</span> c4<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"全局变量：a1 = %d, a2 = %d, b1 = %f, b2 = %f, c1 =%d, c2 =%d\n"</span><span class="token punctuation">,</span> a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"局部变量：a3 = %d, a4 = %d, b3 = %f, b4 = %f, c3 =%d, c4 =%d\n"</span><span class="token punctuation">,</span> a3<span class="token punctuation">,</span> a4<span class="token punctuation">,</span> b3<span class="token punctuation">,</span> b4<span class="token punctuation">,</span> c3<span class="token punctuation">,</span> c4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><pre class=" language-c"><code class="language-c">全局变量：a1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> a2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> b1 <span class="token operator">=</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> b2 <span class="token operator">=</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> c1 <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> c2 <span class="token operator">=</span><span class="token number">0</span>局部变量：a3 <span class="token operator">=</span> <span class="token number">4200660</span><span class="token punctuation">,</span> a4 <span class="token operator">=</span> <span class="token number">4200754</span><span class="token punctuation">,</span> b3 <span class="token operator">=</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> b4 <span class="token operator">=</span> <span class="token number">0.000000</span><span class="token punctuation">,</span> c3 <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> c4 <span class="token operator">=</span><span class="token number">0</span></code></pre><p>可见，全局变量的默认初值为0。局部变量的默认是随机的，没有规律的。所以，我们在使用局部变量之前应该首先进行初始化，否则可能会出现意想不到的错误。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】volatile关键字</title>
      <link href="/2018/10/17/c-yu-yan-bi-ji-volatile-guan-jian-zi/"/>
      <url>/2018/10/17/c-yu-yan-bi-ji-volatile-guan-jian-zi/</url>
      
        <content type="html"><![CDATA[<h3 id="volatile的作用"><a href="#volatile的作用" class="headerlink" title="volatile的作用"></a>volatile的作用</h3><p>volatile的作用是作为指令关键字，确保本条指令不会因编译器的优化而省略，且要求每次直接读值。</p><p>简单地说就是防止编译器对代码进行优化。比如如下程序：</p><pre class=" language-c"><code class="language-c">XBYTE<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0x55</span><span class="token punctuation">;</span>XBYTE<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0x56</span><span class="token punctuation">;</span>XBYTE<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0x57</span><span class="token punctuation">;</span>XBYTE<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0x58</span><span class="token punctuation">;</span></code></pre><p>对外部硬件而言，上述四条语句分别表示不同的操作，会产生四种不同的动作，但是编译器却会对上述四条语句进行优化，认为只有<code>XBYTE[2]=0x58</code>（即忽略前三条语句，只产生一条机器代码）。如果键入volatile，则编译器会逐一地进行编译并产生相应的机器代码（产生四条代码）。</p><h3 id="编译器的优化"><a href="#编译器的优化" class="headerlink" title="编译器的优化"></a>编译器的优化</h3><p>在本次线程内，当读取一个变量时，为提高存取速度，编译器优化时有时会先把变量读取到一个寄存器中；以后再取变量值时，就直接从寄存器中取值；</p><p>当变量值在本线程里改变时，会同时把变量的新值copy到该寄存器中，以便保持一致<br>当变量在因别的线程等而改变了值，该寄存器的值不会相应改变，从而造成应用程序读取的值和实际的变量值不一致；</p><p>当该寄存器在因别的线程等而改变了值，原变量的值不会改变，从而造成应用程序读取的值和实际的变量值不一致。</p><p>举一个不太准确的例子：<br>发薪资时，会计每次都把员工叫来登记他们的银行卡号；一次会计为了省事，没有即时登记，用了以前登记的银行卡号；刚好一个员工的银行卡丢了，已挂失该银行卡号；从而造成该员工领不到工资。<br>员工 －－ 原始变量地址<br>银行卡号 －－ 原始变量在寄存器的备份</p><h3 id="volatile例子"><a href="#volatile例子" class="headerlink" title="volatile例子"></a>volatile例子</h3><p>精确地说就是，优化器在用到这个变量时必须每次都小心地重新读取这个变量的值，而不是使用保存在寄存器里的备份。下面是volatile变量的几个例子：</p><blockquote><p>1）并行设备的硬件寄存器（如：状态寄存器）<br>2）一个中断服务子程序中会访问到的非自动变量<br>3）多线程应用中被几个任务共享的变量</p></blockquote><p>请看下面几个问题：</p><blockquote><p>1）一个参数既可以是const还可以是volatile吗？解释为什么。<br>2）一个指针可以是volatile 吗？解释为什么。<br>3）下面的函数有什么错误：<br>int square(volatile int <em>ptr)<br>{   return ((</em>ptr) * (*ptr));<br>}</p></blockquote><p>下面是答案：</p><p>1）是的。一个例子是只读的状态寄存器。它是volatile因为它可能被意想不到地改变。它是const因为程序不应该试图去修改它。</p><p>2）是的。尽管这并不很常见。一个例子是当一个中断服务子程序修改一个指向一个buffer的指针时。</p><p>3）这段代码是个恶作剧。这段代码的目的是用来返指针<em>ptr指向值的平方，但是，由于</em>ptr指向一个volatile型参数，编译器将产生类似下面的代码：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> <span class="token keyword">int</span><span class="token operator">*</span> <span class="token operator">&amp;</span>ptr<span class="token punctuation">)</span><span class="token comment" spellcheck="true">//这里参数应该申明为引用，不然函数体里只会使用副本，外部没法更改</span><span class="token punctuation">{</span>   <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>   a <span class="token operator">=</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>   b <span class="token operator">=</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>   <span class="token keyword">return</span> a<span class="token operator">*</span>b<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>由于*ptr的值可能在两次取值语句之间发生改变，因此a和b可能是不同的。结果，这段代码可能返回的不是你所期望的平方值！正确的代码如下：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">long</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> <span class="token keyword">int</span><span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">int</span> a<span class="token punctuation">;</span>   a <span class="token operator">=</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>   <span class="token keyword">return</span> a<span class="token operator">*</span>a<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>volatile在嵌入式中经常用到。如：</p><p>（1）宏定义寄存器：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> PINSEL0 (*((volatile unsigned long*)0xE002C000))</span></code></pre><p>（2）宏读写操作：</p><pre><code>// 写操作#define write8b(addr, data) *(volatile unsigned char* (addr))=(unsigned char)data// 读操作#define read(addr) (*(volatile unsigned char* (addr)))</code></pre><p>（3）测试空循环的速度</p><pre class=" language-c"><code class="language-c"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">100000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>这个语句用来测试空循环的速度的,但是编译器肯定要把它优化掉，根本就不执行。<br>如果你写成</p><pre class=" language-c"><code class="language-c"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">100000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>它就会执行了。</p><p>（4）中断服务程序中修改的供其它程序检测的变量<br>由于访问寄存器的速度要快过RAM，所以编译器一般都会作减少存取外部RAM的优化。比如：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">static</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//...</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*Interruptserviceroutine.*/</span><span class="token keyword">void</span> <span class="token function">ISR_2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序的本意是希望ISR_2中断产生时，在main当中调用dosomething函数，但是，由于编译器判断在main函数里面没有修改过i，因此可能只执行一次对从i到某寄存器的读操作，然后每次if判断都只使用这个寄存器里面的“i副本”，导致dosomething永远也不会被调用。</p><p>如果将变量加上volatile修饰，则编译器保证对此变量的读写操作都不会被优化（肯定执行）。此例中i也应该如此说明。</p><p>嵌入式系统中涉及到硬件、中断、RTOS等，所有这些都要求使用volatile变量，可能被意想不到地改变。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】复合赋值语句</title>
      <link href="/2018/10/14/c-yu-yan-bi-ji-fu-he-fu-zhi-yu-ju/"/>
      <url>/2018/10/14/c-yu-yan-bi-ji-fu-he-fu-zhi-yu-ju/</url>
      
        <content type="html"><![CDATA[<p>增加一个变量的值有两种方式，如：<code>a = a + 5</code>和<code>a += 5</code>。存在两种增加一个变量值的方法有何意义呢？K&amp;R C设计者认为复合赋值符可以让程序员把代码写得更清楚些。另外，编译器可以产生更为紧凑的代码。</p><p>现在，a = a + 5和a += 5之间的差别不再那么显著，而且现代的编译器为这两种表达式产生优化代码并无多大问题。但是，要考虑如下两条语句：</p><p><a href="https://imgchr.com/i/V4q9hD" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4q9hD.md.png" alt="V4q9hD.md.png"></a></p><p>此处a为数组。在第一种形式种，由于编译器无从知道f函数是否具有副作用，所以它必须两次计算数组a的下标表达式的值。而在第二种形式中，下标表达式只需计算一次，所以第二种形式效率更高。并且，从书写的角度看，第一种形式的下标表达式需要书写两次，而第二种形式只需书写一次。</p><p>基于这些理由，我们应该使用复合赋值语句。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】C语言编译的过程</title>
      <link href="/2018/10/14/c-yu-yan-bi-ji-c-yu-yan-bian-yi-de-guo-cheng/"/>
      <url>/2018/10/14/c-yu-yan-bi-ji-c-yu-yan-bian-yi-de-guo-cheng/</url>
      
        <content type="html"><![CDATA[<h3 id="1、前言"><a href="#1、前言" class="headerlink" title="1、前言"></a>1、前言</h3><p>如果你使用的是集成开发环境，那么你点击编译按钮就可生成可执行文件，然后点击运行即可运行。那么，你知道从源代码到可执行文件经历了哪些过程吗。仅仅是编译？</p><p>下面以<code>windows</code>环境下的<code>test.c</code>为例，<code>test.c</code>里的代码为：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"This is a test program!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>其经历如下过程：</p><p><a href="https://imgchr.com/i/V5fr59" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5fr59.md.png" alt="V5fr59.md.png"></a></p><p>如图，编译生成可执行文件的过程实际包含四个过程：（1）预处理；（2）编译；（3）汇编；（4）链接。</p><h3 id="2、预处理（Preprpcessing）"><a href="#2、预处理（Preprpcessing）" class="headerlink" title="2、预处理（Preprpcessing）"></a>2、预处理（Preprpcessing）</h3><p>使用预处理器把源文件<code>test.c</code>经过预处理生成<code>test.i</code>文件，预处理用于将所有的#include头文件以及宏定义替换成其真正的内容。</p><p>预处理的命令为：</p><pre class=" language-c"><code class="language-c">gcc <span class="token operator">-</span>E test<span class="token punctuation">.</span>c <span class="token operator">-</span>o test<span class="token punctuation">.</span>i</code></pre><p>上述命令中<code>-E</code>是让编译器在预处理之后就退出，不进行后续编译过程；<code>-o</code>是指定输出文件名。</p><p>预处理之后得到的仍然是文本文件。test.i文件部分内容截图如下：</p><p><a href="https://imgchr.com/i/V5fRKK" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5fRKK.md.png" alt="V5fRKK.md.png"></a></p><h3 id="3、编译（Compilation）"><a href="#3、编译（Compilation）" class="headerlink" title="3、编译（Compilation）"></a>3、编译（Compilation）</h3><p>使用编译器将预处理文件<code>test.i</code>编译成汇编文件<code>test.s</code>。</p><p>编译的命令为：</p><pre class=" language-c"><code class="language-c">gcc <span class="token operator">-</span>S test<span class="token punctuation">.</span>i <span class="token operator">-</span>o test<span class="token punctuation">.</span>s</code></pre><p>上述命令中-S让编译器在编译之后停止，不进行后续过程；-o是指定输出文件名。汇编文件test.s是文本文件，部分内容截图如下：</p><p><a href="https://imgchr.com/i/V5fLKf" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5fLKf.md.png" alt="V5fLKf.md.png"></a></p><h3 id="4、汇编（Assemble）"><a href="#4、汇编（Assemble）" class="headerlink" title="4、汇编（Assemble）"></a>4、汇编（Assemble）</h3><p>使用汇编器将汇编文件<code>test.s</code>转换成目标文件<code>test.o</code>。</p><p>汇编过程的命令为：</p><pre class=" language-c"><code class="language-c">gcc <span class="token operator">-</span>c test<span class="token punctuation">.</span>s <span class="token operator">-</span>o test<span class="token punctuation">.</span>o</code></pre><p>上述命令中<code>-c</code>、<code>-o</code>让汇编器把汇编文件<code>test.s</code>转换成目标文件<code>test.o</code>。目标文件<code>test.o</code>是二进制文件，部分内容截图如下：</p><p><a href="https://imgchr.com/i/V5fxaQ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5fxaQ.md.png" alt="V5fxaQ.md.png"></a></p><h3 id="5、链接（Linking）"><a href="#5、链接（Linking）" class="headerlink" title="5、链接（Linking）"></a>5、链接（Linking）</h3><p>链接过程使用链接器将该目标文件与其他目标文件、库文件、启动文件等链接起来生成可执行文件。</p><p>链接过程的命令为：</p><pre class=" language-c"><code class="language-c">gcc test<span class="token punctuation">.</span>o <span class="token operator">-</span>o test<span class="token punctuation">.</span>exe</code></pre><p>综上，生成可执行程序过程为：预处理、编译、汇编、链接。各个命令如下图所示：</p><p><a href="https://imgchr.com/i/V5hpPs" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5hpPs.md.png" alt="V5hpPs.md.png"></a></p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】char *str与char str[]的区别</title>
      <link href="/2018/10/14/c-yu-yan-bi-ji-char-str-yu-char-str-de-qu-bie/"/>
      <url>/2018/10/14/c-yu-yan-bi-ji-char-str-yu-char-str-de-qu-bie/</url>
      
        <content type="html"><![CDATA[<p>C语言中没有特定的字符串类型，常用以下两种方式定义字符串：一种是字符数组，另一种是指向字符串的指针。如下：</p><pre class=" language-c"><code class="language-c"><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"happy"</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token string">"happy"</span><span class="token punctuation">;</span></code></pre><p>这种方式有什么不同呢？</p><p>下面看两个例子：修改字符串中的字符</p><p>示例1：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span> str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'H'</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果：</p><pre class=" language-c"><code class="language-c">Hello</code></pre><p>示例2：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span> str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'H'</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>运行结果：</p><pre class=" language-c"><code class="language-c">无打印信息输出</code></pre><p>可见，使用（1）方式定义的字符串其字符是可以修改的，使用（2）方式定义的字符串其字符是不可以修改的。（2）中可以成功编译和链接，但运行时可能会出现错误，我编译与运行的平台是window10平台，运行结果是无打印信息输出，在其他不同的平台运行可能会出现<code>段错误（Segment Fault）</code>或者写入位置错误。</p><p>这两种表示字符串的方式的主要区别是：字符串指针指向的内容是不可修改的，字符数组是可以修改的，即（2）方式定义的字符串保存在常量区，是不可更改的，（1）方式定义的字符串保存在全局数据区或栈区，是可修改的。</p><p>内存的分配方式：</p><p>内存分配可分为三种：静态存储区、栈区、堆区。</p><p><code>1、静态存储区</code>：该内存在程序编译的时候就已经分配好，这块内存在程序的整个运行期间都存在，它主要存放静态数据、全局数据和常量。</p><p><code>2、栈区</code>：它的用途是完成函数的调用。在执行函数时，函数内局部变量及函数参数的存储单元在栈上创建，函数调用结束时这些存储单元自动被释放。</p><p><code>3、堆区</code>：程序在运行时使用库函数为变量申请内存，在变量使用结束后再调用库函数释放内存。动态内存的生存期是由我们决定的，如果我们不释放内存，就会导致内存泄漏。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】extern关键字</title>
      <link href="/2018/10/13/c-yu-yan-bi-ji-extern-guan-jian-zi/"/>
      <url>/2018/10/13/c-yu-yan-bi-ji-extern-guan-jian-zi/</url>
      
        <content type="html"><![CDATA[<p>extern关键字可以用来声明变量和函数作为外部变量或者函数供其它文件使用。</p><h3 id="extern声明变量"><a href="#extern声明变量" class="headerlink" title="extern声明变量"></a>extern声明变量</h3><h3 id="示例程序："><a href="#示例程序：" class="headerlink" title="示例程序："></a>示例程序：</h3><p>test.h如下：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//声明</span><span class="token keyword">extern</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span><span class="token keyword">extern</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span></code></pre><p>test.c如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"test.h"</span></span><span class="token comment" spellcheck="true">//定义</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">520</span><span class="token punctuation">;</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">1314</span><span class="token punctuation">;</span></code></pre><p>主函数所在的源文件为main.c，其代码如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"test.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d , b = %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>其中，a，b的声明也可放在main.c中，代码如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">extern</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span><span class="token keyword">extern</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d , b = %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>此时，就不需要包含test.h这个头文件了。</p><h3 id="extern声明函数"><a href="#extern声明函数" class="headerlink" title="extern声明函数"></a>extern声明函数</h3><h3 id="示例程序：-1"><a href="#示例程序：-1" class="headerlink" title="示例程序："></a>示例程序：</h3><p>test.h如下：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//声明变量</span><span class="token keyword">extern</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span><span class="token keyword">extern</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//函数声明</span><span class="token keyword">extern</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//extern关键字可要可不要</span></code></pre><p>test.c如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"test.h"</span></span><span class="token comment" spellcheck="true">//定义</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">520</span><span class="token punctuation">;</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">1314</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>main.c如下：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"test.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d , b = %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"add(a, b) = %d\n"</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>同上，函数的声明也可以放在其被调用的源文件中，即：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token comment" spellcheck="true">//声明变量</span><span class="token keyword">extern</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span><span class="token keyword">extern</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//函数声明</span><span class="token keyword">extern</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//extern关键字可要可不要</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d , b = %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"add(a, b) = %d\n"</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><p><a href="https://imgchr.com/i/V4OOXj" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4OOXj.md.png" alt="V4OOXj.md.png"></a></p><h3 id="extern-“C”"><a href="#extern-“C”" class="headerlink" title="extern “C”"></a>extern “C”</h3><p>extern “C”的主要作用就是为了能够正确实现C++代码调用其他C语言代码。加上extern “C”后，会指示编译器这部分代码按C语言的进行编译，而不是C++的。</p><p>因为在C++出现以前，很多代码都是C语言写的，而且很底层的库也是C语言写的，为了更好的支持原来的C代码和已经写好的C语言库，需要在C++中尽可能的支持C，而extern “C”就是其中的一个策略。</p><p>示例代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">ifndef</span> __TEST_H   </span><span class="token comment" spellcheck="true">/*防止该头文件被重复引用*/</span><span class="token macro property">#<span class="token directive keyword">define</span> __TEST_H</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> __cplusplus             </span><span class="token keyword">extern</span> <span class="token string">"C"</span><span class="token punctuation">{</span><span class="token macro property">#<span class="token directive keyword">endif</span></span><span class="token comment" spellcheck="true">/*…*/</span><span class="token macro property">#<span class="token directive keyword">ifdef</span> __cplusplus</span><span class="token punctuation">}</span><span class="token macro property">#<span class="token directive keyword">endif</span></span><span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment" spellcheck="true">/*end of __TEST_H*/</span></code></pre><p><code>__cplusplus</code>为C++定义的一个宏，此时<code>extern “C”</code>后的部分的代码按C语言的格式进行编译，而不是C++。</p><p>以上是extern关键字的三种用法，如有错误，欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】内存笔记</title>
      <link href="/2018/10/12/c-yu-yan-bi-ji-nei-cun-bi-ji/"/>
      <url>/2018/10/12/c-yu-yan-bi-ji-nei-cun-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>C语言程序需要载入内存才可以运行，其不同的数据保存在不同的区域。所使用的内存可以分成两类：一类是<code>静态存储区</code>，另一类是<code>动态存储区</code>。</p><p>C语言程序的存储区如下图所示：</p><p><a href="https://imgchr.com/i/V4RTHJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4RTHJ.md.png" alt="V4RTHJ.md.png"></a></p><h3 id="1、静态存储区"><a href="#1、静态存储区" class="headerlink" title="1、静态存储区"></a>1、静态存储区</h3><p>静态存储区分为三类：<code>只读数据区（RO Data）、已初始化读写数据区（RW Data）、未初始化读写读写数据区（BSS）</code>。这三类存储区都是在程序的<code>编译-连接阶段</code>确定的，且运行过程中是不会变化的，只有当程序退出的时候，静态存储区的内存才会被系统回收。</p><h3 id="2、动态存储区"><a href="#2、动态存储区" class="headerlink" title="2、动态存储区"></a>2、动态存储区</h3><p>动态存储区主要分为两类：一类是<code>栈（Stack）内存</code>区域，栈内存是由编译器管理的；另一类是<code>堆（Heap）内存</code>区域，堆内存由程序调用具体的库函数来分配的。它们都是程序运行过程中动态分配的。</p><h3 id="2-1栈内存区域"><a href="#2-1栈内存区域" class="headerlink" title="2.1栈内存区域"></a>2.1栈内存区域</h3><h3 id="2-1-1栈的相关概念"><a href="#2-1-1栈的相关概念" class="headerlink" title="2.1.1栈的相关概念"></a>2.1.1栈的相关概念</h3><p>栈内存的使用很大的程度上依赖于处理器的硬件机制。在处理器中，有一个寄存器来表示当前栈指针的位置。通常在内存中分配一块区域，这块区域的上界（高内存地址）和下界（低内存地址）之间是可用的栈内存区域。栈内存如下图所示：</p><p> <a href="https://imgchr.com/i/V4HeKI" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4HeKI.md.png" alt="V4HeKI.md.png"></a></p><p>目前常见的体系结构和编译系统中，<code>栈大多都是向下增长的</code>。在初始阶段，栈指针是指向栈区间的上界，随着栈使用量的增加，栈指针的值向低地址移动，即栈指针的值将变小。下面来看一段程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d, &amp;a = %#x \n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"b = %d, &amp;b = %#x \n"</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"c = %d, &amp;c = %#x \n"</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果为：</p><p><a href="https://imgchr.com/i/V4HwIU" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4HwIU.md.png" alt="V4HwIU.md.png"></a></p><p>可见，变量的存储是从高地址往低地址的方向存储。</p><p>栈有一个重要的特性：先放入的数据最后才能取出，后放入的数据优先能取出，即<code>先进后出（First In Last Out）原则</code>。放入数据常被称为<code>入栈或压栈（Push）</code>，取出数据被称为<code>出栈或弹出（Pop）</code>。在运用过程中，栈内存可能出现满栈和空栈两种情况，这是由处理器的体系结构决定的。</p><p>栈（Stack）可以存放函数参数、局部变量、局部数组等作用范围在函数内部的数据，它的用途就是完成函数的调用。</p><h3 id="2-1-1需要知道的关于栈的问题："><a href="#2-1-1需要知道的关于栈的问题：" class="headerlink" title="2.1.1需要知道的关于栈的问题："></a>2.1.1需要知道的关于栈的问题：</h3><p>（1）函数在调用完成之后，栈指针将回到函数进入之前的位置。下面的程序通过两次调用同一个函数印证了这一点：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">void</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token keyword">int</span> a1 <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> b1 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> c1 <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"第一次调用stack_test1函数：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"第二次调用stack_test1函数：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> c1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d, &amp;a = %#x \n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"b = %d, &amp;b = %#x \n"</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"c = %d, &amp;c = %#x \n"</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果：</p><p><a href="https://imgchr.com/i/V4Hsz9" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4Hsz9.md.png" alt="V4Hsz9.md.png"></a></p><p>可见，两次调用中函数参数使用的栈内存是相同的，即第一次调用函数完成之后，栈指针将回到函数进入之前的位置。</p><p>（2）在函数调用的过程中，每增加一个层次，栈空间就会被压入更多的内容，下面的程序验证了这一点：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">void</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">stack_test2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"直接调用stack_test1函数：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"通过stack_test2函数间接调用stack_test1函数：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">stack_test2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d, &amp;a = %#x \n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"b = %d, &amp;b = %#x \n"</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"c = %d, &amp;c = %#x \n"</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">stack_test2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果：</p><p><a href="https://imgchr.com/i/V4HLeP" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4HLeP.md.png" alt="V4HLeP.md.png"></a></p><p>可见，在程序中两次调用stack_test1函数，第一次是直接调用，第二次是通过stack_test2函数间接调用。从运行结果来看，通过stack_test2函数间接调用stack_test1函数的栈指针的值变小了，说明是由于栈中压入了更多的内容。</p><p>（3）函数调用结束后，函数栈上的内容不能被其他函数使用。例如，下面是一种错误的用法：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">stack_test3</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p><code>return(&amp;a)</code>将自动变量a的值返回，这种写法不会发生编译错误（有可能出现警告），但是其逻辑是不正确的。此时，调用者可以得到stack_test3运行时a的地址，但是由于变量a是建立在栈上，函数退出后，栈区域已经释放，这个地址已经指向无效的内存，因此不应该再被程序使用。</p><h3 id="2-2堆内存区域"><a href="#2-2堆内存区域" class="headerlink" title="2.2堆内存区域"></a>2.2堆内存区域</h3><h3 id="2-2-1堆的相关概念"><a href="#2-2-1堆的相关概念" class="headerlink" title="2.2.1堆的相关概念"></a>2.2.1堆的相关概念</h3><p>在一般的编译系统中，堆内存的分配方向和栈内存是相反的。栈内存利用的是处理器的硬件机制，而堆内存的处理使用的是库函数。堆内存的分配形式如下图：</p><p><a href="https://imgchr.com/i/V4b9Qs" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4b9Qs.md.png" alt="V4b9Qs.md.png"></a></p><p>可见，堆内存与栈内存的区别：栈内存只有一个入口点，就是栈指针，栈内存压栈和出栈都只能通过栈指针及其偏移量；而堆内存有多个入口点，每次分配得到的指针就是访问内存的入口，每个分配内存区域都可以被单独释放。</p><p>当频繁的分配和释放内存的过程中，将会出现如下情况：在两块已经分配的内存之间可能出现较小的未分配的内存区域，这些内存理论上可以被使用。但是由于它们的空间较小，不够连续内存的分配，因此当分配内存的时候，它们经常不能被使用。这种较小的内存就是内存碎片。</p><h3 id="2-2-2关于堆空间的使用及其一些问题："><a href="#2-2-2关于堆空间的使用及其一些问题：" class="headerlink" title="2.2.2关于堆空间的使用及其一些问题："></a>2.2.2关于堆空间的使用及其一些问题：</h3><p>（1）库文件：stdlib.h</p><p>实现堆内存分配和释放的4个主要函数为：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* 分配内存空间 */</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">malloc</span><span class="token punctuation">(</span>size_t size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/* 释放内存空间 */</span><span class="token keyword">void</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/* 分配内存空间 */</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">calloc</span><span class="token punctuation">(</span>size_t num<span class="token punctuation">,</span> size_t size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/* 重新分配内存空间 */</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">realloc</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> size_t size<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>（2）malloc和free的简单应用</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//malloc和free的简单应用</span><span class="token keyword">void</span> <span class="token function">heap_test1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> <span class="token operator">*</span>pa<span class="token punctuation">;</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token constant">NULL</span> <span class="token operator">!=</span> pa <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token operator">*</span>pa <span class="token operator">=</span> <span class="token number">0x1234</span><span class="token punctuation">;</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa = %#x, *pa = %x\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>pa<span class="token punctuation">,</span> <span class="token operator">*</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">free</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>在malloc分配完内存之后，可以用得到的指针值是否为NULL来判断内存是否分配成功。按照C语言内存分配规则，如果内存分配成功，返回的是内存的地址；如果内存分配不成功，将返回NULL（0x0），表示一个无效的地址。</p><p>（3）malloc在分配内存的时候，是从低地址至高地址方向。但是，先分配的内存地址不一定比后分配的内存地址小。下面的程序验证了这一点：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//后分配内存地址反而更小</span><span class="token keyword">void</span> <span class="token function">heap_test2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">void</span> <span class="token operator">*</span>pa<span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token operator">*</span>pb<span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token operator">*</span>pc<span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token operator">*</span>pd<span class="token punctuation">;</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa = %#x \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span> pb <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pb = %#x \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>pb<span class="token punctuation">)</span><span class="token punctuation">;</span> pc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pc = %#x \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>pc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">;</span> pd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pd = %#x \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>pd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span>pc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span>pd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果：</p><p><a href="https://imgchr.com/i/V4beW4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4beW4.md.png" alt="V4beW4.md.png"></a></p><p>可见，在该程序中，首先3次分配1024字节的堆上内存，然后再将第二次分配的内存释放，再次分配内存时，将利用了这一块空间。</p><p>（4）calloc()和malloc()很类似，主要区别是calloc()可以将分配好的内存区域的初始值全部设置为0，以下程序验证了这一点：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//calloc和malloc的主要区别</span><span class="token keyword">void</span> <span class="token function">heap_test3</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>pa<span class="token punctuation">;</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">calloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token constant">NULL</span> <span class="token operator">!=</span> pa <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&lt;&lt; colloc pa = %#x >>\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span>   <span class="token punctuation">{</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa[%d] = %d \n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> pa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span>   <span class="token function">free</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果：</p><p><a href="https://imgchr.com/i/V4bJYD" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4bJYD.md.png" alt="V4bJYD.md.png"></a></p><p>除此之外，calloc()和malloc()另外一个不同之处在于参数的个数，malloc只有一个参数，即要分配的内存字节数；calloc有两个参数，第一个是分配单元的大小，第二个是要分配的数目。从本质上，calloc使用两个参数和malloc使用一个并没有区别。</p><p>（5）realloc的应用。realloc函数具有两个参数，一个是指向内存的地址指针，另一个是重新分配内存的大小，而返回值是指向所分配内存的指针。基本应用代码如下：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//realloc的应用</span><span class="token keyword">void</span> <span class="token function">heap_test4</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> <span class="token operator">*</span>pa<span class="token punctuation">;</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token constant">NULL</span> <span class="token operator">!=</span> pa <span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token operator">*</span><span class="token punctuation">(</span>pa <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>   <span class="token punctuation">}</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa[%d] = %d \n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> pa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"relloc重新分配内存\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">realloc</span><span class="token punctuation">(</span>pa<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token constant">NULL</span> <span class="token operator">!=</span> pa <span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa[%d] = %d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> pa<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span>   <span class="token function">free</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>程序运行结果：</p><p> <a href="https://imgchr.com/i/V4bB0P" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V4bB0P.md.png" alt="V4bB0P.md.png"></a></p><p>除此之外，realloc还具有两种功能：一是当指针为NULL的时候，作为malloc使用，分配内存；二是当重新分配内存大小为0的时候，作为free使用，释放内存。</p><p>（6）再堆内存的管理上，容易出现以下几个问题：</p><p>开辟的内存没有释放，造成内存泄漏</p><ul><li><p>内存泄漏的例子：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//内存泄漏例子</span><span class="token keyword">void</span> <span class="token function">heap_test6</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">char</span> <span class="token operator">*</span>pa<span class="token punctuation">;</span>pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/* ...... */</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre></li></ul><p>在函数heap_test6中，使用malloc开辟了20个字节的内存区域，但是使用结束后该函数没有释放这块区域，也没有通过任何返回值或者参数的手段将这块内存区域的地址告诉其它函数。此时，这20个字节的内存不会被任何程序释放，因此再调用该函数的时候，就会导致内存泄漏。</p><ul><li>野指针被使用或者释放</li></ul><p>野指针是一个已经被释放的内存指针，它指向的位置已经被free或者realloc释放了，此时再使用该指针，就会导致程序的错误。野指针例子：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//野指针例子</span><span class="token keyword">void</span> <span class="token function">heap_test6</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">char</span> <span class="token operator">*</span>pa<span class="token punctuation">;</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token function">free</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pa = %s \n"</span><span class="token punctuation">,</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//野指针被使用</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>在此程序中，调用free函数已经释放了pa指针，但后面还在继续使用pa，这就是一个错误的程序。</p><ul><li>非法释放指针</li></ul><p>1）非法释放静态存储区的内存，示例如下：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//非法释放静态存储区的内存</span><span class="token keyword">void</span> <span class="token function">heap_test7</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token comment" spellcheck="true">/* 错误释放只读数据区指针 */</span> <span class="token function">free</span><span class="token punctuation">(</span>ro_data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 错误释放已初始化读写数据区指针 */</span> <span class="token function">free</span><span class="token punctuation">(</span>rw_data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 错误释放未初始化读写数据区指针 */</span> <span class="token function">free</span><span class="token punctuation">(</span>bss_data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 错误释放代码区指针 */</span> <span class="token function">free</span><span class="token punctuation">(</span>heap_test7<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>2）非法释放栈上的内存，示例如下：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//非法释放栈上的内存</span><span class="token keyword">void</span> <span class="token function">heap_test8</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 错误释放栈上内存 */</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token function">free</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>3）非法释放堆上内存，示例如下：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//非法释放堆上的内存---1</span><span class="token keyword">void</span> <span class="token function">heap_test9</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">char</span> <span class="token operator">*</span>pa<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* ...... */</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//错误释放堆内存</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>第一次释放之后，该地址已经变成了未被分配的堆上的内存了，free函数不能释放未分配的堆内存。</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//非法释放堆上的内存---2</span><span class="token keyword">void</span> <span class="token function">heap_test10</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">char</span> <span class="token operator">*</span>pa<span class="token punctuation">;</span> <span class="token keyword">char</span> <span class="token operator">*</span>pb<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* ...... */</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> pb <span class="token operator">=</span> pa<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token function">free</span><span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//错误释放堆内存</span> <span class="token comment" spellcheck="true">/* ...... */</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>释放内存pb是非法的内存释放，由于这个指针并不是从malloc分配出来的，而是一个中间的指针值。</p><p>以上是对于C语言内存的一些笔记。如有错误，欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】getchar()、getche()、getch()的区别</title>
      <link href="/2018/10/11/c-yu-yan-bi-ji-getchar-getche-getch-de-qu-bie/"/>
      <url>/2018/10/11/c-yu-yan-bi-ji-getchar-getche-getch-de-qu-bie/</url>
      
        <content type="html"><![CDATA[<h3 id="1、getchar-函数"><a href="#1、getchar-函数" class="headerlink" title="1、getchar()函数"></a>1、getchar()函数</h3><p>所在头文件：<code>stdio.h</code></p><p>函数原型：<code>int getchar(void);</code></p><p>函数功能：读取控制台输入的字符，并保存在键盘缓冲区中。直到用户按回车为止(回车字符也放在缓冲区中)。</p><p>看一段代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c\n"</span><span class="token punctuation">,</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>当输入一个字符并按回车时，该字符被存入缓冲区中，printf函数再把缓冲区中的该字符输出。如输入输出实例：</p><pre class=" language-c"><code class="language-c">dd</code></pre><h3 id="2、getche-函数"><a href="#2、getche-函数" class="headerlink" title="2、getche()函数"></a>2、getche()函数</h3><p>所在头文件：<code>conio.h</code></p><p>函数原型：<code>int getche(void);</code></p><p>函数用途：输入后立即从控制台取字符，不以回车为结束，且立刻显示在屏幕上（带回显）。</p><p>看一段代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;conio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c\n"</span><span class="token punctuation">,</span> <span class="token function">getche</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>该函数的输入输出示例：</p><pre class=" language-c"><code class="language-c">dd</code></pre><p>也就是说，输入d，直接就输出d，不需要按回车键，即该函数不带缓冲区，且输入有回显。回显的意思就是在控制台显示输入的字符。</p><h3 id="3、getch-函数"><a href="#3、getch-函数" class="headerlink" title="3、getch()函数"></a>3、getch()函数</h3><p>所在头文件：<code>conio.h</code></p><p>函数原型：<code>int getch(void);</code></p><p>函数用途：从控制台读取一个字符，但不显示在屏幕上（不带回显）。</p><p>看一段代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;conio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c\n"</span><span class="token punctuation">,</span> <span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输入输出实例：</p><pre class=" language-c"><code class="language-c">d</code></pre><p>输入d，不会显示d，当调用printf函数后才输出d。控制台读取一个字符，但不显示在屏幕上（不带回显）。</p><p>此外，还需要注意的一个问题是：<code>conio.h</code>这个头文件是 windows 平台下特有的，其他平台如 Linux、Mac OS 等平台是没有的，所以使用<code>getch()</code>函数与<code>getche()</code>函数应该注意平台的问题。</p><p>以上就是关于getchar()、getche()、getch()的总结，如有错误欢迎指出！</p><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】#define与typedef的区别？</title>
      <link href="/2018/10/11/c-yu-yan-bi-ji-define-yu-typedef-de-qu-bie/"/>
      <url>/2018/10/11/c-yu-yan-bi-ji-define-yu-typedef-de-qu-bie/</url>
      
        <content type="html"><![CDATA[<h3 id="define"><a href="#define" class="headerlink" title="#define"></a>#define</h3><p>define是预处理指令，在编译时不进行任何检查，只进行简单的替换</p><p>宏定义的一般形式为：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> 宏名 字符串</span></code></pre><p>这里所说的字符串是一般意义上的字符序列，不要和C语言中的字符串等同，它不需要双引号。</p><h3 id="typedef"><a href="#typedef" class="headerlink" title="typedef"></a>typedef</h3><p>typedef是在C语言中用来为复杂的声明定义简单的别名，它本身是一种存储类的关键字，与auto、extern、mutable、static、register等关键字不能出现在同一个表达式中。</p><p>typedef取别名的一般形式为：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span>  旧名字  新名字</code></pre><h3 id="define与typedef的区别"><a href="#define与typedef的区别" class="headerlink" title="define与typedef的区别"></a>define与typedef的区别</h3><p>（1）#define之后不带分号，typedef之后带分号。</p><p>（2）#define可以使用其他类型说明符对宏类型名进行扩展，而 typedef 不能这样做。如：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> INT1 int</span><span class="token keyword">unsigned</span> INT1 n<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//没问题</span><span class="token keyword">typedef</span> <span class="token keyword">int</span> INT2<span class="token punctuation">;</span><span class="token keyword">unsigned</span> INT2 n<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//有问题</span></code></pre><p>INT1可以使用类型说明符unsigned进行扩展，而INT2不能使用unsigned进行扩展。</p><p>（3）在连续定义几个变量的时候，typedef 能够保证定义的所有变量均为同一类型，而 #define 则无法保证。如：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> PINT1 int*;</span>P_INT1 p1<span class="token punctuation">,</span>p2<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//即int *p1,p2;</span>typedet <span class="token keyword">int</span><span class="token operator">*</span> PINT2<span class="token punctuation">;</span>P_INT2 p1<span class="token punctuation">,</span>p2<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//p1、p2 类型相同</span></code></pre><p>PINT1定义的p1与p2类型不同，即p1为指向整形的指针变量，p2为整形变量；PINT2定义的p1与p2类型相同，即都是指向 int 类型的指针。</p><p>下面看一个关于typedef的重要的问题！！请看代码：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span>pStr<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> string<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"abc"</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//第一行代码</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>p1<span class="token operator">=</span>string<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//第二行代码</span>    <span class="token keyword">const</span> pStr p2 <span class="token operator">=</span> string<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//第三行代码</span>    p1<span class="token operator">++</span><span class="token punctuation">;</span>                      <span class="token comment" spellcheck="true">//第四行代码</span>    p2<span class="token operator">++</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">//第五行代码 </span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>这段代码编译会报一个错误：<code>error: increment of read-only variable &#39;p2&#39;</code>，你知道问题出在哪吗？</p><p>答案与解析：</p><p>是第五行代码p2++出错了。这个问题提醒我们：typedef和#define不同，它不是简单的文本替换。上述代码中const pStr p2并不等于const char * p2。const pStr p2和pStr const p2本质上没有区别，都是对变量进行只读限制，只不过此处变量p2的数据类型是我们自己定义的而不是系统固有类型而已。</p><p>因此，const pStr p2的含义是：限定数据类型为char <em>的变量p2为只读，即为char</em> const p2，表明p2是一个指向char类型的常指针，所以p2是不可修改的，因此p2++错误。</p><p>顺便提一下关于const声明的一些例子及其含义：</p><pre class=" language-c"><code class="language-c"><span class="token keyword">const</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//①</span><span class="token keyword">int</span> <span class="token keyword">const</span> b<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//②</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>c<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//③ </span><span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> d<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//④  </span><span class="token keyword">int</span> <span class="token keyword">const</span> <span class="token operator">*</span> e <span class="token keyword">const</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//⑤ </span></code></pre><p>①a是常数，不可改变； </p><p>②b是常数，不可改变；</p><p>③c是一个指向整型常数的指针，指针可以变，指针指向的内容不可以变；</p><p>④d是一个指向整型变量的常指针，指针不可以变，指针指向的内容可以变；</p><p>⑤e是一个指向整型常数的常指针，指针与指针指向的内容都不可变。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】函数参数压栈的顺序？</title>
      <link href="/2018/10/07/c-yu-yan-bi-ji-han-shu-can-shu-ya-zhan-de-shun-xu/"/>
      <url>/2018/10/07/c-yu-yan-bi-ji-han-shu-can-shu-ya-zhan-de-shun-xu/</url>
      
        <content type="html"><![CDATA[<p>按照日常习惯来看，C语言的函数参数压栈顺序是从左到右吧？但是事实却是相反的，C语言函数参数压栈顺序是从右到左的。下面看一个程序：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">void</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">stack_test1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d, &amp;a = %#x \n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"b = %d, &amp;b = %#x \n"</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"c = %d, &amp;c = %#x \n"</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>该程序输出结果为：</p><pre class=" language-c"><code class="language-c">a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a <span class="token operator">=</span> <span class="token number">0x61fef0</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>b <span class="token operator">=</span> <span class="token number">0x61fef4</span>c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>c <span class="token operator">=</span> <span class="token number">0x61fef8</span></code></pre><p>我们知道，栈是向下生长的，即从高地址向低地址的方向分配内存。由程序输出结果可知，变量c的值首先存储在高地址，其次是b，最后低地址保存a。即函数的参数压栈的顺序是从右到左。</p><p>为什么是从右到左呢？下面使用printf函数来分析：</p><pre class=" language-c"><code class="language-c">printf函数的原型是：<span class="token keyword">int</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>我们都知道，printf是个变参函数。那么，其参数的个数是如何确定的呢，靠的就是format，如果format首先被压入栈中，就无法知道还有多少个参数还没入栈了；所以，format应该最后入栈，才能确定参数的个数，也即符合参数入栈顺序为“从右到左”的规则。</p><p>以上就是关于函数参数压栈顺序的总结，如有错误欢迎指出！</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】使用notepad++、MinGW来开发C程序</title>
      <link href="/2018/10/05/c-yu-yan-bi-ji-shi-yong-notepad-mingw-lai-kai-fa-c-cheng-xu/"/>
      <url>/2018/10/05/c-yu-yan-bi-ji-shi-yong-notepad-mingw-lai-kai-fa-c-cheng-xu/</url>
      
        <content type="html"><![CDATA[<p>Windows平台下C程序的集成开发工具有很多：</p><h3 id="1、Visual-C-6-0"><a href="#1、Visual-C-6-0" class="headerlink" title="1、Visual C++6.0"></a>1、Visual C++6.0</h3><p><code>Visual C++</code>是Microsoft公司推出的用于开发C/C++程序的一款经典的IDE，很多高校都使用其作为教学工具来讲解C和C++。但是，Visual C++ 6.0在win7、win8、win10下总是存在各种兼容性问题，安装麻烦。</p><h3 id="2、Visual-Studio"><a href="#2、Visual-Studio" class="headerlink" title="2、Visual Studio"></a>2、Visual Studio</h3><p><code>Visual Studio（VS）</code>是美国微软公司的开发工具包系列产品。VS是一个完整的开发工具集，它包括了整个软件生命周期中所需要的大部分工具，如UML工具、代码管控工具、集成开发环境(IDE)等等。VS是目前最流行的Windows平台应用程序的集成开发环境。但是，VS安装包比较庞大，下载不方便，安装时间较长，而且会安装很多暂时用不到的工具。</p><h3 id="3、其他"><a href="#3、其他" class="headerlink" title="3、其他"></a>3、其他</h3><p><code>Dev C++</code>是一款免费开源的C/C++ IDE，内嵌 GCC 编译器。Dev C++的优点是体积小（只有几十兆）、安装卸载方便、学习成本低，缺点是调试功能弱。</p><p><code>C-Free</code>是一款C/C++集成开发环境（IDE）。目前有两个版本，收费的C-Free 5.0专业版和免费的C-Free 4.0 标准版。C-Free中集成了C/C++代码解析器，能够实时解析代码，并且在编写的过程中给出智能的提示。C-Free提供了对目前业界主流C/C++编译器的支持，你可以在C-Free中轻松切换编译器。</p><h3 id="4、本文推荐的：Notepad-MinGW"><a href="#4、本文推荐的：Notepad-MinGW" class="headerlink" title="4、本文推荐的：Notepad++ + MinGW"></a>4、本文推荐的：Notepad++ + MinGW</h3><p>上面介绍的开发环境都是集成的开发环境（编辑器与编译器集成在一个软件中），这里介绍另一种开发环境：<code>notepad++（编辑器） +  MinGW（里面包含编译器）</code>，两者通过 DOS 黑窗口关联。刚开始上手使用这种开发环境可能会有些不适应，但是会让你对C语言程序的编译-连接过程等有更好的理解，包括该开发工具包里有哪些目录，有哪些工具及该工具的环境变量怎么配置等。该开发环境如下图：</p><h3 id="（1）Notepad"><a href="#（1）Notepad" class="headerlink" title="（1）Notepad++"></a>（1）Notepad++</h3><p><code>Notepad++</code>是 Windows 操作系统下的一套文本编辑器，其功比 Windows 中的 Notepad（记事本）强大，除了可以用来制作一般的纯文字说明文件，也十分适合编写计算机程序代码。Notepad++不仅有语法高亮度显示，也有语法折叠功能，并且支持宏以及扩充基本功能的外挂模组。</p><h3 id="（2）MinGW"><a href="#（2）MinGW" class="headerlink" title="（2）MinGW"></a>（2）MinGW</h3><p><code>MinGW</code>，是 Minimalist GNUfor Windows 的缩写。它是一个可自由使用和自由发布的Windows特定头文件和使用GNU工具集导入库的集合。 MinGW 提供了一套完整的开源编译工具集（如gcc等工具），以适合 windows 平台应用开发，且不依赖任何第三方C运行时库。<br>下载方式：</p><blockquote><p>（1）官网下载：<a href="http://www.mingw.org/" target="_blank" rel="noopener">http://www.mingw.org/</a></p></blockquote><blockquote><p>（2）百度云盘：链接：<a href="https://pan.baidu.com/s/1o4Etp0rrW7IxUOwEg9yxyQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1o4Etp0rrW7IxUOwEg9yxyQ</a><br>提取码：lm5j </p></blockquote><h3 id="5、MinGW环境变量配置"><a href="#5、MinGW环境变量配置" class="headerlink" title="5、MinGW环境变量配置"></a>5、MinGW环境变量配置</h3><p>（1）解压MinGW到指定路径中（要记住这个路径，后面需要用的到），如我解压到路径<code>D:\Program Files\</code>中：</p><p><a href="https://imgchr.com/i/V6xshj" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6xshj.md.png" alt="V6xshj.md.png"></a></p><p>（2）右击<code>我的电脑</code>，点击<code>属性</code>：</p><p><a href="https://imgchr.com/i/V6xc3n" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6xc3n.md.png" alt="V6xc3n.md.png"></a></p><p>（3）点击<code>高级系统设置</code>：</p><p><a href="https://imgchr.com/i/V6xWuV" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6xWuV.md.png" alt="V6xWuV.md.png"></a></p><p>（4）在系统变量中找到<code>Path</code>，然后点击<code>编辑</code>按钮：</p><p><a href="https://imgchr.com/i/V6xIN4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6xIN4.md.png" alt="V6xIN4.md.png"></a></p><p>（5）点击<code>新建</code>按钮新建一个<code>D:\Program Files\MinGW\bin</code>变量（bin所在的路径就是刚才解压的路径），然后点击<code>确定</code>：</p><p><a href="https://imgchr.com/i/V6x7C9" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6x7C9.md.png" alt="V6x7C9.md.png"></a></p><p>（6）在系统变量中新建一个系统变量，变量名为<code>lib</code>，变量值为 MinGW 中 lib 文件夹的路径，然后点击<code>确定</code>按钮，如图：</p><p><a href="https://imgchr.com/i/V6xH3R" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6xH3R.md.png" alt="V6xH3R.md.png"></a></p><p>（7）同步骤（6）新建一个系统变量<code>include</code>，如图：</p><p><a href="https://imgchr.com/i/V6xqjx" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6xqjx.md.png" alt="V6xqjx.md.png"></a></p><p>（8）点击<code>确定</code>：</p><p><a href="https://imgchr.com/i/V6xOu6" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6xOu6.md.png" alt="V6xOu6.md.png"></a></p><p>（9）点击<code>确定</code>：</p><p><a href="https://imgchr.com/i/V6xxED" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6xxED.md.png" alt="V6xxED.md.png"></a></p><p>（10）点击组合键<code>win + r</code>打开运行窗口，输入<code>cmd</code>进入 DOS 窗口：</p><p><a href="https://imgchr.com/i/V6zS4H" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6zS4H.md.png" alt="V6zS4H.md.png"></a></p><p>（11）在 DOS 窗口下输入命令：<code>gcc -v</code>，若输出如下所示信息则表明gcc环境变量配置成功，否则配置失败：</p><p><a href="https://imgchr.com/i/V6zC8A" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6zC8A.md.png" alt="V6zC8A.md.png"></a></p><h3 id="6、如何使用Notepad-、gcc进行开发？"><a href="#6、如何使用Notepad-、gcc进行开发？" class="headerlink" title="6、如何使用Notepad++、gcc进行开发？"></a>6、如何使用Notepad++、gcc进行开发？</h3><p>首先，使用 notepad++ 编写好代码，这里我们写一个 hello.c 文件，然后在 cmd 窗口中运用命令切换当前路径为 hello.c 所在的路径。然后调用编译命令：<code>gcc hello.c -o hello.exe</code>进行编译。其中，<code>-o</code>参数是给编译生成的可执行文件重新命名为<code>hello.exe</code>，如果不加这个参数，则编译生成的可执行文件默认为<code>a.exe</code>。</p><p>其中，如果你不会通过命令来切换路径，也可以在 notepad++ 里直接进入当前文件所在的路径，具体操作为：</p><p><a href="https://imgchr.com/i/V6zaG9" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/V6zaG9.md.png" alt="V6zaG9.md.png"></a></p><p>除此，编译多个文件.c文件和编译一个.c文件的命令差不多，编译多个文件就把要编译的文件都加到编译命令中就可以了，如：</p><pre class=" language-c"><code class="language-c">gcc cJSON<span class="token punctuation">.</span>c json_parse_now<span class="token punctuation">.</span>c <span class="token operator">-</span>o test<span class="token punctuation">.</span>exe</code></pre><p>以上就是使用notepad++、MinGW开发C程序的环境配置及使用方法，如有错误，欢迎指出。</p><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【C语言笔记】main()函数的几种形式</title>
      <link href="/2018/10/02/c-yu-yan-bi-ji-main-han-shu-de-ji-chong-xing-shi/"/>
      <url>/2018/10/02/c-yu-yan-bi-ji-main-han-shu-de-ji-chong-xing-shi/</url>
      
        <content type="html"><![CDATA[<p>在C语言中，main函数是程序的入口。其有四种写法，即：</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//写法一</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello notepad++ \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//写法二</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello notepad++ \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//写法三</span><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello notepad++ \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//写法四</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello notepad++ \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>前面三种不带参数的都是比较常见的写法。第四种写法带的两个参数是什么意思呢？下面简单来介绍一下。首先，主函数不能被其他函数调用，所以形参<code>argc</code>与<code>argv</code>的实际值就不能从其他函数传入，那么其实参应该从哪传入呢？是从操作系统命令行上获得的。因此这两个参数也被称为命令行参数，<code>argc</code>为命令行参数的个数，<code>argv</code>为字符串命令行参数的首地址。</p><p>下面看一个代码实例：</p><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token comment" spellcheck="true">//写法四</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&lt;&lt;&lt;&lt; argument list >>>>\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"argc = %d\n"</span><span class="token punctuation">,</span> argc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> argc<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"argv[%d] = %s\n"</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span> argv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello notepad++ \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>键入组合键<code>【win+r】</code>打开<code>运行</code>窗口，输入<code>cmd</code>并回车进入命令行环境：</p><p>输入<code>gcc hello.c -o hello.exe</code>命令进行编译，再输入<code>hello.exe cmd1 cmd2 cmd3 cmd4 cmd5</code>（DOS提示符下命令行的一般形式为： <code>C:\&gt;可执行文件名 参数 参数……）</code>对main函数进行传参，输出结果为：</p><p><a href="https://imgchr.com/i/V5hhQ0" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/14/V5hhQ0.md.png" alt="V5hhQ0.md.png"></a></p><p>可见， argv为字符串指针数组，其各元素值为命令行中各字符串(参数均按字符串处理)的首地址，argc为指针数组的长度，即为参数的个数。</p><hr><p><a href="https://imgchr.com/i/VcSFJJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/06/11/VcSFJJ.md.png" alt="VcSFJJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> C语言笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
